8db66cb89e1f835bb39d9f290d0eb8a4
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Keyframe = void 0;
var _defineProperty3 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _Easing = require("../../Easing");
var _animation = require("../../animation");
var _commonTypes = require("../../commonTypes");
var _util = require("../../animation/util");
function _defineProperty(obj, key, value) {
  key = _toPropertyKey(key);
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
function _toPropertyKey(t) {
  var i = _toPrimitive(t, "string");
  return "symbol" == typeof i ? i : i + "";
}
function _toPrimitive(t, r) {
  if ("object" != typeof t || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r || "default");
    if ("object" != typeof i) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return ("string" === r ? String : Number)(t);
}
var InnerKeyframe = function () {
  function InnerKeyframe(definitions) {
    var _this = this;
    (0, _classCallCheck2.default)(this, InnerKeyframe);
    _defineProperty(this, "durationV", void 0);
    _defineProperty(this, "delayV", void 0);
    _defineProperty(this, "reduceMotionV", _commonTypes.ReduceMotion.System);
    _defineProperty(this, "callbackV", void 0);
    _defineProperty(this, "definitions", void 0);
    _defineProperty(this, "build", function () {
      var delay = _this.delayV;
      var delayFunction = _this.getDelayFunction();
      var _this$parseDefinition = _this.parseDefinitions(),
        keyframes = _this$parseDefinition.keyframes,
        initialValues = _this$parseDefinition.initialValues;
      var callback = _this.callbackV;
      return function () {
        'worklet';

        var animations = {};
        var addAnimation = function addAnimation(key) {
          var keyframePoints = keyframes[key];
          if (keyframePoints.length === 0) {
            return;
          }
          var animation = delayFunction(delay, keyframePoints.length === 1 ? (0, _animation.withTiming)(keyframePoints[0].value, {
            duration: keyframePoints[0].duration,
            easing: keyframePoints[0].easing ? keyframePoints[0].easing : _Easing.Easing.linear
          }) : _animation.withSequence.apply(void 0, (0, _toConsumableArray2.default)(keyframePoints.map(function (keyframePoint) {
            return (0, _animation.withTiming)(keyframePoint.value, {
              duration: keyframePoint.duration,
              easing: keyframePoint.easing ? keyframePoint.easing : _Easing.Easing.linear
            });
          }))));
          if (key.includes('transform')) {
            if (!('transform' in animations)) {
              animations.transform = [];
            }
            animations.transform.push((0, _defineProperty3.default)({}, key.split(':')[1], animation));
          } else {
            animations[key] = animation;
          }
        };
        Object.keys(initialValues).forEach(function (key) {
          if (key.includes('transform')) {
            initialValues[key].forEach(function (transformProp, index) {
              Object.keys(transformProp).forEach(function (transformPropKey) {
                addAnimation(makeKeyframeKey(index, transformPropKey));
              });
            });
          } else {
            addAnimation(key);
          }
        });
        return {
          animations: animations,
          initialValues: initialValues,
          callback: callback
        };
      };
    });
    this.definitions = definitions;
  }
  return (0, _createClass2.default)(InnerKeyframe, [{
    key: "parseDefinitions",
    value: function parseDefinitions() {
      var _this2 = this;
      var parsedKeyframes = {};
      if (this.definitions.from) {
        if (this.definitions['0']) {
          throw new Error("[Reanimated] You cannot provide both keyframe 0 and 'from' as they both specified initial values.");
        }
        this.definitions['0'] = this.definitions.from;
        delete this.definitions.from;
      }
      if (this.definitions.to) {
        if (this.definitions['100']) {
          throw new Error("[Reanimated] You cannot provide both keyframe 100 and 'to' as they both specified values at the end of the animation.");
        }
        this.definitions['100'] = this.definitions.to;
        delete this.definitions.to;
      }
      if (!this.definitions['0']) {
        throw new Error("[Reanimated] Please provide 0 or 'from' keyframe with initial state of your object.");
      }
      var initialValues = this.definitions['0'];
      Object.keys(initialValues).forEach(function (styleProp) {
        if (styleProp === 'transform') {
          if (!Array.isArray(initialValues.transform)) {
            return;
          }
          initialValues.transform.forEach(function (transformStyle, index) {
            Object.keys(transformStyle).forEach(function (transformProp) {
              parsedKeyframes[makeKeyframeKey(index, transformProp)] = [];
            });
          });
        } else {
          parsedKeyframes[styleProp] = [];
        }
      });
      var duration = this.durationV ? this.durationV : 500;
      var animationKeyPoints = Array.from(Object.keys(this.definitions));
      var getAnimationDuration = function getAnimationDuration(key, currentKeyPoint) {
        var maxDuration = currentKeyPoint / 100 * duration;
        var currentDuration = parsedKeyframes[key].reduce(function (acc, value) {
          return acc + value.duration;
        }, 0);
        return maxDuration - currentDuration;
      };
      var addKeyPoint = function addKeyPoint(_ref) {
        var key = _ref.key,
          value = _ref.value,
          currentKeyPoint = _ref.currentKeyPoint,
          easing = _ref.easing;
        if (!(key in parsedKeyframes)) {
          throw new Error("[Reanimated] Keyframe can contain only that set of properties that were provide with initial values (keyframe 0 or 'from')");
        }
        if (__DEV__ && easing) {
          (0, _util.assertEasingIsWorklet)(easing);
        }
        parsedKeyframes[key].push({
          duration: getAnimationDuration(key, currentKeyPoint),
          value: value,
          easing: easing
        });
      };
      animationKeyPoints.filter(function (value) {
        return parseInt(value) !== 0;
      }).sort(function (a, b) {
        return parseInt(a) - parseInt(b);
      }).forEach(function (keyPoint) {
        if (parseInt(keyPoint) < 0 || parseInt(keyPoint) > 100) {
          throw new Error('[Reanimated] Keyframe should be in between range 0 - 100.');
        }
        var keyframe = _this2.definitions[keyPoint];
        var easing = keyframe.easing;
        delete keyframe.easing;
        var addKeyPointWith = function addKeyPointWith(key, value) {
          return addKeyPoint({
            key: key,
            value: value,
            currentKeyPoint: parseInt(keyPoint),
            easing: easing
          });
        };
        Object.keys(keyframe).forEach(function (key) {
          if (key === 'transform') {
            if (!Array.isArray(keyframe.transform)) {
              return;
            }
            keyframe.transform.forEach(function (transformStyle, index) {
              Object.keys(transformStyle).forEach(function (transformProp) {
                addKeyPointWith(makeKeyframeKey(index, transformProp), transformStyle[transformProp]);
              });
            });
          } else {
            addKeyPointWith(key, keyframe[key]);
          }
        });
      });
      return {
        initialValues: initialValues,
        keyframes: parsedKeyframes
      };
    }
  }, {
    key: "duration",
    value: function duration(durationMs) {
      this.durationV = durationMs;
      return this;
    }
  }, {
    key: "delay",
    value: function delay(delayMs) {
      this.delayV = delayMs;
      return this;
    }
  }, {
    key: "withCallback",
    value: function withCallback(callback) {
      this.callbackV = callback;
      return this;
    }
  }, {
    key: "reduceMotion",
    value: function reduceMotion(reduceMotionV) {
      this.reduceMotionV = reduceMotionV;
      return this;
    }
  }, {
    key: "getDelayFunction",
    value: function getDelayFunction() {
      var delay = this.delayV;
      var reduceMotion = this.reduceMotionV;
      return delay ? function (delay, animation) {
        'worklet';

        return (0, _animation.withDelay)(delay, animation, reduceMotion);
      } : function (_, animation) {
        'worklet';

        animation.reduceMotion = (0, _util.getReduceMotionFromConfig)(reduceMotion);
        return animation;
      };
    }
  }]);
}();
function makeKeyframeKey(index, transformProp) {
  'worklet';

  return `${index}_transform:${transformProp}`;
}
var Keyframe = exports.Keyframe = InnerKeyframe;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiS2V5ZnJhbWUiLCJfZGVmaW5lUHJvcGVydHkzIiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX0Vhc2luZyIsIl9hbmltYXRpb24iLCJfY29tbW9uVHlwZXMiLCJfdXRpbCIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsImtleSIsIl90b1Byb3BlcnR5S2V5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwidCIsImkiLCJfdG9QcmltaXRpdmUiLCJyIiwiZSIsIlN5bWJvbCIsInRvUHJpbWl0aXZlIiwiY2FsbCIsIlR5cGVFcnJvciIsIlN0cmluZyIsIk51bWJlciIsIklubmVyS2V5ZnJhbWUiLCJkZWZpbml0aW9ucyIsIl90aGlzIiwiZGVmYXVsdCIsIlJlZHVjZU1vdGlvbiIsIlN5c3RlbSIsImRlbGF5IiwiZGVsYXlWIiwiZGVsYXlGdW5jdGlvbiIsImdldERlbGF5RnVuY3Rpb24iLCJfdGhpcyRwYXJzZURlZmluaXRpb24iLCJwYXJzZURlZmluaXRpb25zIiwia2V5ZnJhbWVzIiwiaW5pdGlhbFZhbHVlcyIsImNhbGxiYWNrIiwiY2FsbGJhY2tWIiwiYW5pbWF0aW9ucyIsImFkZEFuaW1hdGlvbiIsImtleWZyYW1lUG9pbnRzIiwibGVuZ3RoIiwiYW5pbWF0aW9uIiwid2l0aFRpbWluZyIsImR1cmF0aW9uIiwiZWFzaW5nIiwiRWFzaW5nIiwibGluZWFyIiwid2l0aFNlcXVlbmNlIiwiYXBwbHkiLCJtYXAiLCJrZXlmcmFtZVBvaW50IiwiaW5jbHVkZXMiLCJ0cmFuc2Zvcm0iLCJwdXNoIiwic3BsaXQiLCJrZXlzIiwiZm9yRWFjaCIsInRyYW5zZm9ybVByb3AiLCJpbmRleCIsInRyYW5zZm9ybVByb3BLZXkiLCJtYWtlS2V5ZnJhbWVLZXkiLCJfdGhpczIiLCJwYXJzZWRLZXlmcmFtZXMiLCJmcm9tIiwiRXJyb3IiLCJ0byIsInN0eWxlUHJvcCIsIkFycmF5IiwiaXNBcnJheSIsInRyYW5zZm9ybVN0eWxlIiwiZHVyYXRpb25WIiwiYW5pbWF0aW9uS2V5UG9pbnRzIiwiZ2V0QW5pbWF0aW9uRHVyYXRpb24iLCJjdXJyZW50S2V5UG9pbnQiLCJtYXhEdXJhdGlvbiIsImN1cnJlbnREdXJhdGlvbiIsInJlZHVjZSIsImFjYyIsImFkZEtleVBvaW50IiwiX3JlZiIsIl9fREVWX18iLCJhc3NlcnRFYXNpbmdJc1dvcmtsZXQiLCJmaWx0ZXIiLCJwYXJzZUludCIsInNvcnQiLCJhIiwiYiIsImtleVBvaW50Iiwia2V5ZnJhbWUiLCJhZGRLZXlQb2ludFdpdGgiLCJkdXJhdGlvbk1zIiwiZGVsYXlNcyIsIndpdGhDYWxsYmFjayIsInJlZHVjZU1vdGlvbiIsInJlZHVjZU1vdGlvblYiLCJ3aXRoRGVsYXkiLCJfIiwiZ2V0UmVkdWNlTW90aW9uRnJvbUNvbmZpZyJdLCJzb3VyY2VzIjpbIktleWZyYW1lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmltcG9ydCB7IEVhc2luZyB9IGZyb20gJy4uLy4uL0Vhc2luZyc7XG5pbXBvcnQgeyB3aXRoRGVsYXksIHdpdGhTZXF1ZW5jZSwgd2l0aFRpbWluZyB9IGZyb20gJy4uLy4uL2FuaW1hdGlvbic7XG5pbXBvcnQgdHlwZSB7XG4gIEFuaW1hdGlvbkZ1bmN0aW9uLFxuICBFbnRyeUV4aXRBbmltYXRpb25GdW5jdGlvbixcbiAgSUVudHJ5RXhpdEFuaW1hdGlvbkJ1aWxkZXIsXG4gIEtleWZyYW1lUHJvcHMsXG4gIFN0eWxlUHJvcHNXaXRoQXJyYXlUcmFuc2Zvcm0sXG59IGZyb20gJy4vY29tbW9uVHlwZXMnO1xuaW1wb3J0IHR5cGUge1xuICBTdHlsZVByb3BzLFxuICBFYXNpbmdGdW5jdGlvbixcbiAgVHJhbnNmb3JtQXJyYXlJdGVtLFxufSBmcm9tICcuLi8uLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgeyBSZWR1Y2VNb3Rpb24gfSBmcm9tICcuLi8uLi9jb21tb25UeXBlcyc7XG5pbXBvcnQge1xuICBhc3NlcnRFYXNpbmdJc1dvcmtsZXQsXG4gIGdldFJlZHVjZU1vdGlvbkZyb21Db25maWcsXG59IGZyb20gJy4uLy4uL2FuaW1hdGlvbi91dGlsJztcblxuaW50ZXJmYWNlIEtleWZyYW1lUG9pbnQge1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICB2YWx1ZTogbnVtYmVyIHwgc3RyaW5nO1xuICBlYXNpbmc/OiBFYXNpbmdGdW5jdGlvbjtcbn1cbmludGVyZmFjZSBQYXJzZWRLZXlmcmFtZXNEZWZpbml0aW9uIHtcbiAgaW5pdGlhbFZhbHVlczogU3R5bGVQcm9wcztcbiAga2V5ZnJhbWVzOiBSZWNvcmQ8c3RyaW5nLCBLZXlmcmFtZVBvaW50W10+O1xufVxuY2xhc3MgSW5uZXJLZXlmcmFtZSBpbXBsZW1lbnRzIElFbnRyeUV4aXRBbmltYXRpb25CdWlsZGVyIHtcbiAgZHVyYXRpb25WPzogbnVtYmVyO1xuICBkZWxheVY/OiBudW1iZXI7XG4gIHJlZHVjZU1vdGlvblY6IFJlZHVjZU1vdGlvbiA9IFJlZHVjZU1vdGlvbi5TeXN0ZW07XG4gIGNhbGxiYWNrVj86IChmaW5pc2hlZDogYm9vbGVhbikgPT4gdm9pZDtcbiAgZGVmaW5pdGlvbnM6IFJlY29yZDxzdHJpbmcsIEtleWZyYW1lUHJvcHM+O1xuXG4gIC8qXG4gICAgS2V5ZnJhbWUgZGVmaW5pdGlvbiBzaG91bGQgYmUgcGFzc2VkIGluIHRoZSBjb25zdHJ1Y3RvciBhcyB0aGUgbWFwXG4gICAgd2hpY2gga2V5cyBhcmUgYmV0d2VlbiByYW5nZSAwIC0gMTAwICglKSBhbmQgY29ycmVzcG9uZCB0byB0aGUgcG9pbnQgaW4gdGhlIGFuaW1hdGlvbiBwcm9ncmVzcy5cbiAgKi9cbiAgY29uc3RydWN0b3IoZGVmaW5pdGlvbnM6IFJlY29yZDxzdHJpbmcsIEtleWZyYW1lUHJvcHM+KSB7XG4gICAgdGhpcy5kZWZpbml0aW9ucyA9IGRlZmluaXRpb25zO1xuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZURlZmluaXRpb25zKCk6IFBhcnNlZEtleWZyYW1lc0RlZmluaXRpb24ge1xuICAgIC8qIFxuICAgICAgICBFYWNoIHN0eWxlIHByb3BlcnR5IGNvbnRhaW4gYW4gYXJyYXkgd2l0aCBhbGwgdGhlaXIga2V5IHBvaW50czogXG4gICAgICAgIHZhbHVlLCBkdXJhdGlvbiBvZiB0cmFuc2l0aW9uIHRvIHRoYXQgdmFsdWUsIGFuZCBvcHRpb25hbCBlYXNpbmcgZnVuY3Rpb24gKGRlZmF1bHRzIHRvIExpbmVhcilcbiAgICAqL1xuICAgIGNvbnN0IHBhcnNlZEtleWZyYW1lczogUmVjb3JkPHN0cmluZywgS2V5ZnJhbWVQb2ludFtdPiA9IHt9O1xuICAgIC8qXG4gICAgICBQYXJzaW5nIGtleWZyYW1lcyAnZnJvbScgYW5kICd0bycuXG4gICAgKi9cbiAgICBpZiAodGhpcy5kZWZpbml0aW9ucy5mcm9tKSB7XG4gICAgICBpZiAodGhpcy5kZWZpbml0aW9uc1snMCddKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBcIltSZWFuaW1hdGVkXSBZb3UgY2Fubm90IHByb3ZpZGUgYm90aCBrZXlmcmFtZSAwIGFuZCAnZnJvbScgYXMgdGhleSBib3RoIHNwZWNpZmllZCBpbml0aWFsIHZhbHVlcy5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5kZWZpbml0aW9uc1snMCddID0gdGhpcy5kZWZpbml0aW9ucy5mcm9tO1xuICAgICAgZGVsZXRlIHRoaXMuZGVmaW5pdGlvbnMuZnJvbTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZGVmaW5pdGlvbnMudG8pIHtcbiAgICAgIGlmICh0aGlzLmRlZmluaXRpb25zWycxMDAnXSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJbUmVhbmltYXRlZF0gWW91IGNhbm5vdCBwcm92aWRlIGJvdGgga2V5ZnJhbWUgMTAwIGFuZCAndG8nIGFzIHRoZXkgYm90aCBzcGVjaWZpZWQgdmFsdWVzIGF0IHRoZSBlbmQgb2YgdGhlIGFuaW1hdGlvbi5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5kZWZpbml0aW9uc1snMTAwJ10gPSB0aGlzLmRlZmluaXRpb25zLnRvO1xuICAgICAgZGVsZXRlIHRoaXMuZGVmaW5pdGlvbnMudG87XG4gICAgfVxuICAgIC8qIFxuICAgICAgIE9uZSBvZiB0aGUgYXNzdW1wdGlvbnMgaXMgdGhhdCBrZXlmcmFtZSAgMCBpcyByZXF1aXJlZCB0byBwcm9wZXJseSBzZXQgaW5pdGlhbCB2YWx1ZXMuXG4gICAgICAgRXZlcnkgb3RoZXIga2V5ZnJhbWUgc2hvdWxkIGNvbnRhaW4gcHJvcGVydGllcyBmcm9tIHRoZSBzZXQgcHJvdmlkZWQgYXMgaW5pdGlhbCB2YWx1ZXMuXG4gICAgKi9cbiAgICBpZiAoIXRoaXMuZGVmaW5pdGlvbnNbJzAnXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIltSZWFuaW1hdGVkXSBQbGVhc2UgcHJvdmlkZSAwIG9yICdmcm9tJyBrZXlmcmFtZSB3aXRoIGluaXRpYWwgc3RhdGUgb2YgeW91ciBvYmplY3QuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGluaXRpYWxWYWx1ZXM6IFN0eWxlUHJvcHMgPSB0aGlzLmRlZmluaXRpb25zWycwJ10gYXMgU3R5bGVQcm9wcztcbiAgICAvKlxuICAgICAgSW5pdGlhbGl6ZSBwYXJzZWRLZXlmcmFtZXMgZm9yIHByb3BlcnRpZXMgcHJvdmlkZWQgaW4gaW5pdGlhbCBrZXlmcmFtZVxuICAgICovXG4gICAgT2JqZWN0LmtleXMoaW5pdGlhbFZhbHVlcykuZm9yRWFjaCgoc3R5bGVQcm9wOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChzdHlsZVByb3AgPT09ICd0cmFuc2Zvcm0nKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShpbml0aWFsVmFsdWVzLnRyYW5zZm9ybSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaW5pdGlhbFZhbHVlcy50cmFuc2Zvcm0uZm9yRWFjaCgodHJhbnNmb3JtU3R5bGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgT2JqZWN0LmtleXModHJhbnNmb3JtU3R5bGUpLmZvckVhY2goKHRyYW5zZm9ybVByb3A6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgcGFyc2VkS2V5ZnJhbWVzW21ha2VLZXlmcmFtZUtleShpbmRleCwgdHJhbnNmb3JtUHJvcCldID0gW107XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyc2VkS2V5ZnJhbWVzW3N0eWxlUHJvcF0gPSBbXTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGR1cmF0aW9uOiBudW1iZXIgPSB0aGlzLmR1cmF0aW9uViA/IHRoaXMuZHVyYXRpb25WIDogNTAwO1xuICAgIGNvbnN0IGFuaW1hdGlvbktleVBvaW50czogQXJyYXk8c3RyaW5nPiA9IEFycmF5LmZyb20oXG4gICAgICBPYmplY3Qua2V5cyh0aGlzLmRlZmluaXRpb25zKVxuICAgICk7XG5cbiAgICBjb25zdCBnZXRBbmltYXRpb25EdXJhdGlvbiA9IChcbiAgICAgIGtleTogc3RyaW5nLFxuICAgICAgY3VycmVudEtleVBvaW50OiBudW1iZXJcbiAgICApOiBudW1iZXIgPT4ge1xuICAgICAgY29uc3QgbWF4RHVyYXRpb24gPSAoY3VycmVudEtleVBvaW50IC8gMTAwKSAqIGR1cmF0aW9uO1xuICAgICAgY29uc3QgY3VycmVudER1cmF0aW9uID0gcGFyc2VkS2V5ZnJhbWVzW2tleV0ucmVkdWNlKFxuICAgICAgICAoYWNjOiBudW1iZXIsIHZhbHVlOiBLZXlmcmFtZVBvaW50KSA9PiBhY2MgKyB2YWx1ZS5kdXJhdGlvbixcbiAgICAgICAgMFxuICAgICAgKTtcbiAgICAgIHJldHVybiBtYXhEdXJhdGlvbiAtIGN1cnJlbnREdXJhdGlvbjtcbiAgICB9O1xuXG4gICAgLyogXG4gICAgICAgT3RoZXIga2V5ZnJhbWVzIGNhbid0IGNvbnRhaW4gcHJvcGVydGllcyB0aGF0IHdlcmUgbm90IHNwZWNpZmllZCBpbiBpbml0aWFsIGtleWZyYW1lLlxuICAgICovXG4gICAgY29uc3QgYWRkS2V5UG9pbnQgPSAoe1xuICAgICAga2V5LFxuICAgICAgdmFsdWUsXG4gICAgICBjdXJyZW50S2V5UG9pbnQsXG4gICAgICBlYXNpbmcsXG4gICAgfToge1xuICAgICAga2V5OiBzdHJpbmc7XG4gICAgICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xuICAgICAgY3VycmVudEtleVBvaW50OiBudW1iZXI7XG4gICAgICBlYXNpbmc/OiBFYXNpbmdGdW5jdGlvbjtcbiAgICB9KTogdm9pZCA9PiB7XG4gICAgICBpZiAoIShrZXkgaW4gcGFyc2VkS2V5ZnJhbWVzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgXCJbUmVhbmltYXRlZF0gS2V5ZnJhbWUgY2FuIGNvbnRhaW4gb25seSB0aGF0IHNldCBvZiBwcm9wZXJ0aWVzIHRoYXQgd2VyZSBwcm92aWRlIHdpdGggaW5pdGlhbCB2YWx1ZXMgKGtleWZyYW1lIDAgb3IgJ2Zyb20nKVwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChfX0RFVl9fICYmIGVhc2luZykge1xuICAgICAgICBhc3NlcnRFYXNpbmdJc1dvcmtsZXQoZWFzaW5nKTtcbiAgICAgIH1cblxuICAgICAgcGFyc2VkS2V5ZnJhbWVzW2tleV0ucHVzaCh7XG4gICAgICAgIGR1cmF0aW9uOiBnZXRBbmltYXRpb25EdXJhdGlvbihrZXksIGN1cnJlbnRLZXlQb2ludCksXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBlYXNpbmcsXG4gICAgICB9KTtcbiAgICB9O1xuICAgIGFuaW1hdGlvbktleVBvaW50c1xuICAgICAgLmZpbHRlcigodmFsdWU6IHN0cmluZykgPT4gcGFyc2VJbnQodmFsdWUpICE9PSAwKVxuICAgICAgLnNvcnQoKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBwYXJzZUludChhKSAtIHBhcnNlSW50KGIpKVxuICAgICAgLmZvckVhY2goKGtleVBvaW50OiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKHBhcnNlSW50KGtleVBvaW50KSA8IDAgfHwgcGFyc2VJbnQoa2V5UG9pbnQpID4gMTAwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgJ1tSZWFuaW1hdGVkXSBLZXlmcmFtZSBzaG91bGQgYmUgaW4gYmV0d2VlbiByYW5nZSAwIC0gMTAwLidcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleWZyYW1lOiBLZXlmcmFtZVByb3BzID0gdGhpcy5kZWZpbml0aW9uc1trZXlQb2ludF07XG4gICAgICAgIGNvbnN0IGVhc2luZyA9IGtleWZyYW1lLmVhc2luZztcbiAgICAgICAgZGVsZXRlIGtleWZyYW1lLmVhc2luZztcbiAgICAgICAgY29uc3QgYWRkS2V5UG9pbnRXaXRoID0gKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKSA9PlxuICAgICAgICAgIGFkZEtleVBvaW50KHtcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgY3VycmVudEtleVBvaW50OiBwYXJzZUludChrZXlQb2ludCksXG4gICAgICAgICAgICBlYXNpbmcsXG4gICAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5rZXlzKGtleWZyYW1lKS5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgICAgIGlmIChrZXkgPT09ICd0cmFuc2Zvcm0nKSB7XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoa2V5ZnJhbWUudHJhbnNmb3JtKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXlmcmFtZS50cmFuc2Zvcm0uZm9yRWFjaCgodHJhbnNmb3JtU3R5bGUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgIE9iamVjdC5rZXlzKHRyYW5zZm9ybVN0eWxlKS5mb3JFYWNoKCh0cmFuc2Zvcm1Qcm9wOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRLZXlQb2ludFdpdGgoXG4gICAgICAgICAgICAgICAgICBtYWtlS2V5ZnJhbWVLZXkoaW5kZXgsIHRyYW5zZm9ybVByb3ApLFxuICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtU3R5bGVbXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybVByb3AgYXMga2V5b2YgdHlwZW9mIHRyYW5zZm9ybVN0eWxlXG4gICAgICAgICAgICAgICAgICBdIGFzIG51bWJlciB8IHN0cmluZyAvLyBIZXJlIHdlIGFzc3VtZSB0aGF0IHVzZXIgaGFzIHBhc3NlZCBwcm9wcyBvZiBwcm9wZXIgdHlwZS5cbiAgICAgICAgICAgICAgICAgIC8vIEkgZG9uJ3QgdGhpbmsgaXQncyB3b3J0aHdoaWxlIHRvIGNoZWNrIGlmIGhlIHBhc3NlZCBpLmUuIGBBbmltYXRlZC5Ob2RlYC5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRLZXlQb2ludFdpdGgoa2V5LCBrZXlmcmFtZVtrZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgcmV0dXJuIHsgaW5pdGlhbFZhbHVlcywga2V5ZnJhbWVzOiBwYXJzZWRLZXlmcmFtZXMgfTtcbiAgfVxuXG4gIGR1cmF0aW9uKGR1cmF0aW9uTXM6IG51bWJlcik6IElubmVyS2V5ZnJhbWUge1xuICAgIHRoaXMuZHVyYXRpb25WID0gZHVyYXRpb25NcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRlbGF5KGRlbGF5TXM6IG51bWJlcik6IElubmVyS2V5ZnJhbWUge1xuICAgIHRoaXMuZGVsYXlWID0gZGVsYXlNcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHdpdGhDYWxsYmFjayhjYWxsYmFjazogKGZpbnNpaGVkOiBib29sZWFuKSA9PiB2b2lkKTogSW5uZXJLZXlmcmFtZSB7XG4gICAgdGhpcy5jYWxsYmFja1YgPSBjYWxsYmFjaztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHJlZHVjZU1vdGlvbihyZWR1Y2VNb3Rpb25WOiBSZWR1Y2VNb3Rpb24pOiB0aGlzIHtcbiAgICB0aGlzLnJlZHVjZU1vdGlvblYgPSByZWR1Y2VNb3Rpb25WO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXREZWxheUZ1bmN0aW9uKCk6IEFuaW1hdGlvbkZ1bmN0aW9uIHtcbiAgICBjb25zdCBkZWxheSA9IHRoaXMuZGVsYXlWO1xuICAgIGNvbnN0IHJlZHVjZU1vdGlvbiA9IHRoaXMucmVkdWNlTW90aW9uVjtcbiAgICByZXR1cm4gZGVsYXlcbiAgICAgID8gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3dcbiAgICAgICAgKGRlbGF5LCBhbmltYXRpb24pID0+IHtcbiAgICAgICAgICAnd29ya2xldCc7XG4gICAgICAgICAgcmV0dXJuIHdpdGhEZWxheShkZWxheSwgYW5pbWF0aW9uLCByZWR1Y2VNb3Rpb24pO1xuICAgICAgICB9XG4gICAgICA6IChfLCBhbmltYXRpb24pID0+IHtcbiAgICAgICAgICAnd29ya2xldCc7XG4gICAgICAgICAgYW5pbWF0aW9uLnJlZHVjZU1vdGlvbiA9IGdldFJlZHVjZU1vdGlvbkZyb21Db25maWcocmVkdWNlTW90aW9uKTtcbiAgICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgICAgICB9O1xuICB9XG5cbiAgYnVpbGQgPSAoKTogRW50cnlFeGl0QW5pbWF0aW9uRnVuY3Rpb24gPT4ge1xuICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5kZWxheVY7XG4gICAgY29uc3QgZGVsYXlGdW5jdGlvbiA9IHRoaXMuZ2V0RGVsYXlGdW5jdGlvbigpO1xuICAgIGNvbnN0IHsga2V5ZnJhbWVzLCBpbml0aWFsVmFsdWVzIH0gPSB0aGlzLnBhcnNlRGVmaW5pdGlvbnMoKTtcbiAgICBjb25zdCBjYWxsYmFjayA9IHRoaXMuY2FsbGJhY2tWO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICd3b3JrbGV0JztcbiAgICAgIGNvbnN0IGFuaW1hdGlvbnM6IFN0eWxlUHJvcHNXaXRoQXJyYXlUcmFuc2Zvcm0gPSB7fTtcblxuICAgICAgLyogXG4gICAgICAgICAgICBGb3IgZWFjaCBzdHlsZSBwcm9wZXJ0eSwgYW4gYW5pbWF0aW9ucyBzZXF1ZW5jZSBpcyBjcmVhdGVkIHRoYXQgY29ycmVzcG9uZHMgd2l0aCBpdHMga2V5IHBvaW50cy5cbiAgICAgICAgICAgIFRyYW5zZm9ybSBzdHlsZSBwcm9wZXJ0aWVzIHJlcXVpcmUgc3BlY2lhbCBoYW5kbGluZyBiZWNhdXNlIG9mIHRoZWlyIG5lc3RlZCBzdHJ1Y3R1cmUuXG4gICAgICAqL1xuICAgICAgY29uc3QgYWRkQW5pbWF0aW9uID0gKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGtleWZyYW1lUG9pbnRzID0ga2V5ZnJhbWVzW2tleV07XG4gICAgICAgIC8vIGluIGNhc2UgaWYgcHJvcGVydHkgd2FzIG9ubHkgcGFzc2VkIGFzIGluaXRpYWwgdmFsdWVcbiAgICAgICAgaWYgKGtleWZyYW1lUG9pbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbmltYXRpb24gPSBkZWxheUZ1bmN0aW9uKFxuICAgICAgICAgIGRlbGF5LFxuICAgICAgICAgIGtleWZyYW1lUG9pbnRzLmxlbmd0aCA9PT0gMVxuICAgICAgICAgICAgPyB3aXRoVGltaW5nKGtleWZyYW1lUG9pbnRzWzBdLnZhbHVlLCB7XG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGtleWZyYW1lUG9pbnRzWzBdLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGVhc2luZzoga2V5ZnJhbWVQb2ludHNbMF0uZWFzaW5nXG4gICAgICAgICAgICAgICAgICA/IGtleWZyYW1lUG9pbnRzWzBdLmVhc2luZ1xuICAgICAgICAgICAgICAgICAgOiBFYXNpbmcubGluZWFyLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiB3aXRoU2VxdWVuY2UoXG4gICAgICAgICAgICAgICAgLi4ua2V5ZnJhbWVQb2ludHMubWFwKChrZXlmcmFtZVBvaW50OiBLZXlmcmFtZVBvaW50KSA9PlxuICAgICAgICAgICAgICAgICAgd2l0aFRpbWluZyhrZXlmcmFtZVBvaW50LnZhbHVlLCB7XG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBrZXlmcmFtZVBvaW50LmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBlYXNpbmc6IGtleWZyYW1lUG9pbnQuZWFzaW5nXG4gICAgICAgICAgICAgICAgICAgICAgPyBrZXlmcmFtZVBvaW50LmVhc2luZ1xuICAgICAgICAgICAgICAgICAgICAgIDogRWFzaW5nLmxpbmVhcixcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICAgIGlmIChrZXkuaW5jbHVkZXMoJ3RyYW5zZm9ybScpKSB7XG4gICAgICAgICAgaWYgKCEoJ3RyYW5zZm9ybScgaW4gYW5pbWF0aW9ucykpIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbnMudHJhbnNmb3JtID0gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIGFuaW1hdGlvbnMudHJhbnNmb3JtIS5wdXNoKDxUcmFuc2Zvcm1BcnJheUl0ZW0+e1xuICAgICAgICAgICAgW2tleS5zcGxpdCgnOicpWzFdXTogYW5pbWF0aW9uLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFuaW1hdGlvbnNba2V5XSA9IGFuaW1hdGlvbjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE9iamVjdC5rZXlzKGluaXRpYWxWYWx1ZXMpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmIChrZXkuaW5jbHVkZXMoJ3RyYW5zZm9ybScpKSB7XG4gICAgICAgICAgaW5pdGlhbFZhbHVlc1trZXldLmZvckVhY2goXG4gICAgICAgICAgICAodHJhbnNmb3JtUHJvcDogUmVjb3JkPHN0cmluZywgbnVtYmVyIHwgc3RyaW5nPiwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0cmFuc2Zvcm1Qcm9wKS5mb3JFYWNoKCh0cmFuc2Zvcm1Qcm9wS2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRBbmltYXRpb24obWFrZUtleWZyYW1lS2V5KGluZGV4LCB0cmFuc2Zvcm1Qcm9wS2V5KSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWRkQW5pbWF0aW9uKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYW5pbWF0aW9ucyxcbiAgICAgICAgaW5pdGlhbFZhbHVlcyxcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICB9O1xuICAgIH07XG4gIH07XG59XG5cbmZ1bmN0aW9uIG1ha2VLZXlmcmFtZUtleShpbmRleDogbnVtYmVyLCB0cmFuc2Zvcm1Qcm9wOiBzdHJpbmcpIHtcbiAgJ3dvcmtsZXQnO1xuICByZXR1cm4gYCR7aW5kZXh9X3RyYW5zZm9ybToke3RyYW5zZm9ybVByb3B9YDtcbn1cblxuLy8gVE9ETyBUWVBFU0NSSVBUIFRoaXMgaXMgYSB0ZW1wb3JhcnkgdHlwZSB0byBnZXQgcmlkIG9mIC5kLnRzIGZpbGUuXG5leHBvcnQgZGVjbGFyZSBjbGFzcyBSZWFuaW1hdGVkS2V5ZnJhbWUge1xuICBjb25zdHJ1Y3RvcihkZWZpbml0aW9uczogUmVjb3JkPHN0cmluZywgS2V5ZnJhbWVQcm9wcz4pO1xuICBkdXJhdGlvbihkdXJhdGlvbk1zOiBudW1iZXIpOiBSZWFuaW1hdGVkS2V5ZnJhbWU7XG4gIGRlbGF5KGRlbGF5TXM6IG51bWJlcik6IFJlYW5pbWF0ZWRLZXlmcmFtZTtcbiAgcmVkdWNlTW90aW9uKHJlZHVjZU1vdGlvblY6IFJlZHVjZU1vdGlvbik6IFJlYW5pbWF0ZWRLZXlmcmFtZTtcbiAgd2l0aENhbGxiYWNrKGNhbGxiYWNrOiAoZmluaXNoZWQ6IGJvb2xlYW4pID0+IHZvaWQpOiBSZWFuaW1hdGVkS2V5ZnJhbWU7XG59XG5cbi8vIFRPRE8gVFlQRVNDUklQVCBUaGlzIHRlbXBvcmFyeSBjYXN0IGlzIHRvIGdldCByaWQgb2YgLmQudHMgZmlsZS5cbmV4cG9ydCBjb25zdCBLZXlmcmFtZSA9IElubmVyS2V5ZnJhbWUgYXMgdW5rbm93biBhcyB0eXBlb2YgUmVhbmltYXRlZEtleWZyYW1lO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUFBLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQUMsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsUUFBQTtBQUFBLElBQUFDLGdCQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBTyxtQkFBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQVEsZ0JBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFTLGFBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNaLElBQUFVLE9BQUEsR0FBQVYsT0FBQTtBQUNBLElBQUFXLFVBQUEsR0FBQVgsT0FBQTtBQWFBLElBQUFZLFlBQUEsR0FBQVosT0FBQTtBQUNBLElBQUFhLEtBQUEsR0FBQWIsT0FBQTtBQWhCYSxTQUFBYyxnQkFBQUMsR0FBQSxFQUFBQyxHQUFBLEVBQUFaLEtBQUE7RUFBQVksR0FBQSxHQUFBQyxjQUFBLENBQUFELEdBQUE7RUFBQSxJQUFBQSxHQUFBLElBQUFELEdBQUE7SUFBQWQsTUFBQSxDQUFBQyxjQUFBLENBQUFhLEdBQUEsRUFBQUMsR0FBQTtNQUFBWixLQUFBLEVBQUFBLEtBQUE7TUFBQWMsVUFBQTtNQUFBQyxZQUFBO01BQUFDLFFBQUE7SUFBQTtFQUFBO0lBQUFMLEdBQUEsQ0FBQUMsR0FBQSxJQUFBWixLQUFBO0VBQUE7RUFBQSxPQUFBVyxHQUFBO0FBQUE7QUFBQSxTQUFBRSxlQUFBSSxDQUFBO0VBQUEsSUFBQUMsQ0FBQSxHQUFBQyxZQUFBLENBQUFGLENBQUE7RUFBQSwwQkFBQUMsQ0FBQSxHQUFBQSxDQUFBLEdBQUFBLENBQUE7QUFBQTtBQUFBLFNBQUFDLGFBQUFGLENBQUEsRUFBQUcsQ0FBQTtFQUFBLHVCQUFBSCxDQUFBLEtBQUFBLENBQUEsU0FBQUEsQ0FBQTtFQUFBLElBQUFJLENBQUEsR0FBQUosQ0FBQSxDQUFBSyxNQUFBLENBQUFDLFdBQUE7RUFBQSxlQUFBRixDQUFBO0lBQUEsSUFBQUgsQ0FBQSxHQUFBRyxDQUFBLENBQUFHLElBQUEsQ0FBQVAsQ0FBQSxFQUFBRyxDQUFBO0lBQUEsdUJBQUFGLENBQUEsU0FBQUEsQ0FBQTtJQUFBLFVBQUFPLFNBQUE7RUFBQTtFQUFBLHFCQUFBTCxDQUFBLEdBQUFNLE1BQUEsR0FBQUMsTUFBQSxFQUFBVixDQUFBO0FBQUE7QUFBQSxJQThCUFcsYUFBYTtFQVdqQixTQUFBQSxjQUFZQyxXQUEwQyxFQUFFO0lBQUEsSUFBQUMsS0FBQTtJQUFBLElBQUExQixnQkFBQSxDQUFBMkIsT0FBQSxRQUFBSCxhQUFBO0lBQUFsQixlQUFBO0lBQUFBLGVBQUE7SUFBQUEsZUFBQSx3QkFSMUJzQix5QkFBWSxDQUFDQyxNQUFNO0lBQUF2QixlQUFBO0lBQUFBLGVBQUE7SUFBQUEsZUFBQSxnQkFpTXpDLFlBQWtDO01BQ3hDLElBQU13QixLQUFLLEdBQUdKLEtBQUksQ0FBQ0ssTUFBTTtNQUN6QixJQUFNQyxhQUFhLEdBQUdOLEtBQUksQ0FBQ08sZ0JBQWdCLENBQUMsQ0FBQztNQUM3QyxJQUFBQyxxQkFBQSxHQUFxQ1IsS0FBSSxDQUFDUyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQXBEQyxTQUFTLEdBQUFGLHFCQUFBLENBQVRFLFNBQVM7UUFBRUMsYUFBQSxHQUFBSCxxQkFBQSxDQUFBRyxhQUFBO01BQ25CLElBQU1DLFFBQVEsR0FBR1osS0FBSSxDQUFDYSxTQUFTO01BRS9CLE9BQU8sWUFBTTtRQUNYLFNBQVM7O1FBQ1QsSUFBTUMsVUFBd0MsR0FBRyxDQUFDLENBQUM7UUFNbkQsSUFBTUMsWUFBWSxHQUFJLFNBQWhCQSxZQUFZQSxDQUFJakMsR0FBVyxFQUFLO1VBQ3BDLElBQU1rQyxjQUFjLEdBQUdOLFNBQVMsQ0FBQzVCLEdBQUcsQ0FBQztVQUVyQyxJQUFJa0MsY0FBYyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQy9CO1VBQ0Y7VUFDQSxJQUFNQyxTQUFTLEdBQUdaLGFBQWEsQ0FDN0JGLEtBQUssRUFDTFksY0FBYyxDQUFDQyxNQUFNLEtBQUssQ0FBQyxHQUN2QixJQUFBRSxxQkFBVSxFQUFDSCxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM5QyxLQUFLLEVBQUU7WUFDbENrRCxRQUFRLEVBQUVKLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQ0ksUUFBUTtZQUNwQ0MsTUFBTSxFQUFFTCxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUNLLE1BQU0sR0FDNUJMLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQ0ssTUFBTSxHQUN4QkMsY0FBTSxDQUFDQztVQUNiLENBQUMsQ0FBQyxHQUNGQyx1QkFBWSxDQUFBQyxLQUFBLGFBQUFwRCxtQkFBQSxDQUFBNEIsT0FBQSxFQUNQZSxjQUFjLENBQUNVLEdBQUcsQ0FBRSxVQUFBQyxhQUE0QjtZQUFBLE9BQ2pELElBQUFSLHFCQUFVLEVBQUNRLGFBQWEsQ0FBQ3pELEtBQUssRUFBRTtjQUM5QmtELFFBQVEsRUFBRU8sYUFBYSxDQUFDUCxRQUFRO2NBQ2hDQyxNQUFNLEVBQUVNLGFBQWEsQ0FBQ04sTUFBTSxHQUN4Qk0sYUFBYSxDQUFDTixNQUFNLEdBQ3BCQyxjQUFNLENBQUNDO1lBQ2IsQ0FBQyxDQUNIO1VBQUEsRUFDRixFQUNOLENBQUM7VUFDRCxJQUFJekMsR0FBRyxDQUFDOEMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQzdCLElBQUksRUFBRSxXQUFXLElBQUlkLFVBQVUsQ0FBQyxFQUFFO2NBQ2hDQSxVQUFVLENBQUNlLFNBQVMsR0FBRyxFQUFFO1lBQzNCO1lBQ0FmLFVBQVUsQ0FBQ2UsU0FBUyxDQUFFQyxJQUFJLEtBQUExRCxnQkFBQSxDQUFBNkIsT0FBQSxNQUN2Qm5CLEdBQUcsQ0FBQ2lELEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBR2IsU0FBQSxDQUN0QixDQUFDO1VBQ0osQ0FBQyxNQUFNO1lBQ0xKLFVBQVUsQ0FBQ2hDLEdBQUcsQ0FBQyxHQUFHb0MsU0FBUztVQUM3QjtRQUNGLENBQUM7UUFDRG5ELE1BQU0sQ0FBQ2lFLElBQUksQ0FBQ3JCLGFBQWEsQ0FBQyxDQUFDc0IsT0FBTyxDQUFFLFVBQUFuRCxHQUFXLEVBQUs7VUFDbEQsSUFBSUEsR0FBRyxDQUFDOEMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQzdCakIsYUFBYSxDQUFDN0IsR0FBRyxDQUFDLENBQUNtRCxPQUFPLENBQ3hCLFVBQUNDLGFBQThDLEVBQUVDLEtBQWEsRUFBSztjQUNqRXBFLE1BQU0sQ0FBQ2lFLElBQUksQ0FBQ0UsYUFBYSxDQUFDLENBQUNELE9BQU8sQ0FBRSxVQUFBRyxnQkFBd0IsRUFBSztnQkFDL0RyQixZQUFZLENBQUNzQixlQUFlLENBQUNGLEtBQUssRUFBRUMsZ0JBQWdCLENBQUMsQ0FBQztjQUN4RCxDQUFDLENBQUM7WUFDSixDQUNGLENBQUM7VUFDSCxDQUFDLE1BQU07WUFDTHJCLFlBQVksQ0FBQ2pDLEdBQUcsQ0FBQztVQUNuQjtRQUNGLENBQUMsQ0FBQztRQUNGLE9BQU87VUFDTGdDLFVBQVUsRUFBVkEsVUFBVTtVQUNWSCxhQUFhLEVBQWJBLGFBQWE7VUFDYkMsUUFBQSxFQUFBQTtRQUNGLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQTlQQyxJQUFJLENBQUNiLFdBQVcsR0FBR0EsV0FBVztFQUNoQztFQUFBLFdBQUF4QixhQUFBLENBQUEwQixPQUFBLEVBQUFILGFBQUE7SUFBQWhCLEdBQUE7SUFBQVosS0FBQSxFQUVRLFNBQUF1QyxnQkFBZ0JBLENBQUEsRUFBOEI7TUFBQSxJQUFBNkIsTUFBQTtNQUtwRCxJQUFNQyxlQUFnRCxHQUFHLENBQUMsQ0FBQztNQUkzRCxJQUFJLElBQUksQ0FBQ3hDLFdBQVcsQ0FBQ3lDLElBQUksRUFBRTtRQUN6QixJQUFJLElBQUksQ0FBQ3pDLFdBQVcsQ0FBQyxHQUFHLENBQUMsRUFBRTtVQUN6QixNQUFNLElBQUkwQyxLQUFLLENBQ2IsbUdBQ0YsQ0FBQztRQUNIO1FBQ0EsSUFBSSxDQUFDMUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQ0EsV0FBVyxDQUFDeUMsSUFBSTtRQUM3QyxPQUFPLElBQUksQ0FBQ3pDLFdBQVcsQ0FBQ3lDLElBQUk7TUFDOUI7TUFDQSxJQUFJLElBQUksQ0FBQ3pDLFdBQVcsQ0FBQzJDLEVBQUUsRUFBRTtRQUN2QixJQUFJLElBQUksQ0FBQzNDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRTtVQUMzQixNQUFNLElBQUkwQyxLQUFLLENBQ2IsdUhBQ0YsQ0FBQztRQUNIO1FBQ0EsSUFBSSxDQUFDMUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQ0EsV0FBVyxDQUFDMkMsRUFBRTtRQUM3QyxPQUFPLElBQUksQ0FBQzNDLFdBQVcsQ0FBQzJDLEVBQUU7TUFDNUI7TUFLQSxJQUFJLENBQUMsSUFBSSxDQUFDM0MsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQzFCLE1BQU0sSUFBSTBDLEtBQUssQ0FDYixxRkFDRixDQUFDO01BQ0g7TUFDQSxJQUFNOUIsYUFBeUIsR0FBRyxJQUFJLENBQUNaLFdBQVcsQ0FBQyxHQUFHLENBQWU7TUFJckVoQyxNQUFNLENBQUNpRSxJQUFJLENBQUNyQixhQUFhLENBQUMsQ0FBQ3NCLE9BQU8sQ0FBRSxVQUFBVSxTQUFpQixFQUFLO1FBQ3hELElBQUlBLFNBQVMsS0FBSyxXQUFXLEVBQUU7VUFDN0IsSUFBSSxDQUFDQyxLQUFLLENBQUNDLE9BQU8sQ0FBQ2xDLGFBQWEsQ0FBQ2tCLFNBQVMsQ0FBQyxFQUFFO1lBQzNDO1VBQ0Y7VUFDQWxCLGFBQWEsQ0FBQ2tCLFNBQVMsQ0FBQ0ksT0FBTyxDQUFDLFVBQUNhLGNBQWMsRUFBRVgsS0FBSyxFQUFLO1lBQ3pEcEUsTUFBTSxDQUFDaUUsSUFBSSxDQUFDYyxjQUFjLENBQUMsQ0FBQ2IsT0FBTyxDQUFFLFVBQUFDLGFBQXFCLEVBQUs7Y0FDN0RLLGVBQWUsQ0FBQ0YsZUFBZSxDQUFDRixLQUFLLEVBQUVELGFBQWEsQ0FBQyxDQUFDLEdBQUcsRUFBRTtZQUM3RCxDQUFDLENBQUM7VUFDSixDQUFDLENBQUM7UUFDSixDQUFDLE1BQU07VUFDTEssZUFBZSxDQUFDSSxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2pDO01BQ0YsQ0FBQyxDQUFDO01BRUYsSUFBTXZCLFFBQWdCLEdBQUcsSUFBSSxDQUFDMkIsU0FBUyxHQUFHLElBQUksQ0FBQ0EsU0FBUyxHQUFHLEdBQUc7TUFDOUQsSUFBTUMsa0JBQWlDLEdBQUdKLEtBQUssQ0FBQ0osSUFBSSxDQUNsRHpFLE1BQU0sQ0FBQ2lFLElBQUksQ0FBQyxJQUFJLENBQUNqQyxXQUFXLENBQzlCLENBQUM7TUFFRCxJQUFNa0Qsb0JBQW9CLEdBQUcsU0FBdkJBLG9CQUFvQkEsQ0FDeEJuRSxHQUFXLEVBQ1hvRSxlQUF1QixFQUNaO1FBQ1gsSUFBTUMsV0FBVyxHQUFJRCxlQUFlLEdBQUcsR0FBRyxHQUFJOUIsUUFBUTtRQUN0RCxJQUFNZ0MsZUFBZSxHQUFHYixlQUFlLENBQUN6RCxHQUFHLENBQUMsQ0FBQ3VFLE1BQU0sQ0FDakQsVUFBQ0MsR0FBVyxFQUFFcEYsS0FBb0I7VUFBQSxPQUFLb0YsR0FBRyxHQUFHcEYsS0FBSyxDQUFDa0QsUUFBUTtRQUFBLEdBQzNELENBQ0YsQ0FBQztRQUNELE9BQU8rQixXQUFXLEdBQUdDLGVBQWU7TUFDdEMsQ0FBQztNQUtELElBQU1HLFdBQVcsR0FBRyxTQUFkQSxXQUFXQSxDQUFBQyxJQUFBLEVBVUw7UUFBQSxJQVRWMUUsR0FBRyxHQUFBMEUsSUFBQSxDQUFIMUUsR0FBRztVQUNIWixLQUFLLEdBQUFzRixJQUFBLENBQUx0RixLQUFLO1VBQ0xnRixlQUFlLEdBQUFNLElBQUEsQ0FBZk4sZUFBZTtVQUNmN0IsTUFBQSxHQUFBbUMsSUFBQSxDQUFBbkMsTUFBQTtRQU9BLElBQUksRUFBRXZDLEdBQUcsSUFBSXlELGVBQWUsQ0FBQyxFQUFFO1VBQzdCLE1BQU0sSUFBSUUsS0FBSyxDQUNiLDRIQUNGLENBQUM7UUFDSDtRQUVBLElBQUlnQixPQUFPLElBQUlwQyxNQUFNLEVBQUU7VUFDckIsSUFBQXFDLDJCQUFxQixFQUFDckMsTUFBTSxDQUFDO1FBQy9CO1FBRUFrQixlQUFlLENBQUN6RCxHQUFHLENBQUMsQ0FBQ2dELElBQUksQ0FBQztVQUN4QlYsUUFBUSxFQUFFNkIsb0JBQW9CLENBQUNuRSxHQUFHLEVBQUVvRSxlQUFlLENBQUM7VUFDcERoRixLQUFLLEVBQUxBLEtBQUs7VUFDTG1ELE1BQUEsRUFBQUE7UUFDRixDQUFDLENBQUM7TUFDSixDQUFDO01BQ0QyQixrQkFBa0IsQ0FDZlcsTUFBTSxDQUFFLFVBQUF6RixLQUFhO1FBQUEsT0FBSzBGLFFBQVEsQ0FBQzFGLEtBQUssQ0FBQyxLQUFLLENBQUM7TUFBQSxFQUFDLENBQ2hEMkYsSUFBSSxDQUFDLFVBQUNDLENBQVMsRUFBRUMsQ0FBUztRQUFBLE9BQUtILFFBQVEsQ0FBQ0UsQ0FBQyxDQUFDLEdBQUdGLFFBQVEsQ0FBQ0csQ0FBQyxDQUFDO01BQUEsRUFBQyxDQUN6RDlCLE9BQU8sQ0FBRSxVQUFBK0IsUUFBZ0IsRUFBSztRQUM3QixJQUFJSixRQUFRLENBQUNJLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSUosUUFBUSxDQUFDSSxRQUFRLENBQUMsR0FBRyxHQUFHLEVBQUU7VUFDdEQsTUFBTSxJQUFJdkIsS0FBSyxDQUNiLDJEQUNGLENBQUM7UUFDSDtRQUNBLElBQU13QixRQUF1QixHQUFHM0IsTUFBSSxDQUFDdkMsV0FBVyxDQUFDaUUsUUFBUSxDQUFDO1FBQzFELElBQU0zQyxNQUFNLEdBQUc0QyxRQUFRLENBQUM1QyxNQUFNO1FBQzlCLE9BQU80QyxRQUFRLENBQUM1QyxNQUFNO1FBQ3RCLElBQU02QyxlQUFlLEdBQUcsU0FBbEJBLGVBQWVBLENBQUlwRixHQUFXLEVBQUVaLEtBQXNCO1VBQUEsT0FDMURxRixXQUFXLENBQUM7WUFDVnpFLEdBQUcsRUFBSEEsR0FBRztZQUNIWixLQUFLLEVBQUxBLEtBQUs7WUFDTGdGLGVBQWUsRUFBRVUsUUFBUSxDQUFDSSxRQUFRLENBQUM7WUFDbkMzQyxNQUFBLEVBQUFBO1VBQ0YsQ0FBQyxDQUFDO1FBQUE7UUFDSnRELE1BQU0sQ0FBQ2lFLElBQUksQ0FBQ2lDLFFBQVEsQ0FBQyxDQUFDaEMsT0FBTyxDQUFFLFVBQUFuRCxHQUFXLEVBQUs7VUFDN0MsSUFBSUEsR0FBRyxLQUFLLFdBQVcsRUFBRTtZQUN2QixJQUFJLENBQUM4RCxLQUFLLENBQUNDLE9BQU8sQ0FBQ29CLFFBQVEsQ0FBQ3BDLFNBQVMsQ0FBQyxFQUFFO2NBQ3RDO1lBQ0Y7WUFDQW9DLFFBQVEsQ0FBQ3BDLFNBQVMsQ0FBQ0ksT0FBTyxDQUFDLFVBQUNhLGNBQWMsRUFBRVgsS0FBSyxFQUFLO2NBQ3BEcEUsTUFBTSxDQUFDaUUsSUFBSSxDQUFDYyxjQUFjLENBQUMsQ0FBQ2IsT0FBTyxDQUFFLFVBQUFDLGFBQXFCLEVBQUs7Z0JBQzdEZ0MsZUFBZSxDQUNiN0IsZUFBZSxDQUFDRixLQUFLLEVBQUVELGFBQWEsQ0FBQyxFQUNyQ1ksY0FBYyxDQUNaWixhQUFhLENBR2pCLENBQUM7Y0FDSCxDQUFDLENBQUM7WUFDSixDQUFDLENBQUM7VUFDSixDQUFDLE1BQU07WUFDTGdDLGVBQWUsQ0FBQ3BGLEdBQUcsRUFBRW1GLFFBQVEsQ0FBQ25GLEdBQUcsQ0FBQyxDQUFDO1VBQ3JDO1FBQ0YsQ0FBQyxDQUFDO01BQ0osQ0FBQyxDQUFDO01BQ0osT0FBTztRQUFFNkIsYUFBYSxFQUFiQSxhQUFhO1FBQUVELFNBQVMsRUFBRTZCO01BQWdCLENBQUM7SUFDdEQ7RUFBQTtJQUFBekQsR0FBQTtJQUFBWixLQUFBLEVBRUEsU0FBQWtELFFBQVFBLENBQUMrQyxVQUFrQixFQUFpQjtNQUMxQyxJQUFJLENBQUNwQixTQUFTLEdBQUdvQixVQUFVO01BQzNCLE9BQU8sSUFBSTtJQUNiO0VBQUE7SUFBQXJGLEdBQUE7SUFBQVosS0FBQSxFQUVBLFNBQUFrQyxLQUFLQSxDQUFDZ0UsT0FBZSxFQUFpQjtNQUNwQyxJQUFJLENBQUMvRCxNQUFNLEdBQUcrRCxPQUFPO01BQ3JCLE9BQU8sSUFBSTtJQUNiO0VBQUE7SUFBQXRGLEdBQUE7SUFBQVosS0FBQSxFQUVBLFNBQUFtRyxZQUFZQSxDQUFDekQsUUFBcUMsRUFBaUI7TUFDakUsSUFBSSxDQUFDQyxTQUFTLEdBQUdELFFBQVE7TUFDekIsT0FBTyxJQUFJO0lBQ2I7RUFBQTtJQUFBOUIsR0FBQTtJQUFBWixLQUFBLEVBRUEsU0FBQW9HLFlBQVlBLENBQUNDLGFBQTJCLEVBQVE7TUFDOUMsSUFBSSxDQUFDQSxhQUFhLEdBQUdBLGFBQWE7TUFDbEMsT0FBTyxJQUFJO0lBQ2I7RUFBQTtJQUFBekYsR0FBQTtJQUFBWixLQUFBLEVBRVEsU0FBQXFDLGdCQUFnQkEsQ0FBQSxFQUFzQjtNQUM1QyxJQUFNSCxLQUFLLEdBQUcsSUFBSSxDQUFDQyxNQUFNO01BQ3pCLElBQU1pRSxZQUFZLEdBQUcsSUFBSSxDQUFDQyxhQUFhO01BQ3ZDLE9BQU9uRSxLQUFLLEdBRVIsVUFBQ0EsS0FBSyxFQUFFYyxTQUFTLEVBQUs7UUFDcEIsU0FBUzs7UUFDVCxPQUFPLElBQUFzRCxvQkFBUyxFQUFDcEUsS0FBSyxFQUFFYyxTQUFTLEVBQUVvRCxZQUFZLENBQUM7TUFDbEQsQ0FBQyxHQUNELFVBQUNHLENBQUMsRUFBRXZELFNBQVMsRUFBSztRQUNoQixTQUFTOztRQUNUQSxTQUFTLENBQUNvRCxZQUFZLEdBQUcsSUFBQUksK0JBQXlCLEVBQUNKLFlBQVksQ0FBQztRQUNoRSxPQUFPcEQsU0FBUztNQUNsQixDQUFDO0lBQ1A7RUFBQTtBQUFBO0FBMkVGLFNBQVNtQixlQUFlQSxDQUFDRixLQUFhLEVBQUVELGFBQXFCLEVBQUU7RUFDN0QsU0FBUzs7RUFDVCxPQUFRLEdBQUVDLEtBQU0sY0FBYUQsYUFBYyxFQUFDO0FBQzlDO0FBWU8sSUFBTS9ELFFBQVEsR0FBQUYsT0FBQSxDQUFBRSxRQUFBLEdBQUcyQixhQUFxRCIsImlnbm9yZUxpc3QiOltdfQ==