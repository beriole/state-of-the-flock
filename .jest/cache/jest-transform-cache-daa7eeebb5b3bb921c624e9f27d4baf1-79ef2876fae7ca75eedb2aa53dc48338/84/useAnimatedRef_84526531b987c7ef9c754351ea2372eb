59fcf485f14a9b3984230fb643137ec8
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAnimatedRef = useAnimatedRef;
var _react = require("react");
var _useSharedValue = require("./useSharedValue");
var _fabricUtils = require("../fabricUtils");
var _shareables = require("../shareables");
var _shareableMappingCache = require("../shareableMappingCache");
var _reactNative = require("react-native");
var _PlatformChecker = require("../PlatformChecker");
var IS_WEB = (0, _PlatformChecker.isWeb)();
function getComponentOrScrollable(component) {
  if ((0, _PlatformChecker.isFabric)() && component.getNativeScrollRef) {
    return component.getNativeScrollRef();
  } else if (!(0, _PlatformChecker.isFabric)() && component.getScrollableNode) {
    return component.getScrollableNode();
  }
  return component;
}
function useAnimatedRef() {
  var tag = (0, _useSharedValue.useSharedValue)(-1);
  var viewName = (0, _useSharedValue.useSharedValue)(null);
  var ref = (0, _react.useRef)();
  if (!ref.current) {
    var _fun = function fun(component) {
      if (component) {
        var getTagValueFunction = (0, _PlatformChecker.isFabric)() ? _fabricUtils.getShadowNodeWrapperFromRef : _reactNative.findNodeHandle;
        var getTagOrShadowNodeWrapper = function getTagOrShadowNodeWrapper() {
          return IS_WEB ? getComponentOrScrollable(component) : getTagValueFunction(getComponentOrScrollable(component));
        };
        tag.value = getTagOrShadowNodeWrapper();
        _fun.getTag = (0, _PlatformChecker.isFabric)() ? function () {
          return (0, _reactNative.findNodeHandle)(getComponentOrScrollable(component));
        } : getTagOrShadowNodeWrapper;
        _fun.current = component;
        if (_reactNative.Platform.OS === 'ios' && !(0, _PlatformChecker.isFabric)()) {
          var _viewConfig;
          viewName.value = (component === null || component === void 0 || (_viewConfig = component.viewConfig) === null || _viewConfig === void 0 ? void 0 : _viewConfig.uiViewClassName) || 'RCTView';
        }
      }
      return tag.value;
    };
    _fun.current = null;
    var animatedRefShareableHandle = (0, _shareables.makeShareableCloneRecursive)({
      __init: function __init() {
        'worklet';

        var f = function f() {
          return tag.value;
        };
        f.viewName = viewName;
        return f;
      }
    });
    _shareableMappingCache.shareableMappingCache.set(_fun, animatedRefShareableHandle);
    ref.current = _fun;
  }
  return ref.current;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInVzZUFuaW1hdGVkUmVmIiwiX3JlYWN0IiwicmVxdWlyZSIsIl91c2VTaGFyZWRWYWx1ZSIsIl9mYWJyaWNVdGlscyIsIl9zaGFyZWFibGVzIiwiX3NoYXJlYWJsZU1hcHBpbmdDYWNoZSIsIl9yZWFjdE5hdGl2ZSIsIl9QbGF0Zm9ybUNoZWNrZXIiLCJJU19XRUIiLCJpc1dlYiIsImdldENvbXBvbmVudE9yU2Nyb2xsYWJsZSIsImNvbXBvbmVudCIsImlzRmFicmljIiwiZ2V0TmF0aXZlU2Nyb2xsUmVmIiwiZ2V0U2Nyb2xsYWJsZU5vZGUiLCJ0YWciLCJ1c2VTaGFyZWRWYWx1ZSIsInZpZXdOYW1lIiwicmVmIiwidXNlUmVmIiwiY3VycmVudCIsImZ1biIsImdldFRhZ1ZhbHVlRnVuY3Rpb24iLCJnZXRTaGFkb3dOb2RlV3JhcHBlckZyb21SZWYiLCJmaW5kTm9kZUhhbmRsZSIsImdldFRhZ09yU2hhZG93Tm9kZVdyYXBwZXIiLCJnZXRUYWciLCJQbGF0Zm9ybSIsIk9TIiwiX3ZpZXdDb25maWciLCJ2aWV3Q29uZmlnIiwidWlWaWV3Q2xhc3NOYW1lIiwiYW5pbWF0ZWRSZWZTaGFyZWFibGVIYW5kbGUiLCJtYWtlU2hhcmVhYmxlQ2xvbmVSZWN1cnNpdmUiLCJfX2luaXQiLCJmIiwic2hhcmVhYmxlTWFwcGluZ0NhY2hlIiwic2V0Il0sInNvdXJjZXMiOlsidXNlQW5pbWF0ZWRSZWYudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHR5cGUgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VTaGFyZWRWYWx1ZSB9IGZyb20gJy4vdXNlU2hhcmVkVmFsdWUnO1xuaW1wb3J0IHR5cGUgeyBBbmltYXRlZFJlZiwgQW5pbWF0ZWRSZWZPblVJIH0gZnJvbSAnLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgdHlwZSB7IFNoYWRvd05vZGVXcmFwcGVyIH0gZnJvbSAnLi4vY29tbW9uVHlwZXMnO1xuaW1wb3J0IHsgZ2V0U2hhZG93Tm9kZVdyYXBwZXJGcm9tUmVmIH0gZnJvbSAnLi4vZmFicmljVXRpbHMnO1xuaW1wb3J0IHsgbWFrZVNoYXJlYWJsZUNsb25lUmVjdXJzaXZlIH0gZnJvbSAnLi4vc2hhcmVhYmxlcyc7XG5pbXBvcnQgeyBzaGFyZWFibGVNYXBwaW5nQ2FjaGUgfSBmcm9tICcuLi9zaGFyZWFibGVNYXBwaW5nQ2FjaGUnO1xuaW1wb3J0IHsgUGxhdGZvcm0sIGZpbmROb2RlSGFuZGxlIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCB0eXBlIHsgU2Nyb2xsVmlldywgRmxhdExpc3QgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IHsgaXNGYWJyaWMsIGlzV2ViIH0gZnJvbSAnLi4vUGxhdGZvcm1DaGVja2VyJztcblxuY29uc3QgSVNfV0VCID0gaXNXZWIoKTtcblxuaW50ZXJmYWNlIE1heWJlU2Nyb2xsYWJsZUNvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XG4gIGdldE5hdGl2ZVNjcm9sbFJlZj86IEZsYXRMaXN0WydnZXROYXRpdmVTY3JvbGxSZWYnXTtcbiAgZ2V0U2Nyb2xsYWJsZU5vZGU/OlxuICAgIHwgU2Nyb2xsVmlld1snZ2V0U2Nyb2xsYWJsZU5vZGUnXVxuICAgIHwgRmxhdExpc3RbJ2dldFNjcm9sbGFibGVOb2RlJ107XG4gIHZpZXdDb25maWc/OiB7XG4gICAgdWlWaWV3Q2xhc3NOYW1lPzogc3RyaW5nO1xuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRDb21wb25lbnRPclNjcm9sbGFibGUoY29tcG9uZW50OiBNYXliZVNjcm9sbGFibGVDb21wb25lbnQpIHtcbiAgaWYgKGlzRmFicmljKCkgJiYgY29tcG9uZW50LmdldE5hdGl2ZVNjcm9sbFJlZikge1xuICAgIHJldHVybiBjb21wb25lbnQuZ2V0TmF0aXZlU2Nyb2xsUmVmKCk7XG4gIH0gZWxzZSBpZiAoIWlzRmFicmljKCkgJiYgY29tcG9uZW50LmdldFNjcm9sbGFibGVOb2RlKSB7XG4gICAgcmV0dXJuIGNvbXBvbmVudC5nZXRTY3JvbGxhYmxlTm9kZSgpO1xuICB9XG4gIHJldHVybiBjb21wb25lbnQ7XG59XG5cbi8qKlxuICogTGV0cyB5b3UgZ2V0IGEgcmVmZXJlbmNlIG9mIGEgdmlldyB0aGF0IHlvdSBjYW4gdXNlIGluc2lkZSBhIHdvcmtsZXQuXG4gKlxuICogQHJldHVybnMgQW4gb2JqZWN0IHdpdGggYSBgLmN1cnJlbnRgIHByb3BlcnR5IHdoaWNoIGNvbnRhaW5zIGFuIGluc3RhbmNlIG9mIGEgY29tcG9uZW50LlxuICogQHNlZSBodHRwczovL2RvY3Muc3dtYW5zaW9uLmNvbS9yZWFjdC1uYXRpdmUtcmVhbmltYXRlZC9kb2NzL2NvcmUvdXNlQW5pbWF0ZWRSZWZcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUFuaW1hdGVkUmVmPFxuICBUQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50XG4+KCk6IEFuaW1hdGVkUmVmPFRDb21wb25lbnQ+IHtcbiAgY29uc3QgdGFnID0gdXNlU2hhcmVkVmFsdWU8bnVtYmVyIHwgU2hhZG93Tm9kZVdyYXBwZXIgfCBudWxsPigtMSk7XG4gIGNvbnN0IHZpZXdOYW1lID0gdXNlU2hhcmVkVmFsdWU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG5cbiAgY29uc3QgcmVmID0gdXNlUmVmPEFuaW1hdGVkUmVmPFRDb21wb25lbnQ+PigpO1xuXG4gIGlmICghcmVmLmN1cnJlbnQpIHtcbiAgICBjb25zdCBmdW46IEFuaW1hdGVkUmVmPFRDb21wb25lbnQ+ID0gPEFuaW1hdGVkUmVmPFRDb21wb25lbnQ+PigoXG4gICAgICBjb21wb25lbnRcbiAgICApID0+IHtcbiAgICAgIC8vIGVudGVycyB3aGVuIHJlZiBpcyBzZXQgYnkgYXR0YWNoaW5nIHRvIGEgY29tcG9uZW50XG4gICAgICBpZiAoY29tcG9uZW50KSB7XG4gICAgICAgIGNvbnN0IGdldFRhZ1ZhbHVlRnVuY3Rpb24gPSBpc0ZhYnJpYygpXG4gICAgICAgICAgPyBnZXRTaGFkb3dOb2RlV3JhcHBlckZyb21SZWZcbiAgICAgICAgICA6IGZpbmROb2RlSGFuZGxlO1xuXG4gICAgICAgIGNvbnN0IGdldFRhZ09yU2hhZG93Tm9kZVdyYXBwZXIgPSAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIElTX1dFQlxuICAgICAgICAgICAgPyBnZXRDb21wb25lbnRPclNjcm9sbGFibGUoY29tcG9uZW50KVxuICAgICAgICAgICAgOiBnZXRUYWdWYWx1ZUZ1bmN0aW9uKGdldENvbXBvbmVudE9yU2Nyb2xsYWJsZShjb21wb25lbnQpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0YWcudmFsdWUgPSBnZXRUYWdPclNoYWRvd05vZGVXcmFwcGVyKCk7XG5cbiAgICAgICAgLy8gT24gRmFicmljIHdlIGhhdmUgdG8gdW53cmFwIHRoZSB0YWcgZnJvbSB0aGUgc2hhZG93IG5vZGUgd3JhcHBlclxuICAgICAgICBmdW4uZ2V0VGFnID0gaXNGYWJyaWMoKVxuICAgICAgICAgID8gKCkgPT4gZmluZE5vZGVIYW5kbGUoZ2V0Q29tcG9uZW50T3JTY3JvbGxhYmxlKGNvbXBvbmVudCkpXG4gICAgICAgICAgOiBnZXRUYWdPclNoYWRvd05vZGVXcmFwcGVyO1xuXG4gICAgICAgIGZ1bi5jdXJyZW50ID0gY29tcG9uZW50O1xuICAgICAgICAvLyB2aWV3TmFtZSBpcyByZXF1aXJlZCBvbmx5IG9uIGlPUyB3aXRoIFBhcGVyXG4gICAgICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2lvcycgJiYgIWlzRmFicmljKCkpIHtcbiAgICAgICAgICB2aWV3TmFtZS52YWx1ZSA9XG4gICAgICAgICAgICAoY29tcG9uZW50IGFzIE1heWJlU2Nyb2xsYWJsZUNvbXBvbmVudCk/LnZpZXdDb25maWdcbiAgICAgICAgICAgICAgPy51aVZpZXdDbGFzc05hbWUgfHwgJ1JDVFZpZXcnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFnLnZhbHVlO1xuICAgIH0pO1xuXG4gICAgZnVuLmN1cnJlbnQgPSBudWxsO1xuXG4gICAgY29uc3QgYW5pbWF0ZWRSZWZTaGFyZWFibGVIYW5kbGUgPSBtYWtlU2hhcmVhYmxlQ2xvbmVSZWN1cnNpdmUoe1xuICAgICAgX19pbml0OiAoKSA9PiB7XG4gICAgICAgICd3b3JrbGV0JztcbiAgICAgICAgY29uc3QgZjogQW5pbWF0ZWRSZWZPblVJID0gKCkgPT4gdGFnLnZhbHVlO1xuICAgICAgICBmLnZpZXdOYW1lID0gdmlld05hbWU7XG4gICAgICAgIHJldHVybiBmO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBzaGFyZWFibGVNYXBwaW5nQ2FjaGUuc2V0KGZ1biwgYW5pbWF0ZWRSZWZTaGFyZWFibGVIYW5kbGUpO1xuICAgIHJlZi5jdXJyZW50ID0gZnVuO1xuICB9XG5cbiAgcmV0dXJuIHJlZi5jdXJyZW50O1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUFBQSxNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBQyxLQUFBO0FBQUE7QUFBQUQsT0FBQSxDQUFBRSxjQUFBLEdBQUFBLGNBQUE7QUFFWixJQUFBQyxNQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxlQUFBLEdBQUFELE9BQUE7QUFHQSxJQUFBRSxZQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxXQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxzQkFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssWUFBQSxHQUFBTCxPQUFBO0FBRUEsSUFBQU0sZ0JBQUEsR0FBQU4sT0FBQTtBQUVBLElBQU1PLE1BQU0sR0FBRyxJQUFBQyxzQkFBSyxFQUFDLENBQUM7QUFZdEIsU0FBU0Msd0JBQXdCQSxDQUFDQyxTQUFtQyxFQUFFO0VBQ3JFLElBQUksSUFBQUMseUJBQVEsRUFBQyxDQUFDLElBQUlELFNBQVMsQ0FBQ0Usa0JBQWtCLEVBQUU7SUFDOUMsT0FBT0YsU0FBUyxDQUFDRSxrQkFBa0IsQ0FBQyxD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