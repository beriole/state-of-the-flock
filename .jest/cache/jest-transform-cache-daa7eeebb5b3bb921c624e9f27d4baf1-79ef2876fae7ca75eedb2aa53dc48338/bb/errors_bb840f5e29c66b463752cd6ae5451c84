f09cfc8c0c4bee0907688e2839e69766
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.registerWorkletStackDetails = registerWorkletStackDetails;
exports.reportFatalErrorOnJS = reportFatalErrorOnJS;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _workletStackDetails = new Map();
function registerWorkletStackDetails(hash, stackDetails) {
  _workletStackDetails.set(hash, stackDetails);
}
function getBundleOffset(error) {
  var _error$stack;
  var frame = (_error$stack = error.stack) === null || _error$stack === void 0 || (_error$stack = _error$stack.split('\n')) === null || _error$stack === void 0 ? void 0 : _error$stack[0];
  if (frame) {
    var parsedFrame = /@([^@]+):(\d+):(\d+)/.exec(frame);
    if (parsedFrame) {
      var _parsedFrame = (0, _slicedToArray2.default)(parsedFrame, 4),
        file = _parsedFrame[1],
        line = _parsedFrame[2],
        col = _parsedFrame[3];
      return [file, Number(line), Number(col)];
    }
  }
  return ['unknown', 0, 0];
}
function processStack(stack) {
  var workletStackEntries = stack.match(/worklet_(\d+):(\d+):(\d+)/g);
  var result = stack;
  workletStackEntries === null || workletStackEntries === void 0 || workletStackEntries.forEach(function (match) {
    var _match$split$map = match.split(/:|_/).map(Number),
      _match$split$map2 = (0, _slicedToArray2.default)(_match$split$map, 4),
      hash = _match$split$map2[1],
      origLine = _match$split$map2[2],
      origCol = _match$split$map2[3];
    var errorDetails = _workletStackDetails.get(hash);
    if (!errorDetails) {
      return;
    }
    var _errorDetails = (0, _slicedToArray2.default)(errorDetails, 3),
      error = _errorDetails[0],
      lineOffset = _errorDetails[1],
      colOffset = _errorDetails[2];
    var _getBundleOffset = getBundleOffset(error),
      _getBundleOffset2 = (0, _slicedToArray2.default)(_getBundleOffset, 3),
      bundleFile = _getBundleOffset2[0],
      bundleLine = _getBundleOffset2[1],
      bundleCol = _getBundleOffset2[2];
    var line = origLine + bundleLine + lineOffset;
    var col = origCol + bundleCol + colOffset;
    result = result.replace(match, `${bundleFile}:${line}:${col}`);
  });
  return result;
}
function reportFatalErrorOnJS(_ref) {
  var message = _ref.message,
    stack = _ref.stack;
  var error = new Error();
  error.message = message;
  error.stack = stack ? processStack(stack) : undefined;
  error.name = 'ReanimatedError';
  error.jsEngine = 'reanimated';
  global.ErrorUtils.reportFatalError(error);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwicmVnaXN0ZXJXb3JrbGV0U3RhY2tEZXRhaWxzIiwicmVwb3J0RmF0YWxFcnJvck9uSlMiLCJfc2xpY2VkVG9BcnJheTIiLCJfd29ya2xldFN0YWNrRGV0YWlscyIsIk1hcCIsImhhc2giLCJzdGFja0RldGFpbHMiLCJzZXQiLCJnZXRCdW5kbGVPZmZzZXQiLCJlcnJvciIsIl9lcnJvciRzdGFjayIsImZyYW1lIiwic3RhY2siLCJzcGxpdCIsInBhcnNlZEZyYW1lIiwiZXhlYyIsIl9wYXJzZWRGcmFtZSIsImRlZmF1bHQiLCJmaWxlIiwibGluZSIsImNvbCIsIk51bWJlciIsInByb2Nlc3NTdGFjayIsIndvcmtsZXRTdGFja0VudHJpZXMiLCJtYXRjaCIsInJlc3VsdCIsImZvckVhY2giLCJfbWF0Y2gkc3BsaXQkbWFwIiwibWFwIiwiX21hdGNoJHNwbGl0JG1hcDIiLCJvcmlnTGluZSIsIm9yaWdDb2wiLCJlcnJvckRldGFpbHMiLCJnZXQiLCJfZXJyb3JEZXRhaWxzIiwibGluZU9mZnNldCIsImNvbE9mZnNldCIsIl9nZXRCdW5kbGVPZmZzZXQiLCJfZ2V0QnVuZGxlT2Zmc2V0MiIsImJ1bmRsZUZpbGUiLCJidW5kbGVMaW5lIiwiYnVuZGxlQ29sIiwicmVwbGFjZSIsIl9yZWYiLCJtZXNzYWdlIiwiRXJyb3IiLCJ1bmRlZmluZWQiLCJuYW1lIiwianNFbmdpbmUiLCJnbG9iYWwiLCJFcnJvclV0aWxzIiwicmVwb3J0RmF0YWxFcnJvciJdLCJzb3VyY2VzIjpbImVycm9ycy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5pbXBvcnQgdHlwZSB7IFdvcmtsZXRTdGFja0RldGFpbHMgfSBmcm9tICcuL2NvbW1vblR5cGVzJztcblxuY29uc3QgX3dvcmtsZXRTdGFja0RldGFpbHMgPSBuZXcgTWFwPG51bWJlciwgV29ya2xldFN0YWNrRGV0YWlscz4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyV29ya2xldFN0YWNrRGV0YWlscyhcbiAgaGFzaDogbnVtYmVyLFxuICBzdGFja0RldGFpbHM6IFdvcmtsZXRTdGFja0RldGFpbHNcbikge1xuICBfd29ya2xldFN0YWNrRGV0YWlscy5zZXQoaGFzaCwgc3RhY2tEZXRhaWxzKTtcbn1cblxuZnVuY3Rpb24gZ2V0QnVuZGxlT2Zmc2V0KGVycm9yOiBFcnJvcik6IFtzdHJpbmcsIG51bWJlciwgbnVtYmVyXSB7XG4gIGNvbnN0IGZyYW1lID0gZXJyb3Iuc3RhY2s/LnNwbGl0KCdcXG4nKT8uWzBdO1xuICBpZiAoZnJhbWUpIHtcbiAgICBjb25zdCBwYXJzZWRGcmFtZSA9IC9AKFteQF0rKTooXFxkKyk6KFxcZCspLy5leGVjKGZyYW1lKTtcbiAgICBpZiAocGFyc2VkRnJhbWUpIHtcbiAgICAgIGNvbnN0IFssIGZpbGUsIGxpbmUsIGNvbF0gPSBwYXJzZWRGcmFtZTtcbiAgICAgIHJldHVybiBbZmlsZSwgTnVtYmVyKGxpbmUpLCBOdW1iZXIoY29sKV07XG4gICAgfVxuICB9XG4gIHJldHVybiBbJ3Vua25vd24nLCAwLCAwXTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc1N0YWNrKHN0YWNrOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB3b3JrbGV0U3RhY2tFbnRyaWVzID0gc3RhY2subWF0Y2goL3dvcmtsZXRfKFxcZCspOihcXGQrKTooXFxkKykvZyk7XG4gIGxldCByZXN1bHQgPSBzdGFjaztcbiAgd29ya2xldFN0YWNrRW50cmllcz8uZm9yRWFjaCgobWF0Y2gpID0+IHtcbiAgICBjb25zdCBbLCBoYXNoLCBvcmlnTGluZSwgb3JpZ0NvbF0gPSBtYXRjaC5zcGxpdCgvOnxfLykubWFwKE51bWJlcik7XG4gICAgY29uc3QgZXJyb3JEZXRhaWxzID0gX3dvcmtsZXRTdGFja0RldGFpbHMuZ2V0KGhhc2gpO1xuICAgIGlmICghZXJyb3JEZXRhaWxzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IFtlcnJvciwgbGluZU9mZnNldCwgY29sT2Zmc2V0XSA9IGVycm9yRGV0YWlscztcbiAgICBjb25zdCBbYnVuZGxlRmlsZSwgYnVuZGxlTGluZSwgYnVuZGxlQ29sXSA9IGdldEJ1bmRsZU9mZnNldChlcnJvcik7XG4gICAgY29uc3QgbGluZSA9IG9yaWdMaW5lICsgYnVuZGxlTGluZSArIGxpbmVPZmZzZXQ7XG4gICAgY29uc3QgY29sID0gb3JpZ0NvbCArIGJ1bmRsZUNvbCArIGNvbE9mZnNldDtcblxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG1hdGNoLCBgJHtidW5kbGVGaWxlfToke2xpbmV9OiR7Y29sfWApO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlcG9ydEZhdGFsRXJyb3JPbkpTKHtcbiAgbWVzc2FnZSxcbiAgc3RhY2ssXG59OiB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc3RhY2s/OiBzdHJpbmc7XG59KSB7XG4gIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCk7XG4gIGVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICBlcnJvci5zdGFjayA9IHN0YWNrID8gcHJvY2Vzc1N0YWNrKHN0YWNrKSA6IHVuZGVmaW5lZDtcbiAgZXJyb3IubmFtZSA9ICdSZWFuaW1hdGVkRXJyb3InO1xuICAvLyBAdHMtaWdub3JlIFJlYWN0IE5hdGl2ZSdzIEVycm9yVXRpbHMgaW1wbGVtZW50YXRpb24gZXh0ZW5kcyB0aGUgRXJyb3IgdHlwZSB3aXRoIGpzRW5naW5lIGZpZWxkXG4gIGVycm9yLmpzRW5naW5lID0gJ3JlYW5pbWF0ZWQnO1xuICAvLyBAdHMtaWdub3JlIHRoZSByZXBvcnRGYXRhbEVycm9yIG1ldGhvZCBpcyBhbiBpbnRlcm5hbCBtZXRob2Qgb2YgRXJyb3JVdGlscyBub3QgZXhwb3NlZCBpbiB0aGUgdHlwZSBkZWZpbml0aW9uc1xuICBnbG9iYWwuRXJyb3JVdGls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