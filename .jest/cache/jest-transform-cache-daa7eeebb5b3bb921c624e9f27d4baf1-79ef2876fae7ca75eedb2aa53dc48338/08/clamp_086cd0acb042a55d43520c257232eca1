2239ce1ecdd303bb91debab8316442fa
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.withClamp = void 0;
var _util = require("./util");
var withClamp = exports.withClamp = function withClamp(config, _animationToClamp) {
  'worklet';

  return (0, _util.defineAnimation)(_animationToClamp, function () {
    'worklet';

    var animationToClamp = typeof _animationToClamp === 'function' ? _animationToClamp() : _animationToClamp;
    var strippedMin = config.min === undefined ? undefined : (0, _util.recognizePrefixSuffix)(config.min).strippedValue;
    var strippedMax = config.max === undefined ? undefined : (0, _util.recognizePrefixSuffix)(config.max).strippedValue;
    function clampOnFrame(animation, now) {
      var finished = animationToClamp.onFrame(animationToClamp, now);
      if (animationToClamp.current === undefined) {
        console.warn("[Reanimated] Error inside 'withClamp' animation, the inner animation has invalid current value");
        return true;
      } else {
        var _recognizePrefixSuffi = (0, _util.recognizePrefixSuffix)(animationToClamp.current),
          prefix = _recognizePrefixSuffi.prefix,
          strippedValue = _recognizePrefixSuffi.strippedValue,
          suffix = _recognizePrefixSuffi.suffix;
        var newValue;
        if (strippedMax !== undefined && strippedMax < strippedValue) {
          newValue = strippedMax;
        } else if (strippedMin !== undefined && strippedMin > strippedValue) {
          newValue = strippedMin;
        } else {
          newValue = strippedValue;
        }
        animation.current = typeof animationToClamp.current === 'number' ? newValue : `${prefix === undefined ? '' : prefix}${newValue}${suffix === undefined ? '' : suffix}`;
      }
      return finished;
    }
    function onStart(animation, value, now, previousAnimation) {
      animation.current = value;
      animation.previousAnimation = animationToClamp;
      var animationBeforeClamped = previousAnimation == null ? void 0 : previousAnimation.previousAnimation;
      if (config.max !== undefined && config.min !== undefined && config.max < config.min) {
        console.warn('[Reanimated] Wrong config was provided to withClamp. Min value is bigger than max');
      }
      animationToClamp.onStart(animationToClamp, (animationBeforeClamped == null ? void 0 : animationBeforeClamped.current) || value, now, animationBeforeClamped);
    }
    var callback = function callback(finished) {
      if (animationToClamp.callback) {
        animationToClamp.callback(finished);
      }
    };
    return {
      isHigherOrder: true,
      onFrame: clampOnFrame,
      onStart: onStart,
      current: animationToClamp.current,
      callback: callback,
      previousAnimation: null,
      reduceMotion: (0, _util.getReduceMotionForAnimation)(config.reduceMotion)
    };
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIndpdGhDbGFtcCIsIl91dGlsIiwicmVxdWlyZSIsImNvbmZpZyIsIl9hbmltYXRpb25Ub0NsYW1wIiwiZGVmaW5lQW5pbWF0aW9uIiwiYW5pbWF0aW9uVG9DbGFtcCIsInN0cmlwcGVkTWluIiwibWluIiwidW5kZWZpbmVkIiwicmVjb2duaXplUHJlZml4U3VmZml4Iiwic3RyaXBwZWRWYWx1ZSIsInN0cmlwcGVkTWF4IiwibWF4IiwiY2xhbXBPbkZyYW1lIiwiYW5pbWF0aW9uIiwibm93IiwiZmluaXNoZWQiLCJvbkZyYW1lIiwiY3VycmVudCIsImNvbnNvbGUiLCJ3YXJuIiwiX3JlY29nbml6ZVByZWZpeFN1ZmZpIiwicHJlZml4Iiwic3VmZml4IiwibmV3VmFsdWUiLCJvblN0YXJ0IiwicHJldmlvdXNBbmltYXRpb24iLCJhbmltYXRpb25CZWZvcmVDbGFtcGVkIiwiY2FsbGJhY2siLCJpc0hpZ2hlck9yZGVyIiwicmVkdWNlTW90aW9uIiwiZ2V0UmVkdWNlTW90aW9uRm9yQW5pbWF0aW9uIl0sInNvdXJjZXMiOlsiY2xhbXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHtcbiAgZGVmaW5lQW5pbWF0aW9uLFxuICBnZXRSZWR1Y2VNb3Rpb25Gb3JBbmltYXRpb24sXG4gIHJlY29nbml6ZVByZWZpeFN1ZmZpeCxcbn0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB0eXBlIHtcbiAgQW5pbWF0aW9uLFxuICBUaW1lc3RhbXAsXG4gIEFuaW1hdGFibGVWYWx1ZSxcbiAgQW5pbWF0aW9uT2JqZWN0LFxuICBSZWR1Y2VNb3Rpb24sXG59IGZyb20gJy4uL2NvbW1vblR5cGVzJztcbmltcG9ydCB0eXBlIHsgQ2xhbXBBbmltYXRpb24gfSBmcm9tICcuL2NvbW1vblR5cGVzJztcblxudHlwZSB3aXRoQ2xhbXBUeXBlID0gPFQgZXh0ZW5kcyBudW1iZXIgfCBzdHJpbmc+KFxuICBjb25maWc6IHtcbiAgICBtaW4/OiBUO1xuICAgIG1heD86IFQ7XG4gIH0sXG4gIGNsYW1wZWRBbmltYXRpb246IFRcbikgPT4gVDtcblxuZXhwb3J0IGNvbnN0IHdpdGhDbGFtcCA9IGZ1bmN0aW9uIDxUIGV4dGVuZHMgbnVtYmVyIHwgc3RyaW5nPihcbiAgY29uZmlnOiB7IG1pbj86IFQ7IG1heD86IFQ7IHJlZHVjZU1vdGlvbj86IFJlZHVjZU1vdGlvbiB9LFxuICBfYW5pbWF0aW9uVG9DbGFtcDogQW5pbWF0aW9uT2JqZWN0PFQ+IHwgKCgpID0+IEFuaW1hdGlvbk9iamVjdDxUPilcbik6IEFuaW1hdGlvbjxDbGFtcEFuaW1hdGlvbj4ge1xuICAnd29ya2xldCc7XG4gIHJldHVybiBkZWZpbmVBbmltYXRpb248Q2xhbXBBbmltYXRpb24sIEFuaW1hdGlvbk9iamVjdDxUPj4oXG4gICAgX2FuaW1hdGlvblRvQ2xhbXAsXG4gICAgKCk6IENsYW1wQW5pbWF0aW9uID0+IHtcbiAgICAgICd3b3JrbGV0JztcbiAgICAgIGNvbnN0IGFuaW1hdGlvblRvQ2xhbXAgPVxuICAgICAgICB0eXBlb2YgX2FuaW1hdGlvblRvQ2xhbXAgPT09ICdmdW5jdGlvbidcbiAgICAgICAgICA/IF9hbmltYXRpb25Ub0NsYW1wKClcbiAgICAgICAgICA6IF9hbmltYXRpb25Ub0NsYW1wO1xuXG4gICAgICBjb25zdCBzdHJpcHBlZE1pbiA9XG4gICAgICAgIGNvbmZpZy5taW4gPT09IHVuZGVmaW5lZFxuICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgOiByZWNvZ25pemVQcmVmaXhTdWZmaXgoY29uZmlnLm1pbikuc3RyaXBwZWRWYWx1ZTtcblxuICAgICAgY29uc3Qgc3RyaXBwZWRNYXggPVxuICAgICAgICBjb25maWcubWF4ID09PSB1bmRlZmluZWRcbiAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgIDogcmVjb2duaXplUHJlZml4U3VmZml4KGNvbmZpZy5tYXgpLnN0cmlwcGVkVmFsdWU7XG5cbiAgICAgIGZ1bmN0aW9uIGNsYW1wT25GcmFtZShcbiAgICAgICAgYW5pbWF0aW9uOiBDbGFtcEFuaW1hdGlvbixcbiAgICAgICAgbm93OiBUaW1lc3RhbXBcbiAgICAgICk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBmaW5pc2hlZCA9IGFuaW1hdGlvblRvQ2xhbXAub25GcmFtZShhbmltYXRpb25Ub0NsYW1wLCBub3cpO1xuXG4gICAgICAgIGlmIChhbmltYXRpb25Ub0NsYW1wLmN1cnJlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIFwiW1JlYW5pbWF0ZWRdIEVycm9yIGluc2lkZSAnd2l0aENsYW1wJyBhbmltYXRpb24sIHRoZSBpbm5lciBhbmltYXRpb24gaGFzIGludmFsaWQgY3VycmVudCB2YWx1ZVwiXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCB7IHByZWZpeCwgc3RyaXBwZWRWYWx1ZSwgc3VmZml4IH0gPSByZWNvZ25pemVQcmVmaXhTdWZmaXgoXG4gICAgICAgICAgICBhbmltYXRpb25Ub0NsYW1wLmN1cnJlbnRcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgbGV0IG5ld1ZhbHVlO1xuXG4gICAgICAgICAgaWYgKHN0cmlwcGVkTWF4ICE9PSB1bmRlZmluZWQgJiYgc3RyaXBwZWRNYXggPCBzdHJpcHBlZFZhbHVlKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHN0cmlwcGVkTWF4O1xuICAgICAgICAgIH0gZWxzZSBpZiAoc3RyaXBwZWRNaW4gIT09IHVuZGVmaW5lZCAmJiBzdHJpcHBlZE1pbiA+IHN0cmlwcGVkVmFsdWUpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gc3RyaXBwZWRNaW47XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gc3RyaXBwZWRWYWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhbmltYXRpb24uY3VycmVudCA9XG4gICAgICAgICAgICB0eXBlb2YgYW5pbWF0aW9uVG9DbGFtcC5jdXJyZW50ID09PSAnbnVtYmVyJ1xuICAgICAgICAgICAgICA/IG5ld1ZhbHVlXG4gICAgICAgICAgICAgIDogYCR7cHJlZml4ID09PSB1bmRlZmluZWQgPyAnJyA6IHByZWZpeH0ke25ld1ZhbHVlfSR7XG4gICAgICAgICAgICAgICAgICBzdWZmaXggPT09IHVuZGVmaW5lZCA/ICcnIDogc3VmZml4XG4gICAgICAgICAgICAgICAgfWA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmluaXNoZWQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uU3RhcnQoXG4gICAgICAgIGFuaW1hdGlvbjogQW5pbWF0aW9uPGFueT4sXG4gICAgICAgIHZhbHVlOiBBbmltYXRhYmxlVmFsdWUsXG4gICAgICAgIG5vdzogVGltZXN0YW1wLFxuICAgICAgICBwcmV2aW91c0FuaW1hdGlvbjogQW5pbWF0aW9uPGFueT4gfCBudWxsXG4gICAgICApOiB2b2lkIHtcbiAgICAgICAgYW5pbWF0aW9uLmN1cnJlbnQgPSB2YWx1ZTtcbiAgICAgICAgYW5pbWF0aW9uLnByZXZpb3VzQW5pbWF0aW9uID0gYW5pbWF0aW9uVG9DbGFtcDtcbiAgICAgICAgY29uc3QgYW5pbWF0aW9uQmVmb3JlQ2xhbXBlZCA9IHByZXZpb3VzQW5pbWF0aW9uPy5wcmV2aW91c0FuaW1hdGlvbjtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGNvbmZpZy5tYXggIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgIGNvbmZpZy5taW4gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgIGNvbmZpZy5tYXggPCBjb25maWcubWluXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgICdbUmVhbmltYXRlZF0gV3JvbmcgY29uZmlnIHdhcyBwcm92aWRlZCB0byB3aXRoQ2xhbXAuIE1pbiB2YWx1ZSBpcyBiaWdnZXIgdGhhbiBtYXgnXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFuaW1hdGlvblRvQ2xhbXAub25TdGFydChcbiAgICAgICAgICBhbmltYXRpb25Ub0NsYW1wLFxuICAgICAgICAgIC8qKiBwcm92aWRlIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBwcmV2aW91cyBhbmltYXRpb24gb2YgdGhlIGNsYW1wZWQgYW5pbWF0aW9uIFxuICAgICAgICAgIHNvIHdlIGNhbiBhbmltYXRlIGZyb20gdGhlIG9yaWdpbmFsIFwidW4tdHJ1bmNhdGVkXCIgdmFsdWVcbiAgICAgICAgICAqL1xuICAgICAgICAgIGFuaW1hdGlvbkJlZm9yZUNsYW1wZWQ/LmN1cnJlbnQgfHwgdmFsdWUsXG4gICAgICAgICAgbm93LFxuICAgICAgICAgIGFuaW1hdGlvbkJlZm9yZUNsYW1wZWRcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FsbGJhY2sgPSAoZmluaXNoZWQ/OiBib29sZWFuKTogdm9pZCA9PiB7XG4gICAgICAgIGlmIChhbmltYXRpb25Ub0NsYW1wLmNhbGxiYWNrKSB7XG4gICAgICAgICAgYW5pbWF0aW9uVG9DbGFtcC5jYWxsYmFjayhmaW5pc2hlZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzSGlnaGVyT3JkZXI6IHRydWUsXG4gICAgICAgIG9uRnJhbWU6IGNsYW1wT25GcmFtZSxcbiAgICAgICAgb25TdGFydCxcbiAgICAgICAgY3VycmVudDogYW5pbWF0aW9uVG9DbGFtcC5jdXJyZW50ISxcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgIHByZXZpb3VzQW5pbWF0aW9uOiBudWxsLFxuICAgICAgICByZWR1Y2VNb3Rpb246IGdldFJlZHVjZU1vdGlvbkZvckFuaW1hdGlvbihjb25maWcucmVkdWNlTW90aW9uKSxcbiAgICAgIH07XG4gICAgfVxuICApO1xufSBhcyB3aXRo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