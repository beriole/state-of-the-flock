507b495785c800af0c06a38cee9e72e8
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.callGuardDEV = callGuardDEV;
exports.initializeUIRuntime = initializeUIRuntime;
exports.setupCallGuard = setupCallGuard;
exports.setupConsole = setupConsole;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _errors = require("./errors");
var _PlatformChecker = require("./PlatformChecker");
var _threads = require("./threads");
var _mockedRequestAnimationFrame = require("./mockedRequestAnimationFrame");
var IS_JEST = (0, _PlatformChecker.isJest)();
var SHOULD_BE_USE_WEB = (0, _PlatformChecker.shouldBeUseWeb)();
var IS_CHROME_DEBUGGER = (0, _PlatformChecker.isChromeDebugger)();
function callGuardDEV(fn) {
  'worklet';

  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  try {
    return fn.apply(void 0, args);
  } catch (e) {
    if (global.__ErrorUtils) {
      global.__ErrorUtils.reportFatalError(e);
    } else {
      throw e;
    }
  }
}
function setupCallGuard() {
  'worklet';

  global.__callGuardDEV = callGuardDEV;
  global.__ErrorUtils = {
    reportFatalError: function reportFatalError(error) {
      (0, _threads.runOnJS)(_errors.reportFatalErrorOnJS)({
        message: error.message,
        stack: error.stack
      });
    }
  };
}
function createMemorySafeCapturableConsole() {
  var consoleCopy = Object.fromEntries(Object.entries(console).map(function (_ref) {
    var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
      methodName = _ref2[0],
      method = _ref2[1];
    var methodWrapper = function methodWrapper() {
      return method.apply(void 0, arguments);
    };
    if (method.name) {
      Object.defineProperty(methodWrapper, 'name', {
        value: method.name,
        writable: false
      });
    }
    return [methodName, methodWrapper];
  }));
  return consoleCopy;
}
var capturableConsole = createMemorySafeCapturableConsole();
function setupConsole() {
  'worklet';

  if (!IS_CHROME_DEBUGGER) {
    global.console = {
      assert: (0, _threads.runOnJS)(capturableConsole.assert),
      debug: (0, _threads.runOnJS)(capturableConsole.debug),
      log: (0, _threads.runOnJS)(capturableConsole.log),
      warn: (0, _threads.runOnJS)(capturableConsole.warn),
      error: (0, _threads.runOnJS)(capturableConsole.error),
      info: (0, _threads.runOnJS)(capturableConsole.info)
    };
  }
}
function setupRequestAnimationFrame() {
  'worklet';
  var nativeRequestAnimationFrame = global.requestAnimationFrame;
  var animationFrameCallbacks = [];
  var flushRequested = false;
  global.__flushAnimationFrame = function (frameTimestamp) {
    var currentCallbacks = animationFrameCallbacks;
    animationFrameCallbacks = [];
    currentCallbacks.forEach(function (f) {
      return f(frameTimestamp);
    });
    (0, _threads.callMicrotasks)();
  };
  global.requestAnimationFrame = function (callback) {
    animationFrameCallbacks.push(callback);
    if (!flushRequested) {
      flushRequested = true;
      nativeRequestAnimationFrame(function (timestamp) {
        flushRequested = false;
        global.__frameTimestamp = timestamp;
        global.__flushAnimationFrame(timestamp);
        global.__frameTimestamp = undefined;
      });
    }
    return -1;
  };
}
function initializeUIRuntime() {
  if (IS_JEST) {
    globalThis.requestAnimationFrame = _mockedRequestAnimationFrame.mockedRequestAnimationFrame;
  }
  (0, _threads.runOnUIImmediately)(function () {
    'worklet';

    setupCallGuard();
    setupConsole();
    if (!SHOULD_BE_USE_WEB) {
      (0, _threads.setupMicrotasks)();
      setupRequestAnimationFrame();
    }
  })();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY2FsbEd1YXJkREVWIiwiaW5pdGlhbGl6ZVVJUnVudGltZSIsInNldHVwQ2FsbEd1YXJkIiwic2V0dXBDb25zb2xlIiwiX3NsaWNlZFRvQXJyYXkyIiwiX2Vycm9ycyIsIl9QbGF0Zm9ybUNoZWNrZXIiLCJfdGhyZWFkcyIsIl9tb2NrZWRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJJU19KRVNUIiwiaXNKZXN0IiwiU0hPVUxEX0JFX1VTRV9XRUIiLCJzaG91bGRCZVVzZVdlYiIsIklTX0NIUk9NRV9ERUJVR0dFUiIsImlzQ2hyb21lRGVidWdnZXIiLCJmbiIsIl9sZW4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhcmdzIiwiQXJyYXkiLCJfa2V5IiwiYXBwbHkiLCJlIiwiZ2xvYmFsIiwiX19FcnJvclV0aWxzIiwicmVwb3J0RmF0YWxFcnJvciIsIl9fY2FsbEd1YXJkREVWIiwiZXJyb3IiLCJydW5PbkpTIiwicmVwb3J0RmF0YWxFcnJvck9uSlMiLCJtZXNzYWdlIiwic3RhY2siLCJjcmVhdGVNZW1vcnlTYWZlQ2FwdHVyYWJsZUNvbnNvbGUiLCJjb25zb2xlQ29weSIsImZyb21FbnRyaWVzIiwiZW50cmllcyIsImNvbnNvbGUiLCJtYXAiLCJfcmVmIiwiX3JlZjIiLCJkZWZhdWx0IiwibWV0aG9kTmFtZSIsIm1ldGhvZCIsIm1ldGhvZFdyYXBwZXIiLCJuYW1lIiwid3JpdGFibGUiLCJjYXB0dXJhYmxlQ29uc29sZSIsImFzc2VydCIsImRlYnVnIiwibG9nIiwid2FybiIsImluZm8iLCJzZXR1cFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm5hdGl2ZVJlcXVlc3RBbmltYXRpb25GcmFtZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImFuaW1hdGlvbkZyYW1lQ2FsbGJhY2tzIiwiZmx1c2hSZXF1ZXN0ZWQiLCJfX2ZsdXNoQW5pbWF0aW9uRnJhbWUiLCJmcmFtZVRpbWVzdGFtcCIsImN1cnJlbnRDYWxsYmFja3MiLCJmb3JFYWNoIiwiZiIsImNhbGxNaWNyb3Rhc2tzIiwiY2FsbGJhY2siLCJwdXNoIiwidGltZXN0YW1wIiwiX19mcmFtZVRpbWVzdGFtcCIsInVuZGVmaW5lZCIsImdsb2JhbFRoaXMiLCJtb2NrZWRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJydW5PblVJSW1tZWRpYXRlbHkiLCJzZXR1cE1pY3JvdGFza3MiXSwic291cmNlcyI6WyJpbml0aWFsaXplcnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHsgcmVwb3J0RmF0YWxFcnJvck9uSlMgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBpc0Nocm9tZURlYnVnZ2VyLCBpc0plc3QsIHNob3VsZEJlVXNlV2ViIH0gZnJvbSAnLi9QbGF0Zm9ybUNoZWNrZXInO1xuaW1wb3J0IHtcbiAgcnVuT25KUyxcbiAgc2V0dXBNaWNyb3Rhc2tzLFxuICBjYWxsTWljcm90YXNrcyxcbiAgcnVuT25VSUltbWVkaWF0ZWx5LFxufSBmcm9tICcuL3RocmVhZHMnO1xuaW1wb3J0IHsgbW9ja2VkUmVxdWVzdEFuaW1hdGlvbkZyYW1lIH0gZnJvbSAnLi9tb2NrZWRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnO1xuXG5jb25zdCBJU19KRVNUID0gaXNKZXN0KCk7XG5jb25zdCBTSE9VTERfQkVfVVNFX1dFQiA9IHNob3VsZEJlVXNlV2ViKCk7XG5jb25zdCBJU19DSFJPTUVfREVCVUdHRVIgPSBpc0Nocm9tZURlYnVnZ2VyKCk7XG5cbi8vIGNhbGxHdWFyZCBpcyBvbmx5IHVzZWQgd2l0aCBkZWJ1ZyBidWlsZHNcbmV4cG9ydCBmdW5jdGlvbiBjYWxsR3VhcmRERVY8QXJncyBleHRlbmRzIHVua25vd25bXSwgUmV0dXJuVmFsdWU+KFxuICBmbjogKC4uLmFyZ3M6IEFyZ3MpID0+IFJldHVyblZhbHVlLFxuICAuLi5hcmdzOiBBcmdzXG4pOiBSZXR1cm5WYWx1ZSB8IHZvaWQge1xuICAnd29ya2xldCc7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGZuKC4uLmFyZ3MpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGdsb2JhbC5fX0Vycm9yVXRpbHMpIHtcbiAgICAgIGdsb2JhbC5fX0Vycm9yVXRpbHMucmVwb3J0RmF0YWxFcnJvcihlIGFzIEVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldHVwQ2FsbEd1YXJkKCkge1xuICAnd29ya2xldCc7XG4gIGdsb2JhbC5fX2NhbGxHdWFyZERFViA9IGNhbGxHdWFyZERFVjtcbiAgZ2xvYmFsLl9fRXJyb3JVdGlscyA9IHtcbiAgICByZXBvcnRGYXRhbEVycm9yOiAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICBydW5PbkpTKHJlcG9ydEZhdGFsRXJyb3JPbkpTKSh7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgIH0pO1xuICAgIH0sXG4gIH07XG59XG5cbi8qKlxuICogQ3VycmVudGx5IHRoZXJlIHNlZW1zIHRvIGJlIGEgYnVnIGluIHRoZSBKU0kgbGF5ZXIgd2hpY2ggY2F1c2VzIGEgY3Jhc2ggd2hlblxuICogd2UgdHJ5IHRvIGNvcHkgc29tZSBvZiB0aGUgY29uc29sZSBtZXRob2RzLCBpLmUuIGBjbGVhcmAgb3IgYGRpcnhtbGAuXG4gKlxuICogVGhlIGNyYXNoIGhhcHBlbnMgb25seSBpbiBSZWFjdCBOYXRpdmUgMC43NS4gSXQncyBub3QgcmVwcm9kdWNpYmxlIGluIG5laXRoZXJcbiAqIDAuNzYgbm9yIDAuNzQuIEl0IGFsc28gaGFwcGVucyBvbmx5IGluIHRoZSBjb25maWd1cmF0aW9uIG9mIGEgZGVidWcgYXBwIGFuZFxuICogcHJvZHVjdGlvbiBidW5kbGUuXG4gKlxuICogSSBoYXZlbid0IHlldCBkaXNjb3ZlcmVkIHdoYXQgZXhhY3RseSBjYXVzZXMgdGhlIGNyYXNoLiBJdCdzIHRpZWQgdG8gdGhlXG4gKiBjb25zb2xlIG1ldGhvZHMgc29tZXRpbWVzIGJlaW5nIGBIb3N0RnVuY3Rpb25gcy4gVGhlcmVmb3JlLCBhcyBhIHdvcmthcm91bmRcbiAqIHdlIGRvbid0IGNvcHkgdGhlIG1ldGhvZHMgYXMgdGhleSBhcmUgaW4gdGhlIG9yaWdpbmFsIGNvbnNvbGUgb2JqZWN0LCB3ZSBjb3B5XG4gKiBKYXZhU2NyaXB0IHdyYXBwZXJzIGluc3RlYWQuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZU1lbW9yeVNhZmVDYXB0dXJhYmxlQ29uc29sZSgpOiB0eXBlb2YgY29uc29sZSB7XG4gIGNvbnN0IGNvbnNvbGVDb3B5ID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIE9iamVjdC5lbnRyaWVzKGNvbnNvbGUpLm1hcCgoW21ldGhvZE5hbWUsIG1ldGhvZF0pID0+IHtcbiAgICAgIGNvbnN0IG1ldGhvZFdyYXBwZXIgPSBmdW5jdGlvbiBtZXRob2RXcmFwcGVyKC4uLmFyZ3M6IHVua25vd25bXSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kKC4uLmFyZ3MpO1xuICAgICAgfTtcbiAgICAgIGlmIChtZXRob2QubmFtZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IHRoZSBvcmlnaW5hbCBtZXRob2QgbmFtZSBhcyB0aGUgd3JhcHBlciBuYW1lIGlmIGF2YWlsYWJsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogSXQgbWlnaHQgYmUgdW5uZWNlc3NhcnkgYnV0IGlmIHdlIHdhbnQgdG8gZnVsbHkgbWltaWMgdGhlIGNvbnNvbGVcbiAgICAgICAgICogb2JqZWN0IHdlIHNob3VsZCB0YWtlIGludG8gdGhlIGFjY291bnQgdGhlIGZhY3Qgc29tZSBjb2RlIG1pZ2h0IHJlbHlcbiAgICAgICAgICogb24gdGhlIG1ldGhvZCBuYW1lLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1ldGhvZFdyYXBwZXIsICduYW1lJywge1xuICAgICAgICAgIHZhbHVlOiBtZXRob2QubmFtZSxcbiAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFttZXRob2ROYW1lLCBtZXRob2RXcmFwcGVyXTtcbiAgICB9KVxuICApO1xuXG4gIHJldHVybiBjb25zb2xlQ29weSBhcyB1bmtub3duIGFzIHR5cGVvZiBjb25zb2xlO1xufVxuXG4vLyBXZSByZWFsbHkgaGF2ZSB0byBjcmVhdGUgYSBjb3B5IG9mIGNvbnNvbGUgaGVyZS4gRnVuY3Rpb24gcnVuT25KUyB3ZSB1c2Ugb24gZWxlbWVudHMgaW5zaWRlXG4vLyB0aGlzIG9iamVjdCBtYWtlcyBpdCBub3QgY29uZmlndXJhYmxlXG5jb25zdCBjYXB0dXJhYmxlQ29uc29sZSA9IGNyZWF0ZU1lbW9yeVNhZmVDYXB0dXJhYmxlQ29uc29sZSgpO1xuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBDb25zb2xlKCkge1xuICAnd29ya2xldCc7XG4gIGlmICghSVNfQ0hST01FX0RFQlVHR0VSKSB7XG4gICAgLy8gQHRzLWlnbm9yZSBUeXBlU2NyaXB0IGRvZXNuJ3QgbGlrZSB0aGF0IHRoZXJlIGFyZSBtaXNzaW5nIG1ldGhvZHMgaW4gY29uc29sZSBvYmplY3QsIGJ1dCB3ZSBkb24ndCBwcm92aWRlIGFsbCB0aGUgbWV0aG9kcyBmb3IgdGhlIFVJIHJ1bnRpbWUgY29uc29sZSB2ZXJzaW9uXG4gICAgZ2xvYmFsLmNvbnNvbGUgPSB7XG4gICAgICAvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2QgKi9cbiAgICAgIGFzc2VydDogcnVuT25KUyhjYXB0dXJhYmxlQ29uc29sZS5hc3NlcnQpLFxuICAgICAgZGVidWc6IHJ1bk9uSlMoY2FwdHVyYWJsZUNvbnNvbGUuZGVidWcpLFxuICAgICAgbG9nOiBydW5PbkpTKGNhcHR1cmFibGVDb25zb2xlLmxvZyksXG4gICAgICB3YXJuOiBydW5PbkpTKGNhcHR1cmFibGVDb25zb2xlLndhcm4pLFxuICAgICAgZXJyb3I6IHJ1bk9uSlMoY2FwdHVyYWJsZUNvbnNvbGUuZXJyb3IpLFxuICAgICAgaW5mbzogcnVuT25KUyhjYXB0dXJhYmxlQ29uc29sZS5pbmZvKSxcbiAgICAgIC8qIGVzbGludC1lbmFibGUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kICovXG4gICAgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzZXR1cFJlcXVlc3RBbmltYXRpb25GcmFtZSgpIHtcbiAgJ3dvcmtsZXQnO1xuXG4gIC8vIEplc3QgbW9ja3MgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIEFQSSBhbmQgaXQgZG9lcyBub3QgbGlrZSBpZiB0aGF0IG1vY2sgZ2V0cyBvdmVycmlkZGVuXG4gIC8vIHNvIHdlIGF2b2lkIGRvaW5nIHJlcXVlc3RBbmltYXRpb25GcmFtZSBiYXRjaGluZyBpbiBKZXN0IGVudmlyb25tZW50LlxuICBjb25zdCBuYXRpdmVSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBnbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXG4gIGxldCBhbmltYXRpb25GcmFtZUNhbGxiYWNrczogQXJyYXk8KHRpbWVzdGFtcDogbnVtYmVyKSA9PiB2b2lkPiA9IFtdO1xuICBsZXQgZmx1c2hSZXF1ZXN0ZWQgPSBmYWxzZTtcblxuICBnbG9iYWwuX19mbHVzaEFuaW1hdGlvbkZyYW1lID0gKGZyYW1lVGltZXN0YW1wOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCBjdXJyZW50Q2FsbGJhY2tzID0gYW5pbWF0aW9uRnJhbWVDYWxsYmFja3M7XG4gICAgYW5pbWF0aW9uRnJhbWVDYWxsYmFja3MgPSBbXTtcbiAgICBjdXJyZW50Q2FsbGJhY2tzLmZvckVhY2goKGYpID0+IGYoZnJhbWVUaW1lc3RhbXApKTtcbiAgICBjYWxsTWljcm90YXNrcygpO1xuICB9O1xuXG4gIGdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSAoXG4gICAgY2FsbGJhY2s6ICh0aW1lc3RhbXA6IG51bWJlcikgPT4gdm9pZFxuICApOiBudW1iZXIgPT4ge1xuICAgIGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgIGlmICghZmx1c2hSZXF1ZXN0ZWQpIHtcbiAgICAgIGZsdXNoUmVxdWVzdGVkID0gdHJ1ZTtcbiAgICAgIG5hdGl2ZVJlcXVlc3RBbmltYXRpb25GcmFtZSgodGltZXN0YW1wKSA9PiB7XG4gICAgICAgIGZsdXNoUmVxdWVzdGVkID0gZmFsc2U7XG4gICAgICAgIGdsb2JhbC5fX2ZyYW1lVGltZXN0YW1wID0gdGltZXN0YW1wO1xuICAgICAgICBnbG9iYWwuX19mbHVzaEFuaW1hdGlvbkZyYW1lKHRpbWVzdGFtcCk7XG4gICAgICAgIGdsb2JhbC5fX2ZyYW1lVGltZXN0YW1wID0gdW5kZWZpbmVkO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFJlYW5pbWF0ZWQgY3VycmVudGx5IGRvZXMgbm90IHN1cHBvcnQgY2FuY2VsbGluZyBjYWxsYmFja3MgcmVxdWVzdGVkIHdpdGhcbiAgICAvLyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUuIFdlIHJldHVybiAtMSBhcyBpZGVudGlmaWVyIHdoaWNoIGlzbid0IGluIGxpbmVcbiAgICAvLyB3aXRoIHRoZSBzcGVjIGJ1dCBpdCBzaG91bGQgZ2l2ZSB1c2VycyBiZXR0ZXIgY2x1ZSBpbiBjYXNlIHRoZXkgYWN0dWFsbHlcbiAgICAvLyBhdHRlbXB0IHRvIHN0b3JlIHRoZSB2YWx1ZSByZXR1cm5lZCBmcm9tIHJBRiBhbmQgdXNlIGl0IGZvciBjYW5jZWxsaW5nLlxuICAgIHJldHVybiAtMTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVVSVJ1bnRpbWUoKSB7XG4gIGlmIChJU19KRVNUKSB7XG4gICAgLy8gcmVxdWVzdEFuaW1hdGlvbkZyYW1lIHJlYWN0LW5hdGl2ZSBqZXN0J3Mgc2V0dXAgaXMgaW5jb3JyZWN0IGFzIGl0IHBvbHlmaWxsc1xuICAgIC8vIHRoZSBtZXRob2QgZGlyZWN0bHkgdXNpbmcgc2V0VGltZW91dCwgdGhlcmVmb3JlIHRoZSBjYWxsYmFjayBkb2Vzbid0IGdldCB0aGVcbiAgICAvLyBleHBlY3RlZCB0aW1lc3RhbXAgYXMgdGhlIG9ubHkgYXJndW1lbnQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC1uYXRpdmUvYmxvYi9tYWluL3BhY2thZ2VzL3JlYWN0LW5hdGl2ZS9qZXN0L3NldHVwLmpzI0wyOFxuICAgIC8vIFdlIG92ZXJyaWRlIHRoaXMgc2V0dXAgaGVyZSB0byBtYWtlIHN1cmUgdGhhdCBjYWxsYmFja3MgZ2V0IHRoZSBwcm9wZXIgdGltZXN0YW1wc1xuICAgIC8vIHdoZW4gZXhlY3V0ZWQuIEZvciBub24tamVzdCBlbnZpcm9ubWVudHMgd2UgZGVmaW5lIHJlcXVlc3RBbmltYXRpb25GcmFtZSBpbiBzZXR1cFJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgIC8vIEB0cy1pZ25vcmUgVHlwZVNjcmlwdCB1c2VzIE5vZGUgZGVmaW5pdGlvbiBmb3IgckFGLCBzZXRUaW1lb3V0LCBldGMgd2hpY2ggcmV0dXJucyBhIFRpbWVvdXQgb2JqZWN0IHJhdGhlciB0aGFuIGEgbnVtYmVyXG4gICAgZ2xvYmFsVGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBtb2NrZWRSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG4gIH1cblxuICBydW5PblVJSW1tZWRpYXRlbHkoKCkgPT4ge1xuICAgICd3b3JrbGV0JztcbiAgICBzZXR1cENhbGxHdWFyZCgpO1xuICAgIHNldHVwQ29uc29sZSgpO1xuICAgIGlmICghU0hPVUxEX0JFX1VTRV9XRUIpIHtcbiAgICAgIHNldHVwTWljcm90YXNrcygpO1xuICAgICAgc2V0dXBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKTtcbiAgICB9XG4gIH0pKCk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBQUMsSUFBQUEsc0JBQUEsR0FBQUMsT0FBQTtBQUFBQyxNQUFBLENBQUFDLGNBQUEs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