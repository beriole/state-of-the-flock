4478beea9cc51f05ed23b77f761b81c0
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAnimatedReaction = useAnimatedReaction;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _react = require("react");
var _core = require("../core");
var _useSharedValue = require("./useSharedValue");
var _PlatformChecker = require("../PlatformChecker");
function useAnimatedReaction(prepare, react, dependencies) {
  var _prepare$__closure;
  var previous = (0, _useSharedValue.useSharedValue)(null);
  var inputs = Object.values((_prepare$__closure = prepare.__closure) != null ? _prepare$__closure : {});
  if ((0, _PlatformChecker.shouldBeUseWeb)()) {
    var _dependencies;
    if (!inputs.length && (_dependencies = dependencies) !== null && _dependencies !== void 0 && _dependencies.length) {
      inputs = dependencies;
    }
  }
  if (dependencies === undefined) {
    var _prepare$__closure2, _react$__closure;
    dependencies = [].concat((0, _toConsumableArray2.default)(Object.values((_prepare$__closure2 = prepare.__closure) != null ? _prepare$__closure2 : {})), (0, _toConsumableArray2.default)(Object.values((_react$__closure = react.__closure) != null ? _react$__closure : {})), [prepare.__workletHash, react.__workletHash]);
  } else {
    dependencies.push(prepare.__workletHash, react.__workletHash);
  }
  (0, _react.useEffect)(function () {
    var fun = function fun() {
      'worklet';

      var input = prepare();
      react(input, previous.value);
      previous.value = input;
    };
    var mapperId = (0, _core.startMapper)(fun, inputs);
    return function () {
      (0, _core.stopMapper)(mapperId);
    };
  }, dependencies);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwidXNlQW5pbWF0ZWRSZWFjdGlvbiIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJfcmVhY3QiLCJfY29yZSIsIl91c2VTaGFyZWRWYWx1ZSIsIl9QbGF0Zm9ybUNoZWNrZXIiLCJwcmVwYXJlIiwicmVhY3QiLCJkZXBlbmRlbmNpZXMiLCJfcHJlcGFyZSRfX2Nsb3N1cmUiLCJwcmV2aW91cyIsInVzZVNoYXJlZFZhbHVlIiwiaW5wdXRzIiwidmFsdWVzIiwiX19jbG9zdXJlIiwic2hvdWxkQmVVc2VXZWIiLCJfZGVwZW5kZW5jaWVzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX3ByZXBhcmUkX19jbG9zdXJlMiIsIl9yZWFjdCRfX2Nsb3N1cmUiLCJjb25jYXQiLCJkZWZhdWx0IiwiX193b3JrbGV0SGFzaCIsInB1c2giLCJ1c2VFZmZlY3QiLCJmdW4iLCJpbnB1dCIsIm1hcHBlcklkIiwic3RhcnRNYXBwZXIiLCJzdG9wTWFwcGVyIl0sInNvdXJjZXMiOlsidXNlQW5pbWF0ZWRSZWFjdGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdHlwZSB7IFdvcmtsZXRGdW5jdGlvbiB9IGZyb20gJy4uL2NvbW1vblR5cGVzJztcbmltcG9ydCB7IHN0YXJ0TWFwcGVyLCBzdG9wTWFwcGVyIH0gZnJvbSAnLi4vY29yZSc7XG5pbXBvcnQgdHlwZSB7IERlcGVuZGVuY3lMaXN0IH0gZnJvbSAnLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgeyB1c2VTaGFyZWRWYWx1ZSB9IGZyb20gJy4vdXNlU2hhcmVkVmFsdWUnO1xuaW1wb3J0IHsgc2hvdWxkQmVVc2VXZWIgfSBmcm9tICcuLi9QbGF0Zm9ybUNoZWNrZXInO1xuXG4vKipcbiAqIExldHMgeW91IHRvIHJlc3BvbmQgdG8gY2hhbmdlcyBpbiBhIFtzaGFyZWQgdmFsdWVdKGh0dHBzOi8vZG9jcy5zd21hbnNpb24uY29tL3JlYWN0LW5hdGl2ZS1yZWFuaW1hdGVkL2RvY3MvZnVuZGFtZW50YWxzL2dsb3NzYXJ5I3NoYXJlZC12YWx1ZSkuIEl0J3MgZXNwZWNpYWxseSB1c2VmdWwgd2hlbiBjb21wYXJpbmcgdmFsdWVzIHByZXZpb3VzbHkgc3RvcmVkIGluIHRoZSBzaGFyZWQgdmFsdWUgd2l0aCB0aGUgY3VycmVudCBvbmUuXG4gKlxuICogQHBhcmFtIHByZXBhcmUgLSBBIGZ1bmN0aW9uIHRoYXQgc2hvdWxkIHJldHVybiBhIHZhbHVlIHRvIHdoaWNoIHlvdSdkIGxpa2UgdG8gcmVhY3QuXG4gKiBAcGFyYW0gcmVhY3QgLSBBIGZ1bmN0aW9uIHRoYXQgcmVhY3RzIHRvIGNoYW5nZXMgaW4gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoZSBgcHJlcGFyZWAgZnVuY3Rpb24uXG4gKiBAcGFyYW0gZGVwZW5kZW5jaWVzIC0gYW4gb3B0aW9uYWwgYXJyYXkgb2YgZGVwZW5kZW5jaWVzLiBPbmx5IHJlbGV2YW50IHdoZW4gdXNpbmcgUmVhbmltYXRlZCB3aXRob3V0IHRoZSBCYWJlbCBwbHVnaW4gb24gdGhlIFdlYi5cbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLnN3bWFuc2lvbi5jb20vcmVhY3QtbmF0aXZlLXJlYW5pbWF0ZWQvZG9jcy9hZHZhbmNlZC91c2VBbmltYXRlZFJlYWN0aW9uXG4gKi9cbi8vIEB0cy1leHBlY3QtZXJyb3IgVGhpcyBvdmVybG9hZCBpcyByZXF1aXJlZCBieSBvdXIgQVBJLlxuZXhwb3J0IGZ1bmN0aW9uIHVzZUFuaW1hdGVkUmVhY3Rpb248UHJlcGFyZWRSZXN1bHQ+KFxuICBwcmVwYXJlOiAoKSA9PiBQcmVwYXJlZFJlc3VsdCxcbiAgcmVhY3Q6IChwcmVwYXJlZDogUHJlcGFyZWRSZXN1bHQsIHByZXZpb3VzOiBQcmVwYXJlZFJlc3VsdCB8IG51bGwpID0+IHZvaWQsXG4gIGRlcGVuZGVuY2llcz86IERlcGVuZGVuY3lMaXN0XG4pOiB2b2lkO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlQW5pbWF0ZWRSZWFjdGlvbjxQcmVwYXJlZFJlc3VsdD4oXG4gIHByZXBhcmU6IFdvcmtsZXRGdW5jdGlvbjxbXSwgUHJlcGFyZWRSZXN1bHQ+LFxuICByZWFjdDogV29ya2xldEZ1bmN0aW9uPFxuICAgIFtwcmVwYXJlOiBQcmVwYXJlZFJlc3VsdCwgcHJldmlvdXM6IFByZXBhcmVkUmVzdWx0IHwgbnVsbF0sXG4gICAgdm9pZFxuICA+LFxuICBkZXBlbmRlbmNpZXM/OiBEZXBlbmRlbmN5TGlzdFxuKSB7XG4gIGNvbnN0IHByZXZpb3VzID0gdXNlU2hhcmVkVmFsdWU8UHJlcGFyZWRSZXN1bHQgfCBudWxsPihudWxsKTtcblxuICBsZXQgaW5wdXRzID0gT2JqZWN0LnZhbHVlcyhwcmVwYXJlLl9fY2xvc3VyZSA/PyB7fSk7XG5cbiAgaWYgKHNob3VsZEJlVXNlV2ViKCkpIHtcbiAgICBpZiAoIWlucHV0cy5sZW5ndGggJiYgZGVwZW5kZW5jaWVzPy5sZW5ndGgpIHtcbiAgICAgIC8vIGxldCB3ZWIgd29yayB3aXRob3V0IGEgUmVhbmltYXRlZCBCYWJlbCBwbHVnaW5cbiAgICAgIGlucHV0cyA9IGRlcGVuZGVuY2llcztcbiAgICB9XG4gIH1cblxuICBpZiAoZGVwZW5kZW5jaWVzID09PSB1bmRlZmluZWQpIHtcbiAgICBkZXBlbmRlbmNpZXMgPSBbXG4gICAgICAuLi5PYmplY3QudmFsdWVzKHByZXBhcmUuX19jbG9zdXJlID8/IHt9KSxcbiAgICAgIC4uLk9iamVjdC52YWx1ZXMocmVhY3QuX19jbG9zdXJlID8/IHt9KSxcbiAgICAgIHByZXBhcmUuX193b3JrbGV0SGFzaCxcbiAgICAgIHJlYWN0Ll9fd29ya2xldEhhc2gsXG4gICAgXTtcbiAgfSBlbHNlIHtcbiAgICBkZXBlbmRlbmNpZXMucHVzaChwcmVwYXJlLl9fd29ya2xldEhhc2gsIHJlYWN0Ll9fd29ya2xldEhhc2gpO1xuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBmdW4gPSAoKSA9PiB7XG4gICAgICAnd29ya2xldCc7XG4gICAgICBjb25zdCBpbnB1dCA9IHByZXBhcmUoKTtcbiAgICAgIHJlYWN0KGlucHV0LCBwcmV2aW91cy52YWx1ZSk7XG4gICAgICBwcmV2aW91cy52YWx1ZSA9IGlucHV0O1xuICAgIH07XG4gICAgY29uc3QgbWFwcGVySWQgPSBzdGFydE1hcHBlcihmdW4sIGlucHV0cyk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHN0b3BNYXBwZXIobWFwcGVySWQpO1xuICAgIH07XG4gIH0sIGRlcGVuZGVuY2llcyk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBQUEsSUFBQUEsc0JBQUEsR0FBQUMsT0FBQTtBQUFBQyxNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBQyxLQUFBO0FBQUE7QUFBQUQsT0FBQSxDQUFBRSxtQkFBQSxHQUFBQSxtQkFBQTtBQUFBLElBQUFDLG1CQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDWixJQUFBTyxNQUFBLEdBQUFQLE9BQUE7QUFFQSxJQUFBUSxLQUFBLEdBQUFSLE9BQUE7QUFFQSxJQUFBUyxlQUFBLEdBQUFULE9BQUE7QUFDQSxJQUFBVSxnQkFBQSxHQUFBVixPQUFBO0FBaUJPLFNBQVNLLG1CQUFtQkEsQ0FDakNNLE9BQTRDLEVBQzVDQyxLQUdDLEVBQ0RDLFlBQTZCLEVBQzdCO0VBQUEsSUFBQUMsa0JBQUE7RUFDQSxJQUFNQyxRQUFRLEdBQUcsSUFBQUMsOEJBQWMsRUFBd0IsSUFBSSxDQUFDO0VBRTVELElBQUlDLE1BQU0sR0FBR2hCLE1BQU0sQ0FBQ2lCLE1BQU0sRUFBQUosa0JBQUEsR0FBQ0gsT0FBTyxDQUFDUSxTQUFTLFlBQUFMLGtCQUFBLEdBQUksQ0FBQyxDQUFDLENBQUM7RUFFbkQsSUFBSSxJQUFBTSwrQkFBYyxFQUFDLENBQUMsRUFBRTtJQUFBLElBQUFDLGFBQUE7SUFDcEIsSUFBSSxDQUFDSixNQUFNLENBQUNLLE1BQU0sS0FBQUQsYUFBQSxHQUFJUixZQUFZLGNBQUFRLGFBQUEsZUFBWkEsYUFBQSxDQUFjQyxNQUFNLEVBQUU7TUFFMUNMLE1BQU0sR0FBR0osWUFBWTtJQUN2QjtFQUNGO0VBRUEsSUFBSUEsWUFBWSxLQUFLVSxTQUFTLEVBQUU7SUFBQSxJQUFBQyxtQkFBQSxFQUFBQyxnQkFBQTtJQUM5QlosWUFBWSxNQUFBYSxNQUFBLEtBQUFwQixtQkFBQSxDQUFBcUIsT0FBQSxFQUNQMUIsTUFBTSxDQUFDaUIsTUFBTSxFQUFBTSxtQkFBQSxHQUFDYixPQUFPLENBQUNRLFNBQVMsWUFBQUssbUJBQUEsR0FBSSxDQUFDLENBQUMsQ0FBQyxPQUFBbEIsbUJBQUEsQ0FBQXFCLE9BQUEsRUFDdEMxQixNQUFNLENBQUNpQixNQUFNLEVBQUFPLGdCQUFBLEdBQUNiLEtBQUssQ0FBQ08sU0FBUyxZQUFBTSxnQkFBQSxHQUFJLENBQUMsQ0FBQyxDQUFDLElBQ3ZDZCxPQUFPLENBQUNpQixhQUFhLEVBQ3JCaEIsS0FBSyxDQUFDZ0IsYUFBYSxFQUNwQjtFQUNILENBQUMsTUFBTTtJQUNMZixZQUFZLENBQUNnQixJQUFJLENBQUNsQixPQUFPLENBQUNpQixhQUFhLEVBQUVoQixLQUFLLENBQUNnQixhQUFhLENBQUM7RUFDL0Q7RUFFQSxJQUFBRSxnQkFBUyxFQUFDLFlBQU07SUFDZCxJQUFNQyxHQUFHLEdBQUcsU0FBTkEsR0FBR0EsQ0FBQSxFQUFTO01BQ2hCLFNBQVM7O01BQ1QsSUFBTUMsS0FBSyxHQUFHckIsT0FBTyxDQUFDLENBQUM7TUFDdkJDLEtBQUssQ0FBQ29CLEtBQUssRUFBRWpCLFFBQVEsQ0FBQ1gsS0FBSyxDQUFDO01BQzVCVyxRQUFRLENBQUNYLEtBQUssR0FBRzRCLEtBQUs7SUFDeEIsQ0FBQztJQUNELElBQU1DLFFBQVEsR0FBRyxJQUFBQyxpQkFBVyxFQUFDSCxHQUFHLEVBQUVkLE1BQU0sQ0FBQztJQUN6QyxPQUFPLFlBQU07TUFDWCxJQUFBa0IsZ0JBQVUsRUFBQ0YsUUFBUSxDQUFDO0lBQ3RCLENBQUM7RUFDSCxDQUFDLEVBQUVwQixZQUFZLENBQUM7QUFDbEIiLCJpZ25vcmVMaXN0IjpbXX0=