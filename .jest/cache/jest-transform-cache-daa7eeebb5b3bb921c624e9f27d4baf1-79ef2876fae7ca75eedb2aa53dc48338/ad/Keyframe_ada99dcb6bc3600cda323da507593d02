d31dc304073a85339f2b013fdf402ae1
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Keyframe = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _Easing = require("../../Easing");
var _animation = require("../../animation");
var _commonTypes = require("../../commonTypes");
var _util = require("../../animation/util");
var InnerKeyframe = function () {
  function InnerKeyframe(definitions) {
    var _this = this;
    (0, _classCallCheck2.default)(this, InnerKeyframe);
    this.reduceMotionV = _commonTypes.ReduceMotion.System;
    this.build = function () {
      var delay = _this.delayV;
      var delayFunction = _this.getDelayFunction();
      var _this$parseDefinition = _this.parseDefinitions(),
        keyframes = _this$parseDefinition.keyframes,
        initialValues = _this$parseDefinition.initialValues;
      var callback = _this.callbackV;
      return function () {
        'worklet';

        var animations = {};
        var addAnimation = function addAnimation(key) {
          var keyframePoints = keyframes[key];
          if (keyframePoints.length === 0) {
            return;
          }
          var animation = delayFunction(delay, keyframePoints.length === 1 ? (0, _animation.withTiming)(keyframePoints[0].value, {
            duration: keyframePoints[0].duration,
            easing: keyframePoints[0].easing ? keyframePoints[0].easing : _Easing.Easing.linear
          }) : _animation.withSequence.apply(void 0, (0, _toConsumableArray2.default)(keyframePoints.map(function (keyframePoint) {
            return (0, _animation.withTiming)(keyframePoint.value, {
              duration: keyframePoint.duration,
              easing: keyframePoint.easing ? keyframePoint.easing : _Easing.Easing.linear
            });
          }))));
          if (key.includes('transform')) {
            if (!('transform' in animations)) {
              animations.transform = [];
            }
            animations.transform.push((0, _defineProperty2.default)({}, key.split(':')[1], animation));
          } else {
            animations[key] = animation;
          }
        };
        Object.keys(initialValues).forEach(function (key) {
          if (key.includes('transform')) {
            initialValues[key].forEach(function (transformProp, index) {
              Object.keys(transformProp).forEach(function (transformPropKey) {
                addAnimation(makeKeyframeKey(index, transformPropKey));
              });
            });
          } else {
            addAnimation(key);
          }
        });
        return {
          animations: animations,
          initialValues: initialValues,
          callback: callback
        };
      };
    };
    this.definitions = definitions;
  }
  return (0, _createClass2.default)(InnerKeyframe, [{
    key: "parseDefinitions",
    value: function parseDefinitions() {
      var _this2 = this;
      var parsedKeyframes = {};
      if (this.definitions.from) {
        if (this.definitions['0']) {
          throw new Error("[Reanimated] You cannot provide both keyframe 0 and 'from' as they both specified initial values.");
        }
        this.definitions['0'] = this.definitions.from;
        delete this.definitions.from;
      }
      if (this.definitions.to) {
        if (this.definitions['100']) {
          throw new Error("[Reanimated] You cannot provide both keyframe 100 and 'to' as they both specified values at the end of the animation.");
        }
        this.definitions['100'] = this.definitions.to;
        delete this.definitions.to;
      }
      if (!this.definitions['0']) {
        throw new Error("[Reanimated] Please provide 0 or 'from' keyframe with initial state of your object.");
      }
      var initialValues = this.definitions['0'];
      Object.keys(initialValues).forEach(function (styleProp) {
        if (styleProp === 'transform') {
          if (!Array.isArray(initialValues.transform)) {
            return;
          }
          initialValues.transform.forEach(function (transformStyle, index) {
            Object.keys(transformStyle).forEach(function (transformProp) {
              parsedKeyframes[makeKeyframeKey(index, transformProp)] = [];
            });
          });
        } else {
          parsedKeyframes[styleProp] = [];
        }
      });
      var duration = this.durationV ? this.durationV : 500;
      var animationKeyPoints = Array.from(Object.keys(this.definitions));
      var getAnimationDuration = function getAnimationDuration(key, currentKeyPoint) {
        var maxDuration = currentKeyPoint / 100 * duration;
        var currentDuration = parsedKeyframes[key].reduce(function (acc, value) {
          return acc + value.duration;
        }, 0);
        return maxDuration - currentDuration;
      };
      var addKeyPoint = function addKeyPoint(_ref) {
        var key = _ref.key,
          value = _ref.value,
          currentKeyPoint = _ref.currentKeyPoint,
          easing = _ref.easing;
        if (!(key in parsedKeyframes)) {
          throw new Error("[Reanimated] Keyframe can contain only that set of properties that were provide with initial values (keyframe 0 or 'from')");
        }
        if (__DEV__ && easing) {
          (0, _util.assertEasingIsWorklet)(easing);
        }
        parsedKeyframes[key].push({
          duration: getAnimationDuration(key, currentKeyPoint),
          value: value,
          easing: easing
        });
      };
      animationKeyPoints.filter(function (value) {
        return parseInt(value) !== 0;
      }).sort(function (a, b) {
        return parseInt(a) - parseInt(b);
      }).forEach(function (keyPoint) {
        if (parseInt(keyPoint) < 0 || parseInt(keyPoint) > 100) {
          throw new Error('[Reanimated] Keyframe should be in between range 0 - 100.');
        }
        var keyframe = _this2.definitions[keyPoint];
        var easing = keyframe.easing;
        delete keyframe.easing;
        var addKeyPointWith = function addKeyPointWith(key, value) {
          return addKeyPoint({
            key: key,
            value: value,
            currentKeyPoint: parseInt(keyPoint),
            easing: easing
          });
        };
        Object.keys(keyframe).forEach(function (key) {
          if (key === 'transform') {
            if (!Array.isArray(keyframe.transform)) {
              return;
            }
            keyframe.transform.forEach(function (transformStyle, index) {
              Object.keys(transformStyle).forEach(function (transformProp) {
                addKeyPointWith(makeKeyframeKey(index, transformProp), transformStyle[transformProp]);
              });
            });
          } else {
            addKeyPointWith(key, keyframe[key]);
          }
        });
      });
      return {
        initialValues: initialValues,
        keyframes: parsedKeyframes
      };
    }
  }, {
    key: "duration",
    value: function duration(durationMs) {
      this.durationV = durationMs;
      return this;
    }
  }, {
    key: "delay",
    value: function delay(delayMs) {
      this.delayV = delayMs;
      return this;
    }
  }, {
    key: "withCallback",
    value: function withCallback(callback) {
      this.callbackV = callback;
      return this;
    }
  }, {
    key: "reduceMotion",
    value: function reduceMotion(reduceMotionV) {
      this.reduceMotionV = reduceMotionV;
      return this;
    }
  }, {
    key: "getDelayFunction",
    value: function getDelayFunction() {
      var delay = this.delayV;
      var reduceMotion = this.reduceMotionV;
      return delay ? function (delay, animation) {
        'worklet';

        return (0, _animation.withDelay)(delay, animation, reduceMotion);
      } : function (_, animation) {
        'worklet';

        animation.reduceMotion = (0, _util.getReduceMotionFromConfig)(reduceMotion);
        return animation;
      };
    }
  }]);
}();
function makeKeyframeKey(index, transformProp) {
  'worklet';

  return `${index}_transform:${transformProp}`;
}
var Keyframe = exports.Keyframe = InnerKeyframe;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiS2V5ZnJhbWUiLCJfZGVmaW5lUHJvcGVydHkyIiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX0Vhc2luZyIsIl9hbmltYXRpb24iLCJfY29tbW9uVHlwZXMiLCJfdXRpbCIsIklubmVyS2V5ZnJhbWUiLCJkZWZpbml0aW9ucyIsIl90aGlzIiwiZGVmYXVsdCIsInJlZHVjZU1vdGlvblYiLCJSZWR1Y2VNb3Rpb24iLCJTeXN0ZW0iLCJidWlsZCIsImRlbGF5IiwiZGVsYXlWIiwiZGVsYXlGdW5jdGlvbiIsImdldERlbGF5RnVuY3Rpb24iLCJfdGhpcyRwYXJzZURlZmluaXRpb24iLCJwYXJzZURlZmluaXRpb25zIiwia2V5ZnJhbWVzIiwiaW5pdGlhbFZhbHVlcyIsImNhbGxiYWNrIiwiY2FsbGJhY2tWIiwiYW5pbWF0aW9ucyIsImFkZEFuaW1hdGlvbiIsImtleSIsImtleWZyYW1lUG9pbnRzIiwibGVuZ3RoIiwiYW5pbWF0aW9uIiwid2l0aFRpbWluZyIsImR1cmF0aW9uIiwiZWFzaW5nIiwiRWFzaW5nIiwibGluZWFyIiwid2l0aFNlcXVlbmNlIiwiYXBwbHkiLCJtYXAiLCJrZXlmcmFtZVBvaW50IiwiaW5jbHVkZXMiLCJ0cmFuc2Zvcm0iLCJwdXNoIiwic3BsaXQiLCJrZXlzIiwiZm9yRWFjaCIsInRyYW5zZm9ybVByb3AiLCJpbmRleCIsInRyYW5zZm9ybVByb3BLZXkiLCJtYWtlS2V5ZnJhbWVLZXkiLCJfdGhpczIiLCJwYXJzZWRLZXlmcmFtZXMiLCJmcm9tIiwiRXJyb3IiLCJ0byIsInN0eWxlUHJvcCIsIkFycmF5IiwiaXNBcnJheSIsInRyYW5zZm9ybVN0eWxlIiwiZHVyYXRpb25WIiwiYW5pbWF0aW9uS2V5UG9pbnRzIiwiZ2V0QW5pbWF0aW9uRHVyYXRpb24iLCJjdXJyZW50S2V5UG9pbnQiLCJtYXhEdXJhdGlvbiIsImN1cnJlbnREdXJhdGlvbiIsInJlZHVjZSIsImFjYyIsImFkZEtleVBvaW50IiwiX3JlZiIsIl9fREVWX18iLCJhc3NlcnRFYXNpbmdJc1dvcmtsZXQiLCJmaWx0ZXIiLCJwYXJzZUludCIsInNvcnQiLCJhIiwiYiIsImtleVBvaW50Iiwia2V5ZnJhbWUiLCJhZGRLZXlQb2ludFdpdGgiLCJkdXJhdGlvbk1zIiwiZGVsYXlNcyIsIndpdGhDYWxsYmFjayIsInJlZHVjZU1vdGlvbiIsIndpdGhEZWxheSIsIl8iLCJnZXRSZWR1Y2VNb3Rpb25Gcm9tQ29uZmlnIl0sInNvdXJjZXMiOlsiS2V5ZnJhbWUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHsgRWFzaW5nIH0gZnJvbSAnLi4vLi4vRWFzaW5nJztcbmltcG9ydCB7IHdpdGhEZWxheSwgd2l0aFNlcXVlbmNlLCB3aXRoVGltaW5nIH0gZnJvbSAnLi4vLi4vYW5pbWF0aW9uJztcbmltcG9ydCB0eXBlIHtcbiAgQW5pbWF0aW9uRnVuY3Rpb24sXG4gIEVudHJ5RXhpdEFuaW1hdGlvbkZ1bmN0aW9uLFxuICBJRW50cnlFeGl0QW5pbWF0aW9uQnVpbGRlcixcbiAgS2V5ZnJhbWVQcm9wcyxcbiAgU3R5bGVQcm9wc1dpdGhBcnJheVRyYW5zZm9ybSxcbn0gZnJvbSAnLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgdHlwZSB7XG4gIFN0eWxlUHJvcHMsXG4gIEVhc2luZ0Z1bmN0aW9uLFxuICBUcmFuc2Zvcm1BcnJheUl0ZW0sXG59IGZyb20gJy4uLy4uL2NvbW1vblR5cGVzJztcbmltcG9ydCB7IFJlZHVjZU1vdGlvbiB9IGZyb20gJy4uLy4uL2NvbW1vblR5cGVzJztcbmltcG9ydCB7XG4gIGFzc2VydEVhc2luZ0lzV29ya2xldCxcbiAgZ2V0UmVkdWNlTW90aW9uRnJvbUNvbmZpZyxcbn0gZnJvbSAnLi4vLi4vYW5pbWF0aW9uL3V0aWwnO1xuXG5pbnRlcmZhY2UgS2V5ZnJhbWVQb2ludCB7XG4gIGR1cmF0aW9uOiBudW1iZXI7XG4gIHZhbHVlOiBudW1iZXIgfCBzdHJpbmc7XG4gIGVhc2luZz86IEVhc2luZ0Z1bmN0aW9uO1xufVxuaW50ZXJmYWNlIFBhcnNlZEtleWZyYW1lc0RlZmluaXRpb24ge1xuICBpbml0aWFsVmFsdWVzOiBTdHlsZVByb3BzO1xuICBrZXlmcmFtZXM6IFJlY29yZDxzdHJpbmcsIEtleWZyYW1lUG9pbnRbXT47XG59XG5jbGFzcyBJbm5lcktleWZyYW1lIGltcGxlbWVudHMgSUVudHJ5RXhpdEFuaW1hdGlvbkJ1aWxkZXIge1xuICBkdXJhdGlvblY/OiBudW1iZXI7XG4gIGRlbGF5Vj86IG51bWJlcjtcbiAgcmVkdWNlTW90aW9uVjogUmVkdWNlTW90aW9uID0gUmVkdWNlTW90aW9uLlN5c3RlbTtcbiAgY2FsbGJhY2tWPzogKGZpbmlzaGVkOiBib29sZWFuKSA9PiB2b2lkO1xuICBkZWZpbml0aW9uczogUmVjb3JkPHN0cmluZywgS2V5ZnJhbWVQcm9wcz47XG5cbiAgLypcbiAgICBLZXlmcmFtZSBkZWZpbml0aW9uIHNob3VsZCBiZSBwYXNzZWQgaW4gdGhlIGNvbnN0cnVjdG9yIGFzIHRoZSBtYXBcbiAgICB3aGljaCBrZXlzIGFyZSBiZXR3ZWVuIHJhbmdlIDAgLSAxMDAgKCUpIGFuZCBjb3JyZXNwb25kIHRvIHRoZSBwb2ludCBpbiB0aGUgYW5pbWF0aW9uIHByb2dyZXNzLlxuICAqL1xuICBjb25zdHJ1Y3RvcihkZWZpbml0aW9uczogUmVjb3JkPHN0cmluZywgS2V5ZnJhbWVQcm9wcz4pIHtcbiAgICB0aGlzLmRlZmluaXRpb25zID0gZGVmaW5pdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIHBhcnNlRGVmaW5pdGlvbnMoKTogUGFyc2VkS2V5ZnJhbWVzRGVmaW5pdGlvbiB7XG4gICAgLyogXG4gICAgICAgIEVhY2ggc3R5bGUgcHJvcGVydHkgY29udGFpbiBhbiBhcnJheSB3aXRoIGFsbCB0aGVpciBrZXkgcG9pbnRzOiBcbiAgICAgICAgdmFsdWUsIGR1cmF0aW9uIG9mIHRyYW5zaXRpb24gdG8gdGhhdCB2YWx1ZSwgYW5kIG9wdGlvbmFsIGVhc2luZyBmdW5jdGlvbiAoZGVmYXVsdHMgdG8gTGluZWFyKVxuICAgICovXG4gICAgY29uc3QgcGFyc2VkS2V5ZnJhbWVzOiBSZWNvcmQ8c3RyaW5nLCBLZXlmcmFtZVBvaW50W10+ID0ge307XG4gICAgLypcbiAgICAgIFBhcnNpbmcga2V5ZnJhbWVzICdmcm9tJyBhbmQgJ3RvJy5cbiAgICAqL1xuICAgIGlmICh0aGlzLmRlZmluaXRpb25zLmZyb20pIHtcbiAgICAgIGlmICh0aGlzLmRlZmluaXRpb25zWycwJ10pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIFwiW1JlYW5pbWF0ZWRdIFlvdSBjYW5ub3QgcHJvdmlkZSBib3RoIGtleWZyYW1lIDAgYW5kICdmcm9tJyBhcyB0aGV5IGJvdGggc3BlY2lmaWVkIGluaXRpYWwgdmFsdWVzLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aGlzLmRlZmluaXRpb25zWycwJ10gPSB0aGlzLmRlZmluaXRpb25zLmZyb207XG4gICAgICBkZWxldGUgdGhpcy5kZWZpbml0aW9ucy5mcm9tO1xuICAgIH1cbiAgICBpZiAodGhpcy5kZWZpbml0aW9ucy50bykge1xuICAgICAgaWYgKHRoaXMuZGVmaW5pdGlvbnNbJzEwMCddKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBcIltSZWFuaW1hdGVkXSBZb3UgY2Fubm90IHByb3ZpZGUgYm90aCBrZXlmcmFtZSAxMDAgYW5kICd0bycgYXMgdGhleSBib3RoIHNwZWNpZmllZCB2YWx1ZXMgYXQgdGhlIGVuZCBvZiB0aGUgYW5pbWF0aW9uLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aGlzLmRlZmluaXRpb25zWycxMDAnXSA9IHRoaXMuZGVmaW5pdGlvbnMudG87XG4gICAgICBkZWxldGUgdGhpcy5kZWZpbml0aW9ucy50bztcbiAgICB9XG4gICAgLyogXG4gICAgICAgT25lIG9mIHRoZSBhc3N1bXB0aW9ucyBpcyB0aGF0IGtleWZyYW1lICAwIGlzIHJlcXVpcmVkIHRvIHByb3Blcmx5IHNldCBpbml0aWFsIHZhbHVlcy5cbiAgICAgICBFdmVyeSBvdGhlciBrZXlmcmFtZSBzaG91bGQgY29udGFpbiBwcm9wZXJ0aWVzIGZyb20gdGhlIHNldCBwcm92aWRlZCBhcyBpbml0aWFsIHZhbHVlcy5cbiAgICAqL1xuICAgIGlmICghdGhpcy5kZWZpbml0aW9uc1snMCddKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiW1JlYW5pbWF0ZWRdIFBsZWFzZSBwcm92aWRlIDAgb3IgJ2Zyb20nIGtleWZyYW1lIHdpdGggaW5pdGlhbCBzdGF0ZSBvZiB5b3VyIG9iamVjdC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgaW5pdGlhbFZhbHVlczogU3R5bGVQcm9wcyA9IHRoaXMuZGVmaW5pdGlvbnNbJzAnXSBhcyBTdHlsZVByb3BzO1xuICAgIC8qXG4gICAgICBJbml0aWFsaXplIHBhcnNlZEtleWZyYW1lcyBmb3IgcHJvcGVydGllcyBwcm92aWRlZCBpbiBpbml0aWFsIGtleWZyYW1lXG4gICAgKi9cbiAgICBPYmplY3Qua2V5cyhpbml0aWFsVmFsdWVzKS5mb3JFYWNoKChzdHlsZVByb3A6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKHN0eWxlUHJvcCA9PT0gJ3RyYW5zZm9ybScpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGluaXRpYWxWYWx1ZXMudHJhbnNmb3JtKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpbml0aWFsVmFsdWVzLnRyYW5zZm9ybS5mb3JFYWNoKCh0cmFuc2Zvcm1TdHlsZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICBPYmplY3Qua2V5cyh0cmFuc2Zvcm1TdHlsZSkuZm9yRWFjaCgodHJhbnNmb3JtUHJvcDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBwYXJzZWRLZXlmcmFtZXNbbWFrZUtleWZyYW1lS2V5KGluZGV4LCB0cmFuc2Zvcm1Qcm9wKV0gPSBbXTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJzZWRLZXlmcmFtZXNbc3R5bGVQcm9wXSA9IFtdO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgZHVyYXRpb246IG51bWJlciA9IHRoaXMuZHVyYXRpb25WID8gdGhpcy5kdXJhdGlvblYgOiA1MDA7XG4gICAgY29uc3QgYW5pbWF0aW9uS2V5UG9pbnRzOiBBcnJheTxzdHJpbmc+ID0gQXJyYXkuZnJvbShcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMuZGVmaW5pdGlvbnMpXG4gICAgKTtcblxuICAgIGNvbnN0IGdldEFuaW1hdGlvbkR1cmF0aW9uID0gKFxuICAgICAga2V5OiBzdHJpbmcsXG4gICAgICBjdXJyZW50S2V5UG9pbnQ6IG51bWJlclxuICAgICk6IG51bWJlciA9PiB7XG4gICAgICBjb25zdCBtYXhEdXJhdGlvbiA9IChjdXJyZW50S2V5UG9pbnQgLyAxMDApICogZHVyYXRpb247XG4gICAgICBjb25zdCBjdXJyZW50RHVyYXRpb24gPSBwYXJzZWRLZXlmcmFtZXNba2V5XS5yZWR1Y2UoXG4gICAgICAgIChhY2M6IG51bWJlciwgdmFsdWU6IEtleWZyYW1lUG9pbnQpID0+IGFjYyArIHZhbHVlLmR1cmF0aW9uLFxuICAgICAgICAwXG4gICAgICApO1xuICAgICAgcmV0dXJuIG1heER1cmF0aW9uIC0gY3VycmVudER1cmF0aW9uO1xuICAgIH07XG5cbiAgICAvKiBcbiAgICAgICBPdGhlciBrZXlmcmFtZXMgY2FuJ3QgY29udGFpbiBwcm9wZXJ0aWVzIHRoYXQgd2VyZSBub3Qgc3BlY2lmaWVkIGluIGluaXRpYWwga2V5ZnJhbWUuXG4gICAgKi9cbiAgICBjb25zdCBhZGRLZXlQb2ludCA9ICh7XG4gICAgICBrZXksXG4gICAgICB2YWx1ZSxcbiAgICAgIGN1cnJlbnRLZXlQb2ludCxcbiAgICAgIGVhc2luZyxcbiAgICB9OiB7XG4gICAgICBrZXk6IHN0cmluZztcbiAgICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBjdXJyZW50S2V5UG9pbnQ6IG51bWJlcjtcbiAgICAgIGVhc2luZz86IEVhc2luZ0Z1bmN0aW9uO1xuICAgIH0pOiB2b2lkID0+IHtcbiAgICAgIGlmICghKGtleSBpbiBwYXJzZWRLZXlmcmFtZXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBcIltSZWFuaW1hdGVkXSBLZXlmcmFtZSBjYW4gY29udGFpbiBvbmx5IHRoYXQgc2V0IG9mIHByb3BlcnRpZXMgdGhhdCB3ZXJlIHByb3ZpZGUgd2l0aCBpbml0aWFsIHZhbHVlcyAoa2V5ZnJhbWUgMCBvciAnZnJvbScpXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKF9fREVWX18gJiYgZWFzaW5nKSB7XG4gICAgICAgIGFzc2VydEVhc2luZ0lzV29ya2xldChlYXNpbmcpO1xuICAgICAgfVxuXG4gICAgICBwYXJzZWRLZXlmcmFtZXNba2V5XS5wdXNoKHtcbiAgICAgICAgZHVyYXRpb246IGdldEFuaW1hdGlvbkR1cmF0aW9uKGtleSwgY3VycmVudEtleVBvaW50KSxcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGVhc2luZyxcbiAgICAgIH0pO1xuICAgIH07XG4gICAgYW5pbWF0aW9uS2V5UG9pbnRzXG4gICAgICAuZmlsdGVyKCh2YWx1ZTogc3RyaW5nKSA9PiBwYXJzZUludCh2YWx1ZSkgIT09IDApXG4gICAgICAuc29ydCgoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IHBhcnNlSW50KGEpIC0gcGFyc2VJbnQoYikpXG4gICAgICAuZm9yRWFjaCgoa2V5UG9pbnQ6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAocGFyc2VJbnQoa2V5UG9pbnQpIDwgMCB8fCBwYXJzZUludChrZXlQb2ludCkgPiAxMDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAnW1JlYW5pbWF0ZWRdIEtleWZyYW1lIHNob3VsZCBiZSBpbiBiZXR3ZWVuIHJhbmdlIDAgLSAxMDAuJ1xuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ZnJhbWU6IEtleWZyYW1lUHJvcHMgPSB0aGlzLmRlZmluaXRpb25zW2tleVBvaW50XTtcbiAgICAgICAgY29uc3QgZWFzaW5nID0ga2V5ZnJhbWUuZWFzaW5nO1xuICAgICAgICBkZWxldGUga2V5ZnJhbWUuZWFzaW5nO1xuICAgICAgICBjb25zdCBhZGRLZXlQb2ludFdpdGggPSAoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpID0+XG4gICAgICAgICAgYWRkS2V5UG9pbnQoe1xuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBjdXJyZW50S2V5UG9pbnQ6IHBhcnNlSW50KGtleVBvaW50KSxcbiAgICAgICAgICAgIGVhc2luZyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmtleXMoa2V5ZnJhbWUpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgaWYgKGtleSA9PT0gJ3RyYW5zZm9ybScpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShrZXlmcmFtZS50cmFuc2Zvcm0pKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleWZyYW1lLnRyYW5zZm9ybS5mb3JFYWNoKCh0cmFuc2Zvcm1TdHlsZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgT2JqZWN0LmtleXModHJhbnNmb3JtU3R5bGUpLmZvckVhY2goKHRyYW5zZm9ybVByb3A6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGFkZEtleVBvaW50V2l0aChcbiAgICAgICAgICAgICAgICAgIG1ha2VLZXlmcmFtZUtleShpbmRleCwgdHJhbnNmb3JtUHJvcCksXG4gICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1TdHlsZVtcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtUHJvcCBhcyBrZXlvZiB0eXBlb2YgdHJhbnNmb3JtU3R5bGVcbiAgICAgICAgICAgICAgICAgIF0gYXMgbnVtYmVyIHwgc3RyaW5nIC8vIEhlcmUgd2UgYXNzdW1lIHRoYXQgdXNlciBoYXMgcGFzc2VkIHByb3BzIG9mIHByb3BlciB0eXBlLlxuICAgICAgICAgICAgICAgICAgLy8gSSBkb24ndCB0aGluayBpdCdzIHdvcnRod2hpbGUgdG8gY2hlY2sgaWYgaGUgcGFzc2VkIGkuZS4gYEFuaW1hdGVkLk5vZGVgLlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFkZEtleVBvaW50V2l0aChrZXksIGtleWZyYW1lW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICByZXR1cm4geyBpbml0aWFsVmFsdWVzLCBrZXlmcmFtZXM6IHBhcnNlZEtleWZyYW1lcyB9O1xuICB9XG5cbiAgZHVyYXRpb24oZHVyYXRpb25NczogbnVtYmVyKTogSW5uZXJLZXlmcmFtZSB7XG4gICAgdGhpcy5kdXJhdGlvblYgPSBkdXJhdGlvbk1zO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZGVsYXkoZGVsYXlNczogbnVtYmVyKTogSW5uZXJLZXlmcmFtZSB7XG4gICAgdGhpcy5kZWxheVYgPSBkZWxheU1zO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aENhbGxiYWNrKGNhbGxiYWNrOiAoZmluc2loZWQ6IGJvb2xlYW4pID0+IHZvaWQpOiBJbm5lcktleWZyYW1lIHtcbiAgICB0aGlzLmNhbGxiYWNrViA9IGNhbGxiYWNrO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcmVkdWNlTW90aW9uKHJlZHVjZU1vdGlvblY6IFJlZHVjZU1vdGlvbik6IHRoaXMge1xuICAgIHRoaXMucmVkdWNlTW90aW9uViA9IHJlZHVjZU1vdGlvblY7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBwcml2YXRlIGdldERlbGF5RnVuY3Rpb24oKTogQW5pbWF0aW9uRnVuY3Rpb24ge1xuICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5kZWxheVY7XG4gICAgY29uc3QgcmVkdWNlTW90aW9uID0gdGhpcy5yZWR1Y2VNb3Rpb25WO1xuICAgIHJldHVybiBkZWxheVxuICAgICAgPyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXNoYWRvd1xuICAgICAgICAoZGVsYXksIGFuaW1hdGlvbikgPT4ge1xuICAgICAgICAgICd3b3JrbGV0JztcbiAgICAgICAgICByZXR1cm4gd2l0aERlbGF5KGRlbGF5LCBhbmltYXRpb24sIHJlZHVjZU1vdGlvbik7XG4gICAgICAgIH1cbiAgICAgIDogKF8sIGFuaW1hdGlvbikgPT4ge1xuICAgICAgICAgICd3b3JrbGV0JztcbiAgICAgICAgICBhbmltYXRpb24ucmVkdWNlTW90aW9uID0gZ2V0UmVkdWNlTW90aW9uRnJvbUNvbmZpZyhyZWR1Y2VNb3Rpb24pO1xuICAgICAgICAgIHJldHVybiBhbmltYXRpb247XG4gICAgICAgIH07XG4gIH1cblxuICBidWlsZCA9ICgpOiBFbnRyeUV4aXRBbmltYXRpb25GdW5jdGlvbiA9PiB7XG4gICAgY29uc3QgZGVsYXkgPSB0aGlzLmRlbGF5VjtcbiAgICBjb25zdCBkZWxheUZ1bmN0aW9uID0gdGhpcy5nZXREZWxheUZ1bmN0aW9uKCk7XG4gICAgY29uc3QgeyBrZXlmcmFtZXMsIGluaXRpYWxWYWx1ZXMgfSA9IHRoaXMucGFyc2VEZWZpbml0aW9ucygpO1xuICAgIGNvbnN0IGNhbGxiYWNrID0gdGhpcy5jYWxsYmFja1Y7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgJ3dvcmtsZXQnO1xuICAgICAgY29uc3QgYW5pbWF0aW9uczogU3R5bGVQcm9wc1dpdGhBcnJheVRyYW5zZm9ybSA9IHt9O1xuXG4gICAgICAvKiBcbiAgICAgICAgICAgIEZvciBlYWNoIHN0eWxlIHByb3BlcnR5LCBhbiBhbmltYXRpb25zIHNlcXVlbmNlIGlzIGNyZWF0ZWQgdGhhdCBjb3JyZXNwb25kcyB3aXRoIGl0cyBrZXkgcG9pbnRzLlxuICAgICAgICAgICAgVHJhbnNmb3JtIHN0eWxlIHByb3BlcnRpZXMgcmVxdWlyZSBzcGVjaWFsIGhhbmRsaW5nIGJlY2F1c2Ugb2YgdGhlaXIgbmVzdGVkIHN0cnVjdHVyZS5cbiAgICAgICovXG4gICAgICBjb25zdCBhZGRBbmltYXRpb24gPSAoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3Qga2V5ZnJhbWVQb2ludHMgPSBrZXlmcmFtZXNba2V5XTtcbiAgICAgICAgLy8gaW4gY2FzZSBpZiBwcm9wZXJ0eSB3YXMgb25seSBwYXNzZWQgYXMgaW5pdGlhbCB2YWx1ZVxuICAgICAgICBpZiAoa2V5ZnJhbWVQb2ludHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IGRlbGF5RnVuY3Rpb24oXG4gICAgICAgICAgZGVsYXksXG4gICAgICAgICAga2V5ZnJhbWVQb2ludHMubGVuZ3RoID09PSAxXG4gICAgICAgICAgICA/IHdpdGhUaW1pbmcoa2V5ZnJhbWVQb2ludHNbMF0udmFsdWUsIHtcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjoga2V5ZnJhbWVQb2ludHNbMF0uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZWFzaW5nOiBrZXlmcmFtZVBvaW50c1swXS5lYXNpbmdcbiAgICAgICAgICAgICAgICAgID8ga2V5ZnJhbWVQb2ludHNbMF0uZWFzaW5nXG4gICAgICAgICAgICAgICAgICA6IEVhc2luZy5saW5lYXIsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICA6IHdpdGhTZXF1ZW5jZShcbiAgICAgICAgICAgICAgICAuLi5rZXlmcmFtZVBvaW50cy5tYXAoKGtleWZyYW1lUG9pbnQ6IEtleWZyYW1lUG9pbnQpID0+XG4gICAgICAgICAgICAgICAgICB3aXRoVGltaW5nKGtleWZyYW1lUG9pbnQudmFsdWUsIHtcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGtleWZyYW1lUG9pbnQuZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGVhc2luZzoga2V5ZnJhbWVQb2ludC5lYXNpbmdcbiAgICAgICAgICAgICAgICAgICAgICA/IGtleWZyYW1lUG9pbnQuZWFzaW5nXG4gICAgICAgICAgICAgICAgICAgICAgOiBFYXNpbmcubGluZWFyLFxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGtleS5pbmNsdWRlcygndHJhbnNmb3JtJykpIHtcbiAgICAgICAgICBpZiAoISgndHJhbnNmb3JtJyBpbiBhbmltYXRpb25zKSkge1xuICAgICAgICAgICAgYW5pbWF0aW9ucy50cmFuc2Zvcm0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYW5pbWF0aW9ucy50cmFuc2Zvcm0hLnB1c2goPFRyYW5zZm9ybUFycmF5SXRlbT57XG4gICAgICAgICAgICBba2V5LnNwbGl0KCc6JylbMV1dOiBhbmltYXRpb24sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYW5pbWF0aW9uc1trZXldID0gYW5pbWF0aW9uO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgT2JqZWN0LmtleXMoaW5pdGlhbFZhbHVlcykuZm9yRWFjaCgoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKGtleS5pbmNsdWRlcygndHJhbnNmb3JtJykpIHtcbiAgICAgICAgICBpbml0aWFsVmFsdWVzW2tleV0uZm9yRWFjaChcbiAgICAgICAgICAgICh0cmFuc2Zvcm1Qcm9wOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXIgfCBzdHJpbmc+LCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICAgIE9iamVjdC5rZXlzKHRyYW5zZm9ybVByb3ApLmZvckVhY2goKHRyYW5zZm9ybVByb3BLZXk6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGFkZEFuaW1hdGlvbihtYWtlS2V5ZnJhbWVLZXkoaW5kZXgsIHRyYW5zZm9ybVByb3BLZXkpKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZGRBbmltYXRpb24oa2V5KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbmltYXRpb25zLFxuICAgICAgICBpbml0aWFsVmFsdWVzLFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgIH07XG4gICAgfTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gbWFrZUtleWZyYW1lS2V5KGluZGV4OiBudW1iZXIsIHRyYW5zZm9ybVByb3A6IHN0cmluZykge1xuICAnd29ya2xldCc7XG4gIHJldHVybiBgJHtpbmRleH1fdHJhbnNmb3JtOiR7dHJhbnNmb3JtUHJvcH1gO1xufVxuXG4vLyBUT0RPIFRZUEVTQ1JJUFQgVGhpcyBpcyBhIHRlbXBvcmFyeSB0eXBlIHRvIGdldCByaWQgb2YgLmQudHMgZmlsZS5cbmV4cG9ydCBkZWNsYXJlIGNsYXNzIFJlYW5pbWF0ZWRLZXlmcmFtZSB7XG4gIGNvbnN0cnVjdG9yKGRlZmluaXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBLZXlmcmFtZVByb3BzPik7XG4gIGR1cmF0aW9uKGR1cmF0aW9uTXM6IG51bWJlcik6IFJlYW5pbWF0ZWRLZXlmcmFtZTtcbiAgZGVsYXkoZGVsYXlNczogbnVtYmVyKTogUmVhbmltYXRlZEtleWZyYW1lO1xuICByZWR1Y2VNb3Rpb24ocmVkdWNlTW90aW9uVjogUmVkdWNlTW90aW9uKTogUmVhbmltYXRlZEtleWZyYW1lO1xuICB3aXRoQ2FsbGJhY2soY2FsbGJhY2s6IChmaW5pc2hlZDogYm9vbGVhbikgPT4gdm9pZCk6IFJlYW5pbWF0ZWRLZXlmcmFtZTtcbn1cblxuLy8gVE9ETyBUWVBFU0NSSVBUIFRoaXMgdGVtcG9yYXJ5IGNhc3QgaXMgdG8gZ2V0IHJpZCBvZiAuZC50cyBmaWxlLlxuZXhwb3J0IGNvbnN0IEtleWZyYW1lID0gSW5uZXJLZXlmcmFtZSBhcyB1bmtub3duIGFzIHR5cGVvZiBSZWFuaW1hdGVkS2V5ZnJhbWU7XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBQUMsSUFBQUEsc0JBQUEsR0FBQUMsT0FBQTtBQUFBQyxNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBQyxLQUFBO0FBQUE7QUFBQUQsT0FBQSxDQUFBRSxRQUFBO0FBQUEsSUFBQUMsZ0JBQUEsR0FBQVAsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFPLG1CQUFBLEdBQUFSLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBUSxnQkFBQSxHQUFBVCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQVMsYUFBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ2IsSUFBQVUsT0FBQSxHQUFBVixPQUFBO0FBQ0EsSUFBQVcsVUFBQSxHQUFBWCxPQUFBO0FBYUEsSUFBQVksWUFBQSxHQUFBWixPQUFBO0FBQ0EsSUFBQWEsS0FBQSxHQUFBYixPQUFBO0FBRzhCLElBV3hCYyxhQUFhO0VBV2pCLFNBQUFBLGNBQVlDLFdBQTBDLEVBQUU7SUFBQSxJQUFBQyxLQUFBO0lBQUEsSUFBQVIsZ0JBQUEsQ0FBQVMsT0FBQSxRQUFBSCxhQUFBO0lBQUEsS0FSeERJLGFBQWEsR0FBaUJDLHlCQUFZLENBQUNDLE1BQU07SUFBQSxLQWlNakRDLEtBQUssR0FBRyxZQUFrQztNQUN4QyxJQUFNQyxLQUFLLEdBQUdOLEtBQUksQ0FBQ08sTUFBTTtNQUN6QixJQUFNQyxhQUFhLEdBQUdSLEtBQUksQ0FBQ1MsZ0JBQWdCLENBQUMsQ0FBQztN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