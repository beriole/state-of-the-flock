1b57b3d36e71b13d9c559c49d140e924
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _NativeReanimated = _interopRequireDefault(require("./NativeReanimated"));
var _commonTypes = require("./commonTypes");
var _mutables = require("./mutables");
function _defineProperty(obj, key, value) {
  key = _toPropertyKey(key);
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
function _toPropertyKey(t) {
  var i = _toPrimitive(t, "string");
  return "symbol" == typeof i ? i : i + "";
}
function _toPrimitive(t, r) {
  if ("object" != typeof t || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r || "default");
    if ("object" != typeof i) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return ("string" === r ? String : Number)(t);
}
function initSensorData(sensorType) {
  if (sensorType === _commonTypes.SensorType.ROTATION) {
    return (0, _mutables.makeMutable)({
      qw: 0,
      qx: 0,
      qy: 0,
      qz: 0,
      yaw: 0,
      pitch: 0,
      roll: 0,
      interfaceOrientation: 0
    });
  } else {
    return (0, _mutables.makeMutable)({
      x: 0,
      y: 0,
      z: 0,
      interfaceOrientation: 0
    });
  }
}
var Sensor = exports.default = function () {
  function Sensor(sensorType, config) {
    (0, _classCallCheck2.default)(this, Sensor);
    _defineProperty(this, "listenersNumber", 0);
    _defineProperty(this, "sensorId", null);
    _defineProperty(this, "sensorType", void 0);
    _defineProperty(this, "data", void 0);
    _defineProperty(this, "config", void 0);
    this.sensorType = sensorType;
    this.config = config;
    this.data = initSensorData(sensorType);
  }
  return (0, _createClass2.default)(Sensor, [{
    key: "register",
    value: function register(eventHandler) {
      var config = this.config;
      var sensorType = this.sensorType;
      this.sensorId = _NativeReanimated.default.registerSensor(sensorType, config.interval === 'auto' ? -1 : config.interval, config.iosReferenceFrame, eventHandler);
      return this.sensorId !== -1;
    }
  }, {
    key: "isRunning",
    value: function isRunning() {
      return this.sensorId !== -1 && this.sensorId !== null;
    }
  }, {
    key: "isAvailable",
    value: function isAvailable() {
      return this.sensorId !== -1;
    }
  }, {
    key: "getSharedValue",
    value: function getSharedValue() {
      return this.data;
    }
  }, {
    key: "unregister",
    value: function unregister() {
      if (this.sensorId !== null && this.sensorId !== -1) {
        _NativeReanimated.default.unregisterSensor(this.sensorId);
      }
      this.sensorId = null;
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX05hdGl2ZVJlYW5pbWF0ZWQiLCJfY29tbW9uVHlwZXMiLCJfbXV0YWJsZXMiLCJfZGVmaW5lUHJvcGVydHkiLCJvYmoiLCJrZXkiLCJfdG9Qcm9wZXJ0eUtleSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsInQiLCJpIiwiX3RvUHJpbWl0aXZlIiwiciIsImUiLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJOdW1iZXIiLCJpbml0U2Vuc29yRGF0YSIsInNlbnNvclR5cGUiLCJTZW5zb3JUeXBlIiwiUk9UQVRJT04iLCJtYWtlTXV0YWJsZSIsInF3IiwicXgiLCJxeSIsInF6IiwieWF3IiwicGl0Y2giLCJyb2xsIiwiaW50ZXJmYWNlT3JpZW50YXRpb24iLCJ4IiwieSIsInoiLCJTZW5zb3IiLCJjb25maWciLCJkYXRhIiwicmVnaXN0ZXIiLCJldmVudEhhbmRsZXIiLCJzZW5zb3JJZCIsIk5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUiLCJyZWdpc3RlclNlbnNvciIsImludGVydmFsIiwiaW9zUmVmZXJlbmNlRnJhbWUiLCJpc1J1bm5pbmciLCJpc0F2YWlsYWJsZSIsImdldFNoYXJlZFZhbHVlIiwidW5yZWdpc3RlciIsInVucmVnaXN0ZXJTZW5zb3IiXSwic291cmNlcyI6WyJTZW5zb3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUgZnJvbSAnLi9OYXRpdmVSZWFuaW1hdGVkJztcbmltcG9ydCB0eXBlIHtcbiAgU2Vuc29yQ29uZmlnLFxuICBTaGFyZWRWYWx1ZSxcbiAgVmFsdWUzRCxcbiAgVmFsdWVSb3RhdGlvbixcbiAgU2hhcmVhYmxlUmVmLFxufSBmcm9tICcuL2NvbW1vblR5cGVzJztcbmltcG9ydCB7IFNlbnNvclR5cGUgfSBmcm9tICcuL2NvbW1vblR5cGVzJztcbmltcG9ydCB7IG1ha2VNdXRhYmxlIH0gZnJvbSAnLi9tdXRhYmxlcyc7XG5cbmZ1bmN0aW9uIGluaXRTZW5zb3JEYXRhKFxuICBzZW5zb3JUeXBlOiBTZW5zb3JUeXBlXG4pOiBTaGFyZWRWYWx1ZTxWYWx1ZTNEIHwgVmFsdWVSb3RhdGlvbj4ge1xuICBpZiAoc2Vuc29yVHlwZSA9PT0gU2Vuc29yVHlwZS5ST1RBVElPTikge1xuICAgIHJldHVybiBtYWtlTXV0YWJsZTxWYWx1ZTNEIHwgVmFsdWVSb3RhdGlvbj4oe1xuICAgICAgcXc6IDAsXG4gICAgICBxeDogMCxcbiAgICAgIHF5OiAwLFxuICAgICAgcXo6IDAsXG4gICAgICB5YXc6IDAsXG4gICAgICBwaXRjaDogMCxcbiAgICAgIHJvbGw6IDAsXG4gICAgICBpbnRlcmZhY2VPcmllbnRhdGlvbjogMCxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbWFrZU11dGFibGU8VmFsdWUzRCB8IFZhbHVlUm90YXRpb24+KHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwLFxuICAgICAgejogMCxcbiAgICAgIGludGVyZmFjZU9yaWVudGF0aW9uOiAwLFxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlbnNvciB7XG4gIHB1YmxpYyBsaXN0ZW5lcnNOdW1iZXIgPSAwO1xuICBwcml2YXRlIHNlbnNvcklkOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBzZW5zb3JUeXBlOiBTZW5zb3JUeXBlO1xuICBwcml2YXRlIGRhdGE6IFNoYXJlZFZhbHVlPFZhbHVlM0QgfCBWYWx1ZVJvdGF0aW9uPjtcbiAgcHJpdmF0ZSBjb25maWc6IFNlbnNvckNvbmZpZztcblxuICBjb25zdHJ1Y3RvcihzZW5zb3JUeXBlOiBTZW5zb3JUeXBlLCBjb25maWc6IFNlbnNvckNvbmZpZykge1xuICAgIHRoaXMuc2Vuc29yVHlwZSA9IHNlbnNvclR5cGU7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5kYXRhID0gaW5pdFNlbnNvckRhdGEoc2Vuc29yVHlwZSk7XG4gIH1cblxuICByZWdpc3RlcihcbiAgICBldmVudEhhbmRsZXI6IFNoYXJlYWJsZVJlZjwoZGF0YTogVmFsdWUzRCB8IFZhbHVlUm90YXRpb24pID0+IHZvaWQ+XG4gICkge1xuICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuY29uZmlnO1xuICAgIGNvbnN0IHNlbnNvclR5cGUgPSB0aGlzLnNlbnNvclR5cGU7XG4gICAgdGhpcy5zZW5zb3JJZCA9IE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUucmVnaXN0ZXJTZW5zb3IoXG4gICAgICBzZW5zb3JUeXBlLFxuICAgICAgY29uZmlnLmludGVydmFsID09PSAnYXV0bycgPyAtMSA6IGNvbmZpZy5pbnRlcnZhbCxcbiAgICAgIGNvbmZpZy5pb3NSZWZlcmVuY2VGcmFtZSxcbiAgICAgIGV2ZW50SGFuZGxlclxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuc2Vuc29ySWQgIT09IC0xO1xuICB9XG5cbiAgaXNSdW5uaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnNlbnNvcklkICE9PSAtMSAmJiB0aGlzLnNlbnNvcklkICE9PSBudWxsO1xuICB9XG5cbiAgaXNBdmFpbGFibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2Vuc29ySWQgIT09IC0xO1xuICB9XG5cbiAgZ2V0U2hhcmVkVmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfVxuXG4gIHVucmVnaXN0ZXIoKSB7XG4gICAgaWYgKHRoaXMuc2Vuc29ySWQgIT09IG51bGwgJiYgdGhpcy5zZW5zb3JJZCAhPT0gLTEpIHtcbiAgICAgIE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUudW5yZWdpc3RlclNlbnNvcih0aGlzLnNlbnNvcklkKTtcbiAgICB9XG4gICAg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