a2f9640c186c2b8a02b7dcb7ad6242d6
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.withDelay = void 0;
var _util = require("./util");
var withDelay = exports.withDelay = function withDelay(delayMs, _nextAnimation, reduceMotion) {
  'worklet';

  return (0, _util.defineAnimation)(_nextAnimation, function () {
    'worklet';

    var nextAnimation = typeof _nextAnimation === 'function' ? _nextAnimation() : _nextAnimation;
    function delay(animation, now) {
      var startTime = animation.startTime,
        started = animation.started,
        previousAnimation = animation.previousAnimation;
      var current = animation.current;
      if (now - startTime > delayMs || animation.reduceMotion) {
        if (!started) {
          nextAnimation.onStart(nextAnimation, current, now, previousAnimation);
          animation.previousAnimation = null;
          animation.started = true;
        }
        var finished = nextAnimation.onFrame(nextAnimation, now);
        animation.current = nextAnimation.current;
        return finished;
      } else if (previousAnimation) {
        var _finished = previousAnimation.finished || previousAnimation.onFrame(previousAnimation, now);
        animation.current = previousAnimation.current;
        if (_finished) {
          animation.previousAnimation = null;
        }
      }
      return false;
    }
    function onStart(animation, value, now, previousAnimation) {
      animation.startTime = now;
      animation.started = false;
      animation.current = value;
      if (previousAnimation === animation) {
        animation.previousAnimation = previousAnimation.previousAnimation;
      } else {
        animation.previousAnimation = previousAnimation;
      }
      if (nextAnimation.reduceMotion === undefined) {
        nextAnimation.reduceMotion = animation.reduceMotion;
      }
    }
    var callback = function callback(finished) {
      if (nextAnimation.callback) {
        nextAnimation.callback(finished);
      }
    };
    return {
      isHigherOrder: true,
      onFrame: delay,
      onStart: onStart,
      current: nextAnimation.current,
      callback: callback,
      previousAnimation: null,
      startTime: 0,
      started: false,
      reduceMotion: (0, _util.getReduceMotionForAnimation)(reduceMotion)
    };
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIndpdGhEZWxheSIsIl91dGlsIiwicmVxdWlyZSIsImRlbGF5TXMiLCJfbmV4dEFuaW1hdGlvbiIsInJlZHVjZU1vdGlvbiIsImRlZmluZUFuaW1hdGlvbiIsIm5leHRBbmltYXRpb24iLCJkZWxheSIsImFuaW1hdGlvbiIsIm5vdyIsInN0YXJ0VGltZSIsInN0YXJ0ZWQiLCJwcmV2aW91c0FuaW1hdGlvbiIsImN1cnJlbnQiLCJvblN0YXJ0IiwiZmluaXNoZWQiLCJvbkZyYW1lIiwidW5kZWZpbmVkIiwiY2FsbGJhY2siLCJpc0hpZ2hlck9yZGVyIiwiZ2V0UmVkdWNlTW90aW9uRm9yQW5pbWF0aW9uIl0sInNvdXJjZXMiOlsiZGVsYXkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHsgZGVmaW5lQW5pbWF0aW9uLCBnZXRSZWR1Y2VNb3Rpb25Gb3JBbmltYXRpb24gfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHR5cGUge1xuICBBbmltYXRpb24sXG4gIFRpbWVzdGFtcCxcbiAgQW5pbWF0YWJsZVZhbHVlLFxuICBBbmltYXRpb25PYmplY3QsXG4gIFJlZHVjZU1vdGlvbixcbn0gZnJvbSAnLi4vY29tbW9uVHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBEZWxheUFuaW1hdGlvbiB9IGZyb20gJy4vY29tbW9uVHlwZXMnO1xuXG4vLyBUT0RPIFRZUEVTQ1JJUFQgVGhpcyBpcyBhIHRlbXBvcmFyeSB0eXBlIHRvIGdldCByaWQgb2YgLmQudHMgZmlsZS5cbnR5cGUgd2l0aERlbGF5VHlwZSA9IDxUIGV4dGVuZHMgQW5pbWF0YWJsZVZhbHVlPihcbiAgZGVsYXlNczogbnVtYmVyLFxuICBkZWxheWVkQW5pbWF0aW9uOiBULFxuICByZWR1Y2VNb3Rpb24/OiBSZWR1Y2VNb3Rpb25cbikgPT4gVDtcblxuLyoqXG4gKiBBbiBhbmltYXRpb24gbW9kaWZpZXIgdGhhdCBsZXRzIHlvdSBzdGFydCBhbiBhbmltYXRpb24gd2l0aCBhIGRlbGF5LlxuICpcbiAqIEBwYXJhbSBkZWxheU1zIC0gRHVyYXRpb24gKGluIG1pbGxpc2Vjb25kcykgYmVmb3JlIHRoZSBhbmltYXRpb24gc3RhcnRzLlxuICogQHBhcmFtIG5leHRBbmltYXRpb24gLSBUaGUgYW5pbWF0aW9uIHRvIGRlbGF5LlxuICogQHBhcmFtIHJlZHVjZU1vdGlvbiAtIERldGVybWluZXMgaG93IHRoZSBhbmltYXRpb24gcmVzcG9uZHMgdG8gdGhlIGRldmljZSdzIHJlZHVjZWQgbW90aW9uIGFjY2Vzc2liaWxpdHkgc2V0dGluZy4gRGVmYXVsdCB0byBgUmVkdWNlTW90aW9uLlN5c3RlbWAgLSB7QGxpbmsgUmVkdWNlTW90aW9ufS5cbiAqIEByZXR1cm5zIEFuIFthbmltYXRpb24gb2JqZWN0XShodHRwczovL2RvY3Muc3dtYW5zaW9uLmNvbS9yZWFjdC1uYXRpdmUtcmVhbmltYXRlZC9kb2NzL2Z1bmRhbWVudGFscy9nbG9zc2FyeSNhbmltYXRpb24tb2JqZWN0KSB3aGljaCBob2xkcyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgYW5pbWF0aW9uLlxuICogQHNlZSBodHRwczovL2RvY3Muc3dtYW5zaW9uLmNvbS9yZWFjdC1uYXRpdmUtcmVhbmltYXRlZC9kb2NzL2FuaW1hdGlvbnMvd2l0aERlbGF5XG4gKi9cbmV4cG9ydCBjb25zdCB3aXRoRGVsYXkgPSBmdW5jdGlvbiA8VCBleHRlbmRzIEFuaW1hdGlvbk9iamVjdD4oXG4gIGRlbGF5TXM6IG51bWJlcixcbiAgX25leHRBbmltYXRpb246IFQgfCAoKCkgPT4gVCksXG4gIHJlZHVjZU1vdGlvbj86IFJlZHVjZU1vdGlvblxuKTogQW5pbWF0aW9uPERlbGF5QW5pbWF0aW9uPiB7XG4gICd3b3JrbGV0JztcbiAgcmV0dXJuIGRlZmluZUFuaW1hdGlvbjxEZWxheUFuaW1hdGlvbiwgVD4oXG4gICAgX25leHRBbmltYXRpb24sXG4gICAgKCk6IERlbGF5QW5pbWF0aW9uID0+IHtcbiAgICAgICd3b3JrbGV0JztcbiAgICAgIGNvbnN0IG5leHRBbmltYXRpb24gPVxuICAgICAgICB0eXBlb2YgX25leHRBbmltYXRpb24gPT09ICdmdW5jdGlvbidcbiAgICAgICAgICA/IF9uZXh0QW5pbWF0aW9uKClcbiAgICAgICAgICA6IF9uZXh0QW5pbWF0aW9uO1xuXG4gICAgICBmdW5jdGlvbiBkZWxheShhbmltYXRpb246IERlbGF5QW5pbWF0aW9uLCBub3c6IFRpbWVzdGFtcCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IHN0YXJ0VGltZSwgc3RhcnRlZCwgcHJldmlvdXNBbmltYXRpb24gfSA9IGFuaW1hdGlvbjtcbiAgICAgICAgY29uc3QgY3VycmVudDogQW5pbWF0YWJsZVZhbHVlID0gYW5pbWF0aW9uLmN1cnJlbnQ7XG5cbiAgICAgICAgaWYgKG5vdyAtIHN0YXJ0VGltZSA+IGRlbGF5TXMgfHwgYW5pbWF0aW9uLnJlZHVjZU1vdGlvbikge1xuICAgICAgICAgIGlmICghc3RhcnRlZCkge1xuICAgICAgICAgICAgbmV4dEFuaW1hdGlvbi5vblN0YXJ0KFxuICAgICAgICAgICAgICBuZXh0QW5pbWF0aW9uLFxuICAgICAgICAgICAgICBjdXJyZW50LFxuICAgICAgICAgICAgICBub3csXG4gICAgICAgICAgICAgIHByZXZpb3VzQW5pbWF0aW9uIVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGFuaW1hdGlvbi5wcmV2aW91c0FuaW1hdGlvbiA9IG51bGw7XG4gICAgICAgICAgICBhbmltYXRpb24uc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGZpbmlzaGVkID0gbmV4dEFuaW1hdGlvbi5vbkZyYW1lKG5leHRBbmltYXRpb24sIG5vdyk7XG4gICAgICAgICAgYW5pbWF0aW9uLmN1cnJlbnQgPSBuZXh0QW5pbWF0aW9uLmN1cnJlbnQhO1xuICAgICAgICAgIHJldHVybiBmaW5pc2hlZDtcbiAgICAgICAgfSBlbHNlIGlmIChwcmV2aW91c0FuaW1hdGlvbikge1xuICAgICAgICAgIGNvbnN0IGZpbmlzaGVkID1cbiAgICAgICAgICAgIHByZXZpb3VzQW5pbWF0aW9uLmZpbmlzaGVkIHx8XG4gICAgICAgICAgICBwcmV2aW91c0FuaW1hdGlvbi5vbkZyYW1lKHByZXZpb3VzQW5pbWF0aW9uLCBub3cpO1xuICAgICAgICAgIGFuaW1hdGlvbi5jdXJyZW50ID0gcHJldmlvdXNBbmltYXRpb24uY3VycmVudDtcbiAgICAgICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgICAgIGFuaW1hdGlvbi5wcmV2aW91c0FuaW1hdGlvbiA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25TdGFydChcbiAgICAgICAgYW5pbWF0aW9uOiBBbmltYXRpb248YW55PixcbiAgICAgICAgdmFsdWU6IEFuaW1hdGFibGVWYWx1ZSxcbiAgICAgICAgbm93OiBUaW1lc3RhbXAsXG4gICAgICAgIHByZXZpb3VzQW5pbWF0aW9uOiBBbmltYXRpb248YW55PiB8IG51bGxcbiAgICAgICk6IHZvaWQge1xuICAgICAgICBhbmltYXRpb24uc3RhcnRUaW1lID0gbm93O1xuICAgICAgICBhbmltYXRpb24uc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICBhbmltYXRpb24uY3VycmVudCA9IHZhbHVlO1xuICAgICAgICBpZiAocHJldmlvdXNBbmltYXRpb24gPT09IGFuaW1hdGlvbikge1xuICAgICAgICAgIGFuaW1hdGlvbi5wcmV2aW91c0FuaW1hdGlvbiA9IHByZXZpb3VzQW5pbWF0aW9uLnByZXZpb3VzQW5pbWF0aW9uO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFuaW1hdGlvbi5wcmV2aW91c0FuaW1hdGlvbiA9IHByZXZpb3VzQW5pbWF0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hpbGQgYW5pbWF0aW9ucyBpbmhlcml0IHRoZSBzZXR0aW5nLCB1bmxlc3MgdGhleSBhbHJlYWR5IGhhdmUgaXQgZGVmaW5lZFxuICAgICAgICAvLyB0aGV5IHdpbGwgaGF2ZSBpdCBkZWZpbmVkIG9ubHkgaWYgdGhlIHVzZXIgdXNlZCB0aGUgYHJlZHVjZU1vdGlvbmAgcHJvcFxuICAgICAgICBpZiAobmV4dEFuaW1hdGlvbi5yZWR1Y2VNb3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG5leHRBbmltYXRpb24ucmVkdWNlTW90aW9uID0gYW5pbWF0aW9uLnJlZHVjZU1vdGlvbjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBjYWxsYmFjayA9IChmaW5pc2hlZD86IGJvb2xlYW4pOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKG5leHRBbmltYXRpb24uY2FsbGJhY2spIHtcbiAgICAgICAgICBuZXh0QW5pbWF0aW9uLmNhbGxiYWNrKGZpbmlzaGVkKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNIaWdoZXJPcmRlcjogdHJ1ZSxcbiAgICAgICAgb25GcmFtZTogZGVsYXksXG4gICAgICAgIG9uU3RhcnQsXG4gICAgICAgIGN1cnJlbnQ6IG5leHRBbmltYXRpb24uY3VycmVudCEsXG4gICAgICAgIGNhbGxiYWNrLFxuICAgICAgICBwcmV2aW91c0FuaW1hdGlvbjogbnVsbCxcbiAgICAgICAgc3RhcnRUaW1lOiAwLFxuICAgICAgICBzdGFydGVkOiBmYWxzZSxcbiAgICAgICAgcmVkdWNlTW90aW9uOiBnZXRSZWR1Y2VNb3Rpb25Gb3JBbmltYXRpb24ocmVkdWNlTW90aW9uKSxcbiAgICAgIH07XG4gICAgfVxuICApO1xufSBhcyB3aXRoRGVsYXlUeXBlO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUFBQSxNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBQyxLQUFBO0FBQUE7QUFBQUQsT0FBQSxDQUFBRSxTQUFBO0FBQ1osSUFBQUMsS0FBQSxH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