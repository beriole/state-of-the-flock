42b642cf43e754160dc7816b7c888504
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createWorkletRuntime = createWorkletRuntime;
exports.runOnRuntime = runOnRuntime;
var _commonTypes = require("./commonTypes");
var _initializers = require("./initializers");
var _NativeReanimated = _interopRequireDefault(require("./NativeReanimated"));
var _PlatformChecker = require("./PlatformChecker");
var _shareables = require("./shareables");
var SHOULD_BE_USE_WEB = (0, _PlatformChecker.shouldBeUseWeb)();
function createWorkletRuntime(name, initializer) {
  return _NativeReanimated.default.createWorkletRuntime(name, (0, _shareables.makeShareableCloneRecursive)(function () {
    'worklet';

    (0, _initializers.setupCallGuard)();
    (0, _initializers.setupConsole)();
    initializer == null || initializer();
  }));
}
function runOnRuntime(workletRuntime, worklet) {
  'worklet';

  if (__DEV__ && !SHOULD_BE_USE_WEB && !(0, _commonTypes.isWorkletFunction)(worklet)) {
    throw new Error('[Reanimated] The function passed to `runOnRuntime` is not a worklet.' + (_WORKLET ? ' Please make sure that `processNestedWorklets` option in Reanimated Babel plugin is enabled.' : ''));
  }
  if (_WORKLET) {
    return function () {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }
      return global._scheduleOnRuntime(workletRuntime, (0, _shareables.makeShareableCloneOnUIRecursive)(function () {
        'worklet';

        worklet.apply(void 0, args);
      }));
    };
  }
  return function () {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }
    return _NativeReanimated.default.scheduleOnRuntime(workletRuntime, (0, _shareables.makeShareableCloneRecursive)(function () {
      'worklet';

      worklet.apply(void 0, args);
    }));
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY3JlYXRlV29ya2xldFJ1bnRpbWUiLCJydW5PblJ1bnRpbWUiLCJfY29tbW9uVHlwZXMiLCJfaW5pdGlhbGl6ZXJzIiwiX05hdGl2ZVJlYW5pbWF0ZWQiLCJfUGxhdGZvcm1DaGVja2VyIiwiX3NoYXJlYWJsZXMiLCJTSE9VTERfQkVfVVNFX1dFQiIsInNob3VsZEJlVXNlV2ViIiwibmFtZSIsImluaXRpYWxpemVyIiwiTmF0aXZlUmVhbmltYXRlZE1vZHVsZSIsIm1ha2VTaGFyZWFibGVDbG9uZVJlY3Vyc2l2ZSIsInNldHVwQ2FsbEd1YXJkIiwic2V0dXBDb25zb2xlIiwid29ya2xldFJ1bnRpbWUiLCJ3b3JrbGV0IiwiX19ERVZfXyIsImlzV29ya2xldEZ1bmN0aW9uIiwiRXJyb3IiLCJfV09SS0xFVCIsIl9sZW4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhcmdzIiwiQXJyYXkiLCJfa2V5IiwiZ2xvYmFsIiwiX3NjaGVkdWxlT25SdW50aW1lIiwibWFrZVNoYXJlYWJsZUNsb25lT25VSVJlY3Vyc2l2ZSIsImFwcGx5IiwiX2xlbjIiLCJfa2V5MiIsInNjaGVkdWxlT25SdW50aW1lIl0sInNvdXJjZXMiOlsicnVudGltZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IHsgaXNXb3JrbGV0RnVuY3Rpb24gfSBmcm9tICcuL2NvbW1vblR5cGVzJztcbmltcG9ydCB0eXBlIHsgV29ya2xldEZ1bmN0aW9uIH0gZnJvbSAnLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgeyBzZXR1cENhbGxHdWFyZCwgc2V0dXBDb25zb2xlIH0gZnJvbSAnLi9pbml0aWFsaXplcnMnO1xuaW1wb3J0IE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUgZnJvbSAnLi9OYXRpdmVSZWFuaW1hdGVkJztcbmltcG9ydCB7IHNob3VsZEJlVXNlV2ViIH0gZnJvbSAnLi9QbGF0Zm9ybUNoZWNrZXInO1xuaW1wb3J0IHtcbiAgbWFrZVNoYXJlYWJsZUNsb25lT25VSVJlY3Vyc2l2ZSxcbiAgbWFrZVNoYXJlYWJsZUNsb25lUmVjdXJzaXZlLFxufSBmcm9tICcuL3NoYXJlYWJsZXMnO1xuXG5jb25zdCBTSE9VTERfQkVfVVNFX1dFQiA9IHNob3VsZEJlVXNlV2ViKCk7XG5cbmV4cG9ydCB0eXBlIFdvcmtsZXRSdW50aW1lID0ge1xuICBfX2hvc3RPYmplY3RXb3JrbGV0UnVudGltZTogbmV2ZXI7XG4gIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbn07XG5cbi8qKlxuICogTGV0cyB5b3UgY3JlYXRlIGEgbmV3IEpTIHJ1bnRpbWUgd2hpY2ggY2FuIGJlIHVzZWQgdG8gcnVuIHdvcmtsZXRzIHBvc3NpYmx5IG9uIGRpZmZlcmVudCB0aHJlYWRzIHRoYW4gSlMgb3IgVUkgdGhyZWFkLlxuICpcbiAqIEBwYXJhbSBuYW1lIC0gQSBuYW1lIHVzZWQgdG8gaWRlbnRpZnkgdGhlIHJ1bnRpbWUgd2hpY2ggd2lsbCBhcHBlYXIgaW4gZGV2aWNlcyBsaXN0IGluIENocm9tZSBEZXZUb29scy5cbiAqIEBwYXJhbSBpbml0aWFsaXplciAtIEFuIG9wdGlvbmFsIHdvcmtsZXQgdGhhdCB3aWxsIGJlIHJ1biBzeW5jaHJvbm91c2x5IG9uIHRoZSBzYW1lIHRocmVhZCBpbW1lZGlhdGVseSBhZnRlciB0aGUgcnVudGltZSBpcyBjcmVhdGVkLlxuICogQHJldHVybnMgV29ya2xldFJ1bnRpbWUgd2hpY2ggaXMgYSBqc2k6Okhvc3RPYmplY3RcXDxyZWFuaW1hdGVkOjpXb3JrbGV0UnVudGltZVxcPiAtIHtAbGluayBXb3JrbGV0UnVudGltZX1cbiAqIEBzZWUgaHR0cHM6Ly9kb2NzLnN3bWFuc2lvbi5jb20vcmVhY3QtbmF0aXZlLXJlYW5pbWF0ZWQvZG9jcy90aHJlYWRpbmcvY3JlYXRlV29ya2xldFJ1bnRpbWVcbiAqL1xuLy8gQHRzLWV4cGVjdC1lcnJvciBDaGVjayBgcnVuT25VSWAgb3ZlcmxvYWQuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlV29ya2xldFJ1bnRpbWUoXG4gIG5hbWU6IHN0cmluZyxcbiAgaW5pdGlhbGl6ZXI/OiAoKSA9PiB2b2lkXG4pOiBXb3JrbGV0UnVudGltZTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVdvcmtsZXRSdW50aW1lKFxuICBuYW1lOiBzdHJpbmcsXG4gIGluaXRpYWxpemVyPzogV29ya2xldEZ1bmN0aW9uPFtdLCB2b2lkPlxuKTogV29ya2xldFJ1bnRpbWUge1xuICByZXR1cm4gTmF0aXZlUmVhbmltYXRlZE1vZHVsZS5jcmVhdGVXb3JrbGV0UnVudGltZShcbiAgICBuYW1lLFxuICAgIG1ha2VTaGFyZWFibGVDbG9uZVJlY3Vyc2l2ZSgoKSA9PiB7XG4gICAgICAnd29ya2xldCc7XG4gICAgICBzZXR1cENhbGxHdWFyZCgpO1xuICAgICAgc2V0dXBDb25zb2xlKCk7XG4gICAgICBpbml0aWFsaXplcj8uKCk7XG4gICAgfSlcbiAgKTtcbn1cblxuLy8gQHRzLWV4cGVjdC1lcnJvciBDaGVjayBgcnVuT25VSWAgb3ZlcmxvYWQuXG5leHBvcnQgZnVuY3Rpb24gcnVuT25SdW50aW1lPEFyZ3MgZXh0ZW5kcyB1bmtub3duW10sIFJldHVyblZhbHVlPihcbiAgd29ya2xldFJ1bnRpbWU6IFdvcmtsZXRSdW50aW1lLFxuICB3b3JrbGV0OiAoLi4uYXJnczogQXJncykgPT4gUmV0dXJuVmFsdWVcbik6IFdvcmtsZXRGdW5jdGlvbjxBcmdzLCBSZXR1cm5WYWx1ZT47XG4vKipcbiAqIFNjaGVkdWxlIGEgd29ya2xldCB0byBleGVjdXRlIG9uIHRoZSBiYWNrZ3JvdW5kIHF1ZXVlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcnVuT25SdW50aW1lPEFyZ3MgZXh0ZW5kcyB1bmtub3duW10sIFJldHVyblZhbHVlPihcbiAgd29ya2xldFJ1bnRpbWU6IFdvcmtsZXRSdW50aW1lLFxuICB3b3JrbGV0OiBXb3JrbGV0RnVuY3Rpb248QXJncywgUmV0dXJuVmFsdWU+XG4pOiAoLi4uYXJnczogQXJncykgPT4gdm9pZCB7XG4gICd3b3JrbGV0JztcbiAgaWYgKF9fREVWX18gJiYgIVNIT1VMRF9CRV9VU0VfV0VCICYmICFpc1dvcmtsZXRGdW5jdGlvbih3b3JrbGV0KSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdbUmVhbmltYXRlZF0gVGhlIGZ1bmN0aW9uIHBhc3NlZCB0byBgcnVuT25SdW50aW1lYCBpcyBub3QgYSB3b3JrbGV0LicgK1xuICAgICAgICAoX1dPUktMRVRcbiAgICAgICAgICA/ICcgUGxlYXNlIG1ha2Ugc3VyZSB0aGF0IGBwcm9jZXNzTmVzdGVkV29ya2xldHNgIG9wdGlvbiBpbiBSZWFuaW1hdGVkIEJhYmVsIHBsdWdpbiBpcyBlbmFibGVkLidcbiAgICAgICAgICA6ICcnKVxuICAgICk7XG4gIH1cbiAgaWYgKF9XT1JLTEVUKSB7XG4gICAgcmV0dXJuICguLi5hcmdzKSA9PlxuICAgICAgZ2xvYmFsLl9zY2hlZHVsZU9uUnVudGltZShcbiAgICAgICAgd29ya2xldFJ1bnRpbWUsXG4gICAgICAgIG1ha2VTaGFyZWFibGVDbG9uZU9uVUlSZWN1cnNpdmUoKCkgPT4ge1xuICAgICAgICAgICd3b3JrbGV0JztcbiAgICAgICAgICB3b3JrbGV0KC4uLmFyZ3MpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgfVxuICByZXR1cm4gKC4uLmFyZ3MpID0+XG4gICAgTmF0aXZlUmVhbmltYXRlZE1vZHVsZS5zY2hlZHVsZU9uUnVudGltZShcbiAgICAgIHdvcmtsZXRSdW50aW1lLFxuICAgICAgbWFrZVNoYXJlYWJsZUNsb25lUmVjdXJzaXZlKCgpID0+IHtcbiAgICAgICAgJ3dvcmtsZXQnO1xuICAgICAgICB3b3JrbGV0KC4uLmFyZ3MpO1xuICAgICAgfSlcbiAgICApO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQUMsTUFBQSxDQUFBQyxjQUFBLENBQUFDLE9BQUE7RUFBQUMsS0FBQTtBQUFBO0FBQUFELE9BQUEsQ0FBQUUsb0JBQUEsR0FBQUEsb0JBQUE7QUFBQUYsT0FBQSxDQUFBRyxZQUFBLEdBQUFBLFlBQUE7QUFDYixJQUFBQyxZQUFBLEdBQUFQLE9BQUE7QUFFQSxJQUFBUSxhQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxpQkFBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsZ0JBQUEsR0FBQVYsT0FBQTtBQUNBLElBQUFXLFdBQUEsR0FBQVgsT0FBQTtBQUtBLElBQU1ZLGlCQUFpQixHQUFHLElBQUFDLCtCQUFjLEVBQUMsQ0FBQztBQXFCbkMsU0FBU1Isb0JBQW9CQSxDQUNsQ1MsSUFBWSxFQUNaQyxXQUF1QyxFQUN2QjtFQUNoQixPQUFPQyx5QkFBc0IsQ0FBQ1gsb0JBQW9CLENBQ2hEUyxJQUFJLEVBQ0osSUFBQUcsdUNBQTJCLEVBQUMsWUFBTTtJQUNoQyxTQUFTOztJQUNULElBQUFDLDRCQUFjLEVBQUMsQ0FBQztJQUNoQixJQUFBQywwQkFBWSxFQUFDLENBQUM7SUFDZEosV0FBVyxZQUFYQSxXQUFXLENBQUcsQ0FBQztFQUNqQixDQUFDLENBQ0gsQ0FBQztBQUNIO0FBVU8sU0FBU1QsWUFBWUEsQ0FDMUJjLGNBQThCLEVBQzlCQyxPQUEyQyxFQUNsQjtFQUN6QixTQUFTOztFQUNULElBQUlDLE9BQU8sSUFBSSxDQUFDVixpQkFBaUIsSUFBSSxDQUFDLElBQUFXLDhCQUFpQixFQUFDRixPQUFPLENBQUMsRUFBRTtJQUNoRSxNQUFNLElBQUlHLEtBQUssQ0FDYixzRUFBc0UsSUFDbkVDLFFBQVEsR0FDTCw4RkFBOEYsR0FDOUYsRUFBRSxDQUNWLENBQUM7RUFDSDtFQUNBLElBQUlBLFFBQVEsRUFBRTtJQUNaLE9BQU87TUFBQSxTQUFBQyxJQUFBLEdBQUFDLFNBQUEsQ0FBQUMsTUFBQSxFQUFJQyxJQUFJLE9BQUFDLEtBQUEsQ0FBQUosSUFBQSxHQUFBSyxJQUFBLE1BQUFBLElBQUEsR0FBQUwsSUFBQSxFQUFBSyxJQUFBO1FBQUpGLElBQUksQ0FBQUUsSUFBQSxJQUFBSixTQUFBLENBQUFJLElBQUE7TUFBQTtNQUFBLE9BQ2JDLE1BQU0sQ0FBQ0Msa0JBQWtCLENBQ3ZCYixjQUFjLEVBQ2QsSUFBQWMsMkNBQStCLEVBQUMsWUFBTTtRQUNwQyxTQUFTOztRQUNUYixPQUFPLENBQUFjLEtBQUEsU0FBSU4sSUFBSSxDQUFDO01BQ2xCLENBQUMsQ0FDSCxDQUFDO0lBQUE7RUFDTDtFQUNBLE9BQU87SUFBQSxTQUFBTyxLQUFBLEdBQUFULFNBQUEsQ0FBQUMsTUFBQSxFQUFJQyxJQUFJLE9BQUFDLEtBQUEsQ0FBQU0sS0FBQSxHQUFBQyxLQUFBLE1BQUFBLEtBQUEsR0FBQUQsS0FBQSxFQUFBQyxLQUFBO01BQUpSLElBQUksQ0FBQVEsS0FBQSxJQUFBVixTQUFBLENBQUFVLEtBQUE7SUFBQTtJQUFBLE9BQ2JyQix5QkFBc0IsQ0FBQ3NCLGlCQUFpQixDQUN0Q2xCLGNBQWMsRUFDZCxJQUFBSCx1Q0FBMkIsRUFBQyxZQUFNO01BQ2hDLFNBQVM7O01BQ1RJLE9BQU8sQ0FBQWMsS0FBQSxTQUFJTixJQUFJLENBQUM7SUFDbEIsQ0FBQyxDQUNILENBQUM7RUFBQTtBQUNMIiwiaWdub3JlTGlzdCI6W119